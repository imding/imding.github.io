16##STEP_1####INST_1##Game%20Flow%0A%0APlay%20the%20snake%20game%20for%2010%20minutes%20and%20think%20about%20its%20game%20flow.%0A%0A(*)*Tip:*%20Game%20flow%20is%20a%20collection%20of%20events%20that%20happen%20in%20the%20game,%20when%20described%20in%20a%20certain%20sequence%20explains%20how%20the%20game%20is%20played.##INST_1E####CODE_1####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%20/%3E%0D%0A%20%20%20%20%3Clink%20href=%22https://fonts.googleapis.com/css?family=Nunito:200,400,700%22%20rel=%22stylesheet%22%3E%0D%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/head%3E%0D%0A%0D%0A%3Cbody%3E%0D%0A%0D%0A%20%20%20%20%3Ch1%3ESnake%20Game%3C/h1%3E%0D%0A%0D%0A%20%20%20%20%3Cdiv%20id=%22points-wrapper%22%3E%0D%0A%20%20%20%20%20%20%20%20%3Cp%20id=%22pointsLabel%22%3EPoints:%200%3C/p%3E%0D%0A%20%20%20%20%3C/div%3E%0D%0A%0D%0A%20%20%20%20%3Ccanvas%20id=%22gc%22%20width=%22400%22%20height=%22400%22%3E%3C/canvas%3E%0D%0A%0D%0A%20%20%20%20%3Cdiv%20id=%22button-wrapper%22%3E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%3Cbutton%20id='playButton'%3EPlay%3C/button%3E%0D%0A%0D%0A%20%20%20%20%3C/div%3E%0D%0A%0D%0A%20%20%20%20%0D%0A%3C/body%3E%0D%0A%0D%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS##*%20%7B%0D%0A%20%20%20%20font-family:%20%22Nunito%22;%0D%0A%20%20%09text-align:%20center;%0D%0A%7D%0D%0A%0D%0Ah1%20%7B%0D%0A%20%20%20%20font-size:%2035px;%0D%0A%20%20%20%20font-weight:%20200;%0D%0A%7D%0D%0A%0D%0Ap%20%7B%0D%0A%20%20%20%20font-size:%2015;%0D%0A%20%20%20%20font-weight:%20700;%0D%0A%7D%0D%0A%0D%0Acanvas%20%7B%0D%0A%20%20%20%20padding-left:%200;%0D%0A%20%20%20%20padding-right:%200;%0D%0A%20%20%20%20margin-left:%20auto;%0D%0A%20%20%20%20margin-right:%20auto;%0D%0A%20%20%20%20display:%20block;%0D%0A%20%20%20%20width:%20400px;%0D%0A%7D%0D%0A%0D%0Abutton%20%7B%0D%0A%20%20%20%20font-size:%2014px;%0D%0A%20%20%20%20margin:%205px;%0D%0A%7D%0D%0A%0D%0A#points%20%7B%0D%0A%20%20%20%20text-align:%20right;%0D%0A%7D%0D%0A%0D%0A#points-wrapper%20%7B%0D%0A%20%20%20%20width:%20400px;%0D%0A%20%20%20%20margin:%20auto;%0D%0A%7D%0D%0A%0D%0A#button-wrapper%20%7B%0D%0A%20%20%20%20display:%20flex;%0D%0A%20%20%20%20align-items:%20center;%0D%0A%20%20%20%20justify-content:%20center;%0D%0A%7D%0D%0A%0D%0A#select-difficulty%20%7B%0D%0A%20%20%20%20margin-bottom:%200;%0D%0A%7D%0D%0A%0D%0A#playerLabel%20%7B%0D%0A%20%20%20%20margin-left:%205px;%0D%0A%20%20%20%20margin-right:%205px;%0D%0A%20%20%20%20font-weight:%20100;%0D%0A%7D%0D%0A%0D%0A%0D%0A/*%20The%20switch%20-%20the%20box%20around%20the%20slider%20*/%0D%0A%0D%0A.switch%20%7B%0D%0A%20%20%20%20position:%20relative;%0D%0A%20%20%20%20display:%20inline-block;%0D%0A%20%20%20%20width:%2050px;%0D%0A%20%20%20%20height:%2030px;%0D%0A%20%20%20%20margin-left:%205px;%0D%0A%7D%0D%0A%0D%0A%0D%0A/*%20Hide%20default%20HTML%20checkbox%20*/%0D%0A%0D%0A.switch%20input%20%7B%0D%0A%20%20%20%20display:%20none;%0D%0A%7D%0D%0A%0D%0A%0D%0A/*%20The%20slider%20*/%0D%0A%0D%0A.slider%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20cursor:%20pointer;%0D%0A%20%20%20%20top:%200;%0D%0A%20%20%20%20left:%200;%0D%0A%20%20%20%20right:%200;%0D%0A%20%20%20%20bottom:%200;%0D%0A%20%20%20%20background-color:%20#ccc;%0D%0A%20%20%20%20-webkit-transition:%20.4s;%0D%0A%20%20%20%20transition:%20.4s;%0D%0A%7D%0D%0A%0D%0A.slider:before%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20content:%20%22%22;%0D%0A%20%20%20%20height:%2022px;%0D%0A%20%20%20%20width:%2022px;%0D%0A%20%20%20%20left:%204px;%0D%0A%20%20%20%20bottom:%204px;%0D%0A%20%20%20%20background-color:%20white;%0D%0A%20%20%20%20-webkit-transition:%20.4s;%0D%0A%20%20%20%20transition:%20.4s;%0D%0A%7D%0D%0A%0D%0Ainput:checked+.slider%20%7B%0D%0A%20%20%20%20background-color:%20#2196F3;%0D%0A%7D%0D%0A%0D%0Ainput:focus+.slider%20%7B%0D%0A%20%20%20%20box-shadow:%200%200%201px%20#2196F3;%0D%0A%7D%0D%0A%0D%0Ainput:checked+.slider:before%20%7B%0D%0A%20%20%20%20-webkit-transform:%20translateX(22px);%0D%0A%20%20%20%20-ms-transform:%20translateX(20px);%0D%0A%20%20%20%20transform:%20translateX(20px);%0D%0A%7D%0D%0A%0D%0A%0D%0A/*%20Rounded%20sliders%20*/%0D%0A%0D%0A.slider.round%20%7B%0D%0A%20%20%20%20border-radius:%2020px;%0D%0A%7D%0D%0A%0D%0A.slider.round:before%20%7B%0D%0A%20%20%20%20border-radius:%2050%25;%0D%0A%7D#BEGIN_EDITABLE##END_EDITABLE###CSS_E####JS##//%20Segment%20types%20of%20the%20snake%0D%0Alet%20SegmentType%20=%20Object.freeze(%7B%20'head':%201,%20'body':%202,%20'tail':%203%20%7D);%0D%0A//%20Directions%20the%20snake%20can%20travel%0D%0Alet%20Direction%20=%20Object.freeze(%7B%20'up':%20%7B%20'x':%200,%20'y':%20-1%20%7D,%20'down':%20%7B%20'x':%200,%20'y':%201%20%7D,%20'right':%20%7B%20'x':%201,%20'y':%200%20%7D,%20'left':%20%7B%20'x':%20-1,%20'y':%200%20%7D%20%7D);%0D%0A%0D%0A//%20Array%20of%20the%20snakes%20playing%20the%20game%0D%0Alet%20snakes%20=%20%5B%5D;%0D%0A%0D%0A//%20Array%20of%20obstacles%20for%20the%20current%20game%20mode%0D%0Alet%20obstacles%20=%20%5B%5D;%0D%0A%0D%0A//%20The%20current%20apple%20on%20the%20screen%0D%0Alet%20apple;%0D%0A%0D%0A//%20How%20big%20each%20grid%20is%20(px)%0D%0Alet%20gridSize%20=%2020;%0D%0A//%20How%20many%20grids%20are%20in%20the%20canvas%0D%0Alet%20tileCount%20=%2020;%0D%0A//%20How%20many%20times%20the%20scene%20is%20redrawn,%20per%20second%0D%0Alet%20refreshRate%20=%208;%0D%0A%0D%0A//%20Boolean%20indicating%20whether%20the%20game%20is%20currently%20in%20progress%0D%0Alet%20gameHasStarted%20=%20false;%0D%0A%0D%0A//%20Define%20the%20function%20to%20be%20called%20when%20the%20window%20loads%0D%0Awindow.onload%20=%20function%20()%20%7B%0D%0A%0D%0A%20%20%20%20//%20Set%20up%20the%20graphics%0D%0A%20%20%09gc.width%20=%20tileCount%20*%20gridSize;%0D%0A%20%20%09gc.height%20=%20tileCount%20*%20gridSize;%0D%0A%20%20%20%20ctx%20=%20gc.getContext('2d');%0D%0A%09%0D%0A%20%20%20%20//%20Draw%20the%20opening%20screen%0D%0A%20%20%20%20drawStartingScreen();%0D%0A%20%20%0D%0A%20%20%09//%20Add%20listener%20for%20key%20presses%0D%0A%20%20%20%20document.addEventListener('keydown',%20keyPush);%0D%0A%20%20%09playButton.addEventListener('click',%20startGame);%0D%0A%0D%0A%7D;%0D%0A%0D%0A//%20Function:%20starting%20the%20game%20(canvas%20starts%20to%20refresh)%0D%0Afunction%20startGame()%20%7B%0D%0A%0D%0A%20%20%20%20gameHasStarted%20=%20true;%0D%0A%0D%0A%20%20%20%20//%20Create%20how%20many%20snakes%20you%20want%0D%0A%20%20%20%20createSnakes();%0D%0A%0D%0A%20%20%20%20//%20Randomize%20the%20location%20of%20the%20starting%20apple%0D%0A%20%20%20%20spawnNewApple();%0D%0A%0D%0A%20%20%20%20//%20Start%20the%20graphics,%20at%20a%2015%20refreshes%20per%20second%20rate%0D%0A%20%20%20%20window.refresher%20=%20setInterval(refreshGame,%201000%20/%20refreshRate);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20createSnakes()%20%7B%0D%0A%0D%0A%20%20%20%20snakes%20=%20%5B%5D;%0D%0A%0D%0A%20%20%20%20const%20snake1%20=%20new%20Snake(1,%209,%20'green');%0D%0A%20%20%20%20snakes.push(snake1);%0D%0A%0D%0A%7D%0D%0A%0D%0A//%20Function:%20called%20multiple%20times%20a%20second%20to%20refresh%20the%20canvas%0D%0Afunction%20refreshGame()%20%7B%0D%0A%0D%0A%20%20%20%20clearCanvas();%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20apple%0D%0A%20%20%20%20apple.draw(ctx);%0D%0A%0D%0A%20%20%20%20refreshSnakes();%0D%0A%0D%0A%20%20%20%20//%20Check%20if%20snakes%20have%20run%20into%20each%20other%0D%0A%20%20%20%20checkForSnakeCollision();%0D%0A%0D%0A%20%20%20%20updatePointsLabel();%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20refreshSnakes()%20%7B%0D%0A%0D%0A%20%20%20%20//%20If%20any%20snake%20draw%20fails,%20stop%20all%20drawing%0D%0A%20%20%20%20snakes.every(snake%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(snake.draw(ctx))%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20snake.checkForApple();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20true;%0D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20checkForSnakeCollision()%20%7B%0D%0A%0D%0A%20%20%20%20let%20losingSnakes%20=%20%5B%5D;%0D%0A%20%20%20%20snakes.forEach(snake%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(snake.checkForSnakeCollision())%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20losingSnakes.push(snake);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20if%20(losingSnakes.length)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerLoses(losingSnakes);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%7D%0D%0A%0D%0A//%20Function:%20resetting%20the%20game%20(if%20the%20player%20dies)%0D%0Afunction%20resetGame()%20%7B%0D%0A%0D%0A%20%20%20%20player1Name%20=%20null;%0D%0A%20%20%20%20player2Name%20=%20null;%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20starting%20snake%20screen%0D%0A%20%20%20%20drawStartingScreen();%0D%0A%0D%0A%20%20%20%20updatePointsLabel();%0D%0A%7D%0D%0A%0D%0A//%20Function:%20handles%20the%20playing-losing%20event%0D%0Afunction%20playerLoses(losingSnakes)%20%7B%0D%0A%0D%0A%20%20%20%20gameHasStarted%20=%20false;%0D%0A%0D%0A%20%20%20%20//%20Stop%20the%20canvas%20from%20refreshing%0D%0A%20%20%20%20clearInterval(window.refresher);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20screen%20showing%20the%20%22L%22%20snake%0D%0A%20%20%20%20drawLosingScreen();%0D%0A%0D%0A%20%20%20%20//%20Wait%203%20seconds,%20and%20then%20reset%20the%20game%0D%0A%20%20%20%20setTimeout(resetGame,%203000);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20spawnNewApple()%20%7B%0D%0A%20%20%20%20apple%20=%20new%20Apple();%0D%0A%7D%0D%0A%0D%0Afunction%20clearCanvas()%20%7B%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(0,%200,%20gc.width,%20gc.height);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20updatePointsLabel()%20%7B%0D%0A%20%20%20%20pointsLabel.innerHTML%20=%20gameHasStarted%20?%20'Points:%20'%20+%20String(snakes%5B0%5D.points)%20:%20'Points:%200';%0D%0A%7D%0D%0A%0D%0Afunction%20keyPush(evt)%20%7B%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(!gameHasStarted)%20%7B%0D%0A%20%20%20%20%20%20%20%20return;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20evt.preventDefault();%0D%0A%0D%0A%20%20%20%20if%20(evt.keyCode%20===%2065)%20snakes%5B0%5D.setDirection(Direction.left);%0D%0A%0D%0A%20%20%20%20if%20(evt.keyCode%20===%2087)%20snakes%5B0%5D.setDirection(Direction.up);%0D%0A%0D%0A%20%20%20%20if%20(evt.keyCode%20===%2068)%20snakes%5B0%5D.setDirection(Direction.right);%0D%0A%0D%0A%20%20%20%20if%20(evt.keyCode%20===%2083)%20snakes%5B0%5D.setDirection(Direction.down);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20drawLosingScreen()%20%7B%0D%0A%0D%0A%20%20%20%20clearCanvas();%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(0,%200,%20gc.width,%20gc.height);%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'green';%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize,%203%20*%20gridSize,%208%20*%20gridSize,%2014%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(8%20*%20gridSize,%203%20*%20gridSize,%206%20*%20gridSize,%2012%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20triangle%20tail%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(13%20*%20gridSize,%2015%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize,%2016%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize,%2015%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(13%20*%20gridSize,%2017%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize,%2016%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize,%2017%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20eyes%0D%0A%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%203%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%20%20%20%20ctx.fillRect(7%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%203%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20tongue%0D%0A%20%20%20%20ctx.fillStyle%20=%20'pink';%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize%20+%205%20/%206%20*%20gridSize,%202.5%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%202%20*%20gridSize);%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(7%20*%20gridSize,%202.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(7%20*%20gridSize,%202%20*%20gridSize%20+%203%20/%208%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6.5%20*%20gridSize,%202%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize%20+%205%20/%206%20*%20gridSize,%202.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(7%20*%20gridSize,%202.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(7%20*%20gridSize,%202%20*%20gridSize%20+%203%20/%208%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(7.5%20*%20gridSize,%202%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(7%20*%20gridSize%20+%201%20/%206%20*%20gridSize,%202.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20drawStartingScreen()%20%7B%0D%0A%0D%0A%20%20%20%20clearCanvas();%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(0,%200,%20gc.width,%20gc.height);%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'green';%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize,%203%20*%20gridSize,%208%20*%20gridSize,%2014%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(8%20*%20gridSize,%205%20*%20gridSize,%206%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize,%2011%20*%20gridSize,%206%20*%20gridSize,%204%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20triangle%20tail%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(7%20*%20gridSize,%2015%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize,%2016%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize,%2015%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(7%20*%20gridSize,%2017%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize,%2016%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize,%2017%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20eyes%0D%0A%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20ctx.fillRect(13%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%203%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%20%20%20%20ctx.fillRect(13%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%204%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20tongue%0D%0A%20%20%20%20ctx.fillStyle%20=%20'pink';%0D%0A%20%20%20%20ctx.fillRect(14%20*%20gridSize,%203%20*%20gridSize%20+%205%20/%206%20*%20gridSize,%201%20/%202%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(14.5%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize%20+%205%20/%208%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(15%20*%20gridSize,%203.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14.5%20*%20gridSize,%203%20*%20gridSize%20+%205%20/%206%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(14.5%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize%20+%205%20/%208%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(15%20*%20gridSize,%204.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14.5%20*%20gridSize,%204%20*%20gridSize%20+%201%20/%206%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%7D%0D%0A%0D%0Aclass%20Snake%20%7B%0D%0A%0D%0A%20%20%20%20constructor(x,%20y,%20color,%20name%20=%20'Snakey')%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20An%20array%20of%20SnakeSegments%0D%0A%20%20%20%20%20%20%20%20this.segments%20=%20%5B%5D;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.color%20=%20color;%0D%0A%20%20%20%20%20%20%20%20this.altColor%20=%20color;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.name%20=%20name;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.direction%20=%20Direction.up;%0D%0A%20%20%20%20%20%20%20%20this.pendingTurn%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Coordinates%20of%20the%20head%20of%20the%20snake%0D%0A%20%20%20%20%20%20%20%20this.x%20=%20x;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%20y;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.prevTailPos%20=%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20x:%200,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20y:%200%0D%0A%20%20%20%20%20%20%20%20%7D;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.points%20=%200;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.generateSnake();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20generateSnake()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Create%20the%20initial%20snake%0D%0A%20%20%20%20%20%20%20%20const%20startSize%20=%205;%0D%0A%20%20%20%20%20%20%20%20for%20(let%20i%20=%200;%20i%20%3C%20startSize;%20i++)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20segment;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!i)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20segment%20=%20new%20SnakeSegment(this.x,%20this.y,%20this.color,%20SegmentType.head);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20(i%20===%20startSize%20-%201)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20segment%20=%20new%20SnakeSegment(this.x,%20this.y,%20this.color,%20SegmentType.tail);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20segment%20=%20new%20SnakeSegment(this.x,%20this.y,%20this.color,%20SegmentType.body);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20this.segments.push(segment);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20drawSnakeTail()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20tail%20=%20this.tail;%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20preTail%20=%20this.getSegment(this.segments.length%20-%202);%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Get%20the%20direction%20that%20the%20tail%20is%20moving%20in%0D%0A%20%20%20%20%20%20%20%20let%20tailXVelocity%20=%20preTail.position.x%20-%20tail.position.x;%0D%0A%20%20%20%20%20%20%20%20let%20tailYVelocity%20=%20preTail.position.y%20-%20tail.position.y;%0D%0A%0D%0A%20%20%20%20%20%20%20%20switch%20(tailXVelocity)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%201:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.moveTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize%20+%209);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20-1:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.moveTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize%20+%209);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%200:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20switch%20(tailYVelocity)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%201:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.moveTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%209,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20-1:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.moveTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%209,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20drawSnakeEyes()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20head%20=%20this.head;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Giving%20the%20snake%20eyes%20based%20off%20of%20its%20direction%0D%0A%20%20%20%20%20%20%20%20switch%20(this.direction.x)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%201:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%2012,%20head.position.y%20*%20gridSize%20+%203,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%2012,%20head.position.y%20*%20gridSize%20+%2011,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20-1:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%202,%20head.position.y%20*%20gridSize%20+%203,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%202,%20head.position.y%20*%20gridSize%20+%2011,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%200:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20switch%20(this.direction.y)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%201:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%203,%20head.position.y%20*%20gridSize%20+%2012,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%2011,%20head.position.y%20*%20gridSize%20+%2012,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20-1:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%203,%20head.position.y%20*%20gridSize%20+%202,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%2011,%20head.position.y%20*%20gridSize%20+%202,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20this.color;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20Called%20to%20draw%20the%20entire%20snake%0D%0A%20%20%20%20draw(ctx)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20this.color;%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20success%20=%20this.updatePositions();%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(!success)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20for%20(let%20i%20=%200;%20i%20%3C%20this.segments.length;%20i++)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20If%20drawing%20the%20tail%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(i%20==%20this.segments.length%20-%201)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.drawSnakeTail();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(this.segments%5Bi%5D.x%20*%20gridSize,%20this.segments%5Bi%5D.y%20*%20gridSize,%20gridSize%20-%202,%20gridSize%20-%202);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20If%20drawing%20the%20head%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!i)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.drawSnakeEyes();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20return%20true;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20updatePositions()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.pendingTurn%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Expressions%20account%20for%20vertical%20and%20horizontal%20wrapping%0D%0A%20%20%20%20%20%20%20%20const%20newX%20=%20this.x%20+%20this.direction.x%20%3E%20tileCount%20-%201%20?%200%20:%20(this.x%20+%20this.direction.x%20%3C%200%20?%20tileCount%20-%201%20:%20this.x%20+%20this.direction.x);%0D%0A%20%20%20%20%20%20%20%20const%20newY%20=%20this.y%20+%20this.direction.y%20%3E%20tileCount%20-%201%20?%200%20:%20(this.y%20+%20this.direction.y%20%3C%200%20?%20tileCount%20-%201%20:%20this.y%20+%20this.direction.y);%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.x%20=%20newX;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%20newY;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Check%20if%20the%20snake%20ran%20into%20an%20obstacle%0D%0A%20%20%20%20%20%20%20%20const%20collision%20=%20obstacles.some(obstacle%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20obstacle.isCollision(this.x,%20this.y);%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(collision)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20playerLoses(%5Bthis%5D);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Go%20through%20the%20segments%20from%20the%20tail%20to%20the%20head,%20assigning%20each%20segment's%20x%20and%20y%20equal%20to%20the%20next%20segment's%20position%0D%0A%20%20%20%20%20%20%20%20for%20(let%20i%20=%20this.segments.length%20-%201;%20i%20%3E=%200;%20i--)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!i)%20%7B%20//%20For%20the%20head%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.segments%5Bi%5D.setPosition(this.x,%20this.y);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(i%20===%20this.segments.length%20-%201)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.prevTailPos%20=%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x:%20this.segments%5Bi%5D.x,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y:%20this.segments%5Bi%5D.y%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20nextX%20=%20this.segments%5Bi%20-%201%5D.x;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20nextY%20=%20this.segments%5Bi%20-%201%5D.y;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(nextX%20===%20this.x%20&&%20nextY%20===%20this.y)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerLoses(this);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.segments%5Bi%5D.setPosition(nextX,%20nextY);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20return%20true;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20checkForApple()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(this.x%20===%20apple.position.x%20&&%20this.y%20===%20apple.position.y)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%09this.points++;%0D%0A%20%20%20%20%20%20%20%20%20%20%09this.addSegment();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20spawnNewApple();%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20Checks%20if%20this%20snake%20has%20run%20into%20any%20other%20snake%0D%0A%20%20%20%20checkForSnakeCollision()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20return%20snakes.some(snake%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(snake%20!==%20this)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20snake.segments.some(segment%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(segment.position.x%20===%20this.x%20&&%20segment.position.y%20===%20this.y)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20addSegment()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20tailSegment%20=%20this.segments%5Bthis.segments.length%20-%201%5D;%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20newSegment%20=%20new%20SnakeSegment(tailSegment.position.x,%20tailSegment.position.y,%20this.color,%20SegmentType.body);%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.segments.splice(this.segments.length%20-%201,%200,%20newSegment);%0D%0A%0D%0A%20%20%20%20%20%20%20%20tailSegment.setPosition(this.prevTailPos.x,%20this.prevTailPos.y);%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20setDirection(direction)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(this.pendingTurn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20this.pendingTurn%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20To%20prevent%20180%20degree%20turns%0D%0A%20%20%20%20%20%20%20%20switch%20(direction)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20Direction.up:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.direction%20===%20Direction.down)%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20Direction.down:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.direction%20===%20Direction.up)%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20Direction.left:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.direction%20===%20Direction.right)%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20Direction.right:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.direction%20===%20Direction.left)%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.direction%20=%20direction;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20get%20head()%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20this.segments%5B0%5D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20get%20tail()%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20this.segments%5Bthis.segments.length%20-%201%5D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20getSegment(i)%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20this.segments%5Bi%5D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%7D%0D%0A%0D%0Aclass%20SnakeSegment%20%7B%0D%0A%0D%0A%20%20%20%20constructor(x,%20y,%20color,%20type)%20%7B%0D%0A%20%20%20%20%20%20%20%20this.x%20=%20x;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%20y;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.color%20=%20color;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20SegmentType%0D%0A%20%20%20%20%20%20%20%20this.type%20=%20type;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20setPosition(x,%20y)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.x%20=%20x;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%20y;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20get%20position()%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20x:%20this.x,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20y:%20this.y%0D%0A%20%20%20%20%20%20%20%20%7D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%7D%0D%0A%0D%0Aclass%20Apple%20%7B%0D%0A%0D%0A%20%20%20%20constructor()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.x%20=%200;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%200;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.initPosition();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20initPosition()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20let%20collision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20do%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20this.x%20=%20Math.floor(Math.random()%20*%20tileCount);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20this.y%20=%20Math.floor(Math.random()%20*%20tileCount);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20collision%20=%20obstacles.some(obstacle%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20obstacle.isCollision(this.x,%20this.y);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D%20while%20(collision);%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20draw(ctx)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Draw%20apple%0D%0A%20%20%20%20%20%20%20%20if%20(this.gold)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'gold';%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'red';%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20ctx.arc(this.x%20*%20gridSize%20+%200.5%20*%20(gridSize%20-%202),%20this.y%20*%20gridSize%20+%200.5%20*%20(gridSize%20-%202),%200.4%20*%20(gridSize%20-%202),%200,%202%20*%20Math.PI);%0D%0A%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Draw%20stem%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'brown';%0D%0A%20%20%20%20%20%20%20%20ctx.fillRect(this.x%20*%20gridSize%20+%207,%20this.y%20*%20gridSize,%204,%200.5%20*%20(gridSize%20-%202));%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Draw%20leaf%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'green';%0D%0A%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20ctx.moveTo(this.x%20*%20gridSize%20+%209,%20this.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20ctx.lineTo(this.x%20*%20gridSize%20+%209,%20this.y%20*%20gridSize%20+%204);%0D%0A%20%20%20%20%20%20%20%20ctx.lineTo(this.x%20*%20gridSize%20+%2018,%20this.y%20*%20gridSize%20+%202);%0D%0A%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20get%20position()%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20x:%20this.x,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20y:%20this.y%0D%0A%20%20%20%20%20%20%20%20%7D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%7D#BEGIN_EDITABLE##END_EDITABLE###JS_E####CODE_1E####LOGIC_1####HTML####HTML_E####CSS####CSS_E####JS####JS_E####LOGIC_1E####STEP_1E####STEP_2####INST_2##Variables%20-%20string%0A%0AYour%20instructor%20will%20explain%20how%20string%20variables%20work,%20then%20you%20must%20complete%20the%20following%20and%20get%20approval%20from%20the%20instructor.%0A%0A(***)%0A%0A(!)1.%20Create%203%20variables%20with%20*string*%20values.%0A(!)2.%20Console%20log%20a%20sentence%20(or%20two)%20using%20all%203%20variables.%0A%0A(---)%0A%0A(js)var%20fruit1%20=%20'apple';%0Avar%20fruit2%20=%20'banana';%0Avar%20fruit3%20=%20'orange';%0Aconsole.log('I%20like%20'%20+%20fruit1%20+%20'%20but%20not%20so%20much%20'%20+%20fruit2%20+%20'%20and%20'%20+%20fruit3%20+%20'.');(#)##INST_2E####CODE_2####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%20/%3E%0D%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/head%3E%0D%0A%0D%0A%3Cbody%3E%0D%0A%20%20%20%20%0D%0A%3C/body%3E%0D%0A%0D%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS####CSS_E####JS###BEGIN_EDITABLE#%0A//%20dawn%20corner%0A#END_EDITABLE###JS_E####CODE_2E####LOGIC_2####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass().if(code.js.editable%5B0%5D.includes('dawn%20corner')).is.true;##JS_E####LOGIC_2E####STEP_2E####STEP_3####INST_3##Variables%20-%20number%0A%0AYour%20instructor%20will%20explain%20how%20number%20variables%20work,%20then%20you%20must%20complete%20the%20following%20and%20get%20approval%20from%20the%20instructor.%0A%0A(***)%0A%0A(!)1.%20Create%203%20variables%20with%20*number*%20values.%0A(!)2.%20Perform%20calculation%20with%20the%203%20numbers%20and%20console%20log%20the%20result.##INST_3E####CODE_3####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%20/%3E%0D%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/head%3E%0D%0A%0D%0A%3Cbody%3E%0D%0A%20%20%20%20%0D%0A%3C/body%3E%0D%0A%0D%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS####CSS_E####JS###BEGIN_EDITABLE#%0A//%20alive%20chance%0A#END_EDITABLE###JS_E####CODE_3E####LOGIC_3####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass().if(code.js.editable%5B0%5D.includes('alive%20chance')).is.true;##JS_E####LOGIC_3E####STEP_3E####STEP_4####INST_4##Variables%20-%20Boolean%0A%0AYour%20instructor%20will%20explain%20how%20Boolean%20variables%20work,%20then%20you%20must%20complete%20the%20following%20and%20get%20approval%20from%20the%20instructor.%0A%0A(***)%0A%0A(!)1.%20Create%202%20variables%20with%20*Boolean*%20values.%0A(!)2.%20Console%20log%20a%20sentence%20(or%20two)%20using%20both%20variables.##INST_4E####CODE_4####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%20/%3E%0D%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/head%3E%0D%0A%0D%0A%3Cbody%3E%0D%0A%20%20%20%20%0D%0A%3C/body%3E%0D%0A%0D%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS####CSS_E####JS###BEGIN_EDITABLE#%0A//%20horse%20chin%0A#END_EDITABLE###JS_E####CODE_4E####LOGIC_4####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass().if(code.js.editable%5B0%5D.includes('horse%20chin')).is.true;##JS_E####LOGIC_4E####STEP_4E####STEP_5####INST_5##Extended%20Variables%20-%20array%0A%0AYour%20instructor%20will%20explain%20how%20array%20works,%20then%20you%20must%20complete%20the%20following%20and%20get%20approval%20from%20the%20instructor.%0A%0A(***)%0A%0A(!)1.%20Replace%20the%203%20variables%20with%20a%20single%20array%20variable.%0A(!)2.%20Modify%20the%20content%20of%20%60console.log()%60%20to%20maintain%20the%20resulting%20message.##INST_5E####CODE_5####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%20/%3E%0D%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/head%3E%0D%0A%0D%0A%3Cbody%3E%0D%0A%20%20%20%20%0D%0A%3C/body%3E%0D%0A%0D%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS####CSS_E####JS###BEGIN_EDITABLE#%0A//%20barely%20couch%0A#END_EDITABLE###JS_E####CODE_5E####LOGIC_5####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass().if(code.js.editable%5B0%5D.includes('barely%20couch')).is.true;##JS_E####LOGIC_5E####STEP_5E####STEP_6####INST_6##Extended%20Variables%20-%20object%0A%0AYour%20instructor%20will%20explain%20how%20object%20works,%20then%20you%20must%20complete%20the%20following%20and%20get%20approval%20from%20the%20instructor.%0A%0A(***)%0A%0A(!)Create%20an%20object%20to%20represent%20something.##INST_6E####CODE_6####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%20/%3E%0D%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/head%3E%0D%0A%0D%0A%3Cbody%3E%0D%0A%20%20%20%20%0D%0A%3C/body%3E%0D%0A%0D%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS####CSS_E####JS###BEGIN_EDITABLE#%0A//%20soul%20inside%0A#END_EDITABLE###JS_E####CODE_6E####LOGIC_6####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass().if(code.js.editable%5B0%5D.includes('soul%20inside')).is.true;##JS_E####LOGIC_6E####STEP_6E####STEP_7####INST_7##Functions%0A%0AYour%20instructor%20will%20explain%20how%20functions%20work,%20then%20you%20must%20complete%20the%20following%20and%20get%20approval%20from%20the%20instructor.%0A%0A(***)%0A%0A(!)1.%20Create%20a%20function%20that%20logs%20something%20to%20the%20console.%0A(!)2.%20Call%20the%20function.##INST_7E####CODE_7####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%20/%3E%0D%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/head%3E%0D%0A%0D%0A%3Cbody%3E%0D%0A%20%20%20%20%0D%0A%3C/body%3E%0D%0A%0D%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS####CSS_E####JS###BEGIN_EDITABLE#%0A//%20fellow%20less%0A#END_EDITABLE###JS_E####CODE_7E####LOGIC_7####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass().if(code.js.editable%5B0%5D.includes('fellow%20less')).is.true;##JS_E####LOGIC_7E####STEP_7E####STEP_8####INST_8##Intro%20to%20canvas%0A%0AYour%20instructor%20will%20explain%20how%20canvas%20works,%20then%20you%20must%20complete%20the%20following%20and%20get%20approval%20from%20the%20instructor.%0A%0A(***)%0A%0A(!)1.%20Move%20the%20box%20to%20the%20middle%20of%20the%20canvas.%0A(!)2.%20Move%20the%20circle%20to%20the%20middle%20of%20the%20box.%0A(!)3.%20Make%20the%20circle%20as%20tall%20and%20wide%20as%20the%20box.##INST_8E####CODE_8####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%20/%3E%0D%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/head%3E%0D%0A%0D%0A%3Cbody%3E%0D%0A%20%20%20%20#BEGIN_EDITABLE#%3Ccanvas%20id='frame'%3E%3C/canvas%3E#END_EDITABLE#%0D%0A%3C/body%3E%0D%0A%0D%0A%3C/html%3E##HTML_E####CSS###frame%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20left:%2050%25;%0D%0A%20%20%20%20top:%2050%25;%0D%0A%20%20%20%20border:%201px%20solid%20gray;%0D%0A%20%20%20%20transform:%20translate(-50%25,%20-50%25);%0D%0A%20%20%20%20background-color:%20whitesmoke;%0D%0A%7D#BEGIN_EDITABLE##END_EDITABLE###CSS_E####JS##var%20ctx;%0D%0Avar%20circle%20=%20%7B%0D%0A%20%20%20%20radius:%2030,%0D%0A%20%20%20%20x:%2075,%0D%0A%20%20%20%20y:%2075,%0D%0A%7D;%0D%0Avar%20box%20=%20%7B%0D%0A%20%20%20%20width:%20100,%0D%0A%20%20%20%20height:%20100,%0D%0A%20%20%20%20x:%200,%0D%0A%20%20%20%20y:%200,%0D%0A%7D;%0D%0A%0D%0Awindow.onload%20=%20function%20()%20%7B%0D%0A%20%20%20%20frame.width%20=%20400;%0D%0A%20%20%20%20frame.height%20=%20300;%0D%0A%0D%0A%20%20%20%20ctx%20=%20frame.getContext('2d');%0D%0A%0D%0A%20%20%20%20#BEGIN_EDITABLE#%0D%0A%20%20%20%20box.x%20=%20150;%0D%0A%20%20%20%20box.y%20=%20100;%0D%0A%20%20%20%20#END_EDITABLE#%0D%0A%20%20%20%20%0D%0A%20%20%20%20ctx.fillStyle%20=%20'mediumspringgreen';%0D%0A%20%20%20%20ctx.fillRect(box.x,%20box.y,%20box.width,%20box.height);%0D%0A%0D%0A%20%20%20%20#BEGIN_EDITABLE#%0D%0A%20%20%20%20circle.radius%20=%2050;%0D%0A%20%20%20%20circle.x%20=%20200;%0D%0A%20%20%20%20circle.y%20=%20150;%0D%0A%20%20%20%20//%20upper%20clock%0D%0A%20%20%20%20#END_EDITABLE#%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'lightpink';%0D%0A%20%20%20%20ctx.arc(circle.x,%20circle.y,%20circle.radius,%200,%202%20*%20Math.PI);%0D%0A%20%20%20%20ctx.fill();%0D%0A%7D;##JS_E####CODE_8E####LOGIC_8####HTML##//%20Expectation:%0Apass.if.html.editable(0).equivalent(%60%3Ccanvas%20id='frame'%3E%3C/canvas%3E%60);##HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass().if(code.js.editable%5B0%5D.includes('upper%20clock')).is.true;##JS_E####LOGIC_8E####STEP_8E####STEP_9####INST_9##Keyboard%20events%0A%0AYour%20instructor%20will%20explain%20how%20event%20works,%20then%20you%20must%20complete%20the%20following%20and%20get%20approval%20from%20the%20instructor.%0A%0A(***)%0A%0A(!)Follow%20in-class%20instruction%20and%20change%20what%20gets%20printed%20to%20the%20console.##INST_9E####CODE_9####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%20/%3E%0D%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/head%3E%0D%0A%0D%0A%3Cbody%3E%0D%0A%20%20%20%20%3Ccanvas%20id='frame'%3E%3C/canvas%3E%0D%0A%3C/body%3E%0D%0A%0D%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS###frame%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20left:%2050%25;%0D%0A%20%20%20%20top:%2050%25;%0D%0A%20%20%20%20border:%201px%20solid%20gray;%0D%0A%20%20%20%20transform:%20translate(-50%25,%20-50%25);%0D%0A%20%20%20%20background-color:%20whitesmoke;%0D%0A%7D#BEGIN_EDITABLE##END_EDITABLE###CSS_E####JS###BEGIN_EDITABLE#%0D%0Awindow.onkeydown%20=%20function%20()%20%7B%0D%0A%20%20%20%20if%20(event.key%20===%20'ArrowLeft')%20%7B%0D%0A%20%20%20%20%20%20%20%20console.log('Go%20Left');%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(event.key%20===%20'ArrowRight')%20%7B%0D%0A%20%20%20%20%20%20%20%20console.log('Go%20Right');%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(event.key%20===%20'ArrowUp')%20%7B%0D%0A%20%20%20%20%20%20%20%20console.log('Go%20Up');%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(event.key%20===%20'ArrowDown')%20%7B%0D%0A%20%20%20%20%20%20%20%20console.log('Go%20Down');%0D%0A%20%20%20%20%7D%0D%0A%7D;%0D%0A//%20steep%20team%0D%0A#END_EDITABLE###JS_E####CODE_9E####LOGIC_9####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass().if(code.js.editable%5B0%5D.includes('steep%20team')).is.true;##JS_E####LOGIC_9E####STEP_9E####STEP_10####INST_10##Moving%20shapes%20in%20canvas%0A%0AYour%20instructor%20will%20explain%20how%20to%20move%20shapes%20inside%20canvas,%20then%20you%20must%20complete%20the%20following%20and%20get%20approval%20from%20the%20instructor.%0A%0A(***)%0A%0A(!)1.%20Set%20the%20x%20and%20y%20speed%20for%20each%20key%20press.%0A(!)2.%20Call%20the%20*render*%20function%20with%20every%20key%20stroke.##INST_10E####CODE_10####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%20/%3E%0D%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/head%3E%0D%0A%0D%0A%3Cbody%3E%0D%0A%20%20%20%20%3Ccanvas%20id='frame'%3E%3C/canvas%3E%0D%0A%3C/body%3E%0D%0A%0D%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS###frame%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20left:%2050%25;%0D%0A%20%20%20%20top:%2050%25;%0D%0A%20%20%20%20border:%201px%20solid%20gray;%0D%0A%20%20%20%20transform:%20translate(-50%25,%20-50%25);%0D%0A%20%20%20%20background-color:%20whitesmoke;%0D%0A%7D#BEGIN_EDITABLE##END_EDITABLE###CSS_E####JS##var%20ctx;%0D%0Avar%20box%20=%20%7B%20width:%20100,%20height:%20100%20%7D;%0D%0Avar%20speed%20=%20%7B%20x:%200,%20y:%200%20%7D;%0D%0Avar%20position%20=%20%7B%20x:%200,%20y:%200%20%7D;%0D%0A%0D%0Afunction%20render()%20%7B%0D%0A%20%20%20%20//%20clear%20the%20canvas%0D%0A%20%20%20%20ctx.fillStyle%20=%20'whitesmoke';%0D%0A%20%20%20%20ctx.fillRect(0,%200,%20frame.width,%20frame.height);%0D%0A%0D%0A%20%20%20%20//%20calculate%20new%20position%0D%0A%20%20%20%20position.x%20=%20position.x%20+%20speed.x;%0D%0A%20%20%20%20position.y%20=%20position.y%20+%20speed.y;%0D%0A%0D%0A%20%20%20%20%0D%0A%20%20%20%20ctx.fillStyle%20=%20'mediumspringgreen';%0D%0A%20%20%20%20ctx.fillRect(position.x,%20position.y,%20box.width,%20box.height);%0D%0A%7D%0D%0A%0D%0Awindow.onload%20=%20function%20()%20%7B%0D%0A%20%20%20%20frame.width%20=%20400;%0D%0A%20%20%20%20frame.height%20=%20300;%0D%0A%0D%0A%20%20%20%20position%20=%20%7B%0D%0A%20%20%20%20%20%20%20%20x:%20frame.width%20/%202%20-%20box.width%20/%202,%0D%0A%20%20%20%20%20%20%20%20y:%20frame.height%20/%202%20-%20box.height%20/%202,%0D%0A%20%20%20%20%7D;%0D%0A%0D%0A%20%20%20%20ctx%20=%20frame.getContext('2d');%0D%0A%0D%0A%20%20%20%20render();%0D%0A%7D;%0D%0A%0D%0Awindow.onkeydown%20=%20function%20()%20%7B%0D%0A%20%20%20%20speed%20=%20%7B%20x:%200,%20y:%200%20%7D;%0D%0A%0D%0A%20%20%20%20if%20(event.key%20===%20'ArrowLeft')%20%7B%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#speed.x%20=%20-2;#END_EDITABLE#%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(event.key%20===%20'ArrowRight')%20%7B%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#speed.x%20=%202;#END_EDITABLE#%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(event.key%20===%20'ArrowUp')%20%7B%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#speed.y%20=%20-2;#END_EDITABLE#%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(event.key%20===%20'ArrowDown')%20%7B%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#speed.y%20=%202;#END_EDITABLE#%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20#BEGIN_EDITABLE#render();#END_EDITABLE#%0D%0A%7D;##JS_E####CODE_10E####LOGIC_10####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60speed.x%20=%20-2;%60);%0Apass.if.js.editable(1).equivalent(%60speed.x%20=%202;%60);%0Apass.if.js.editable(2).equivalent(%60speed.y%20=%20-2;%60);%0Apass.if.js.editable(3).equivalent(%60speed.y%20=%202;%60);%0Apass.if.js.editable(4).equivalent(%60render();%60);##JS_E####LOGIC_10E####STEP_10E####STEP_11####INST_11##Request%20animation%20frame%0A%0AYour%20instructor%20will%20explain%20how%20to%20continuously%20update%20the%20canvas,%20then%20you%20must%20complete%20the%20following%20and%20get%20approval%20from%20the%20instructor.%0A%0A(***)%0A%0A(!)1.%20On%20+js#onload#-3,%20update%20the%20canvas%20using%20the%20*window.requestAnimationFrame*%20function.%0A(!)2.%20On%20+js#ArrowDown#+4,%20remove%20the%20*render*%20function%20call.##INST_11E####CODE_11####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%20/%3E%0D%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/head%3E%0D%0A%0D%0A%3Cbody%3E%0D%0A%20%20%20%20%3Ccanvas%20id='frame'%3E%3C/canvas%3E%0D%0A%3C/body%3E%0D%0A%0D%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS###frame%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20left:%2050%25;%0D%0A%20%20%20%20top:%2050%25;%0D%0A%20%20%20%20border:%201px%20solid%20gray;%0D%0A%20%20%20%20transform:%20translate(-50%25,%20-50%25);%0D%0A%20%20%20%20background-color:%20whitesmoke;%0D%0A%7D#BEGIN_EDITABLE##END_EDITABLE###CSS_E####JS##var%20ctx;%0D%0Avar%20box%20=%20%7B%20width:%20100,%20height:%20100%20%7D;%0D%0Avar%20speed%20=%20%7B%20x:%200,%20y:%200%20%7D;%0D%0Avar%20position%20=%20%7B%20x:%200,%20y:%200%20%7D;%0D%0A%0D%0Afunction%20render()%20%7B%0D%0A%20%20%20%20//%20clear%20the%20canvas%0D%0A%20%20%20%20ctx.fillStyle%20=%20'whitesmoke';%0D%0A%20%20%20%20ctx.fillRect(0,%200,%20frame.width,%20frame.height);%0D%0A%0D%0A%20%20%20%20//%20calculate%20new%20position%0D%0A%20%20%20%20position.x%20=%20position.x%20+%20speed.x;%0D%0A%20%20%20%20position.y%20=%20position.y%20+%20speed.y;%0D%0A%0D%0A%20%20%20%20%0D%0A%20%20%20%20ctx.fillStyle%20=%20'mediumspringgreen';%0D%0A%20%20%20%20ctx.fillRect(position.x,%20position.y,%20box.width,%20box.height);%0D%0A%0D%0A%20%20%20%20#BEGIN_EDITABLE#window.requestAnimationFrame(render);#END_EDITABLE#%0D%0A%7D%0D%0A%0D%0Awindow.onload%20=%20function%20()%20%7B%0D%0A%20%20%20%20frame.width%20=%20400;%0D%0A%20%20%20%20frame.height%20=%20300;%0D%0A%0D%0A%20%20%20%20position%20=%20%7B%0D%0A%20%20%20%20%20%20%20%20x:%20frame.width%20/%202%20-%20box.width%20/%202,%0D%0A%20%20%20%20%20%20%20%20y:%20frame.height%20/%202%20-%20box.height%20/%202,%0D%0A%20%20%20%20%7D;%0D%0A%0D%0A%20%20%20%20ctx%20=%20frame.getContext('2d');%0D%0A%0D%0A%20%20%20%20render();%0D%0A%7D;%0D%0A%0D%0Awindow.onkeydown%20=%20function%20()%20%7B%0D%0A%20%20%20%20speed%20=%20%7B%20x:%200,%20y:%200%20%7D;%0D%0A%0D%0A%20%20%20%20if%20(event.key%20===%20'ArrowLeft')%20%7B%0D%0A%20%20%20%20%20%20%20%20speed.x%20=%20-2;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(event.key%20===%20'ArrowRight')%20%7B%0D%0A%20%20%20%20%20%20%20%20speed.x%20=%202;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(event.key%20===%20'ArrowUp')%20%7B%0D%0A%20%20%20%20%20%20%20%20speed.y%20=%20-2;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(event.key%20===%20'ArrowDown')%20%7B%0D%0A%20%20%20%20%20%20%20%20speed.y%20=%202;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20#BEGIN_EDITABLE#%20%20%20%20#END_EDITABLE#%0D%0A%7D;##JS_E####CODE_11E####LOGIC_11####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60window.requestAnimationFrame(render);%60);%0Apass.if.js.editable(1).equivalent(%60%60);##JS_E####LOGIC_11E####STEP_11E####STEP_12####INST_12##Collision%0A%0AYour%20instructor%20will%20explain%20how%20to%20detect%20collision,%20then%20you%20must%20complete%20the%20following%20and%20get%20approval%20from%20the%20instructor.%0A%0A(***)%0A%0A(!)Change%20the%20box%20colour%20to%20*firebrick*%20when%20it%20collides%20with%20the%20frame%20edges.##INST_12E####CODE_12####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%20/%3E%0D%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/head%3E%0D%0A%0D%0A%3Cbody%3E%0D%0A%20%20%20%20%3Ccanvas%20id='frame'%3E%3C/canvas%3E%0D%0A%3C/body%3E%0D%0A%0D%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS###frame%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20left:%2050%25;%0D%0A%20%20%20%20top:%2050%25;%0D%0A%20%20%20%20border:%201px%20solid%20gray;%0D%0A%20%20%20%20transform:%20translate(-50%25,%20-50%25);%0D%0A%20%20%20%20background-color:%20whitesmoke;%0D%0A%7D#BEGIN_EDITABLE##END_EDITABLE###CSS_E####JS##var%20ctx;%0D%0Avar%20box%20=%20%7B%20width:%2050,%20height:%2050%20%7D;%0D%0Avar%20speed%20=%20%7B%20x:%200,%20y:%200%20%7D;%0D%0Avar%20position%20=%20%7B%20x:%200,%20y:%200%20%7D;%0D%0A%0D%0Afunction%20render()%20%7B%0D%0A%20%20%20%20//%20clear%20the%20canvas%0D%0A%20%20%20%20ctx.fillStyle%20=%20'whitesmoke';%0D%0A%20%20%20%20ctx.fillRect(0,%200,%20frame.width,%20frame.height);%0D%0A%0D%0A%20%20%20%20//%20calculate%20new%20position%0D%0A%20%20%20%20position.x%20=%20Math.min(Math.max(position.x%20+%20speed.x,%200),%20frame.width%20-%20box.width);%0D%0A%20%20%20%20position.y%20=%20Math.min(Math.max(position.y%20+%20speed.y,%200),%20frame.height%20-%20box.height);%0D%0A%0D%0A%20%20%20%20//%20detect%20collision%0D%0A%20%20%20%20var%20xCollision%20=%20position.x%20===%200%20%7C%7C%20position.x%20==%20frame.width%20-%20box.width;%0D%0A%20%20%20%20var%20yCollision%20=%20position.y%20===%200%20%7C%7C%20position.y%20==%20frame.height%20-%20box.height;%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'mediumspringgreen';%0D%0A%20%20%20%20%0D%0A%20%20%20%20#BEGIN_EDITABLE#%0D%0A%20%20%20%20if%20(xCollision%20%7C%7C%20yCollision)%20%7B%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'firebrick';%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20//%20regain%20shell%0D%0A%20%20%20%20#END_EDITABLE#%0D%0A%0D%0A%20%20%20%20ctx.fillRect(position.x,%20position.y,%20box.width,%20box.height);%0D%0A%0D%0A%20%20%20%20window.requestAnimationFrame(render);%0D%0A%7D%0D%0A%0D%0Awindow.onload%20=%20function%20()%20%7B%0D%0A%20%20%20%20frame.width%20=%20400;%0D%0A%20%20%20%20frame.height%20=%20300;%0D%0A%0D%0A%20%20%20%20position%20=%20%7B%0D%0A%20%20%20%20%20%20%20%20x:%20frame.width%20/%202%20-%20box.width%20/%202,%0D%0A%20%20%20%20%20%20%20%20y:%20frame.height%20/%202%20-%20box.height%20/%202,%0D%0A%20%20%20%20%7D;%0D%0A%0D%0A%20%20%20%20ctx%20=%20frame.getContext('2d');%0D%0A%0D%0A%20%20%20%20render();%0D%0A%7D;%0D%0A%0D%0Awindow.onkeydown%20=%20function%20()%20%7B%0D%0A%20%20%20%20speed%20=%20%7B%20x:%200,%20y:%200%20%7D;%0D%0A%0D%0A%20%20%20%20if%20(event.key%20===%20'ArrowLeft')%20%7B%0D%0A%20%20%20%20%20%20%20%20speed.x%20=%20-2;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(event.key%20===%20'ArrowRight')%20%7B%0D%0A%20%20%20%20%20%20%20%20speed.x%20=%202;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(event.key%20===%20'ArrowUp')%20%7B%0D%0A%20%20%20%20%20%20%20%20speed.y%20=%20-2;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(event.key%20===%20'ArrowDown')%20%7B%0D%0A%20%20%20%20%20%20%20%20speed.y%20=%202;%0D%0A%20%20%20%20%7D%0D%0A%7D;##JS_E####CODE_12E####LOGIC_12####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass().if(code.js.editable%5B0%5D.includes('regain%20shell')).is.true;##JS_E####LOGIC_12E####STEP_12E####STEP_13####INST_13##Intro%20to%20class%0A%0AYour%20instructor%20will%20explain%20how%20to%20use%20classes,%20then%20you%20must%20complete%20the%20following%20and%20get%20approval%20from%20the%20instructor.%0A%0A(***)%0A%0A(!)1.%20Create%20an%20instance%20of%20the%20*Person*%20class.%0A(!)2.%20Call%20the%20*sayHello*%20function%20on%20the%20person%20instance.##INST_13E####CODE_13####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%20/%3E%0D%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/head%3E%0D%0A%0D%0A%3Cbody%3E%0D%0A%20%20%20%20%0D%0A%3C/body%3E%0D%0A%0D%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS####CSS_E####JS##class%20Person%20%7B%0A%20%20%20%20constructor%20(name,%20origin,%20age,%20isTennisPlayer)%20%7B%0A%20%20%20%20%20%20%20%20this.name%20=%20name;%0A%20%20%20%20%20%20%20%20this.origin%20=%20origin;%0A%20%20%20%20%20%20%20%20this.age%20=%20age;%0A%20%20%20%20%20%20%20%20this.isTennisPlayer%20=%20isTennisPlayer;%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20sayHello()%20%7B%0A%20%20%20%20%20%20%20%20console.log('Hello,%20I%20am%20'%20+%20this.name%20+%20',%20nice%20to%20meet%20you.');%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20#BEGIN_EDITABLE#%0A%20%20%20%20about()%20%7B%0A%20%20%20%20%20%20%20%20console.log('I%20am%20a%20'%20+%20this.age%20+%20'%20year%20old%20from%20HK.');%0A%20%20%20%20%20%20%20%20if%20(this.isTennisPlayer)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.log('I%20love%20playing%20tennis.');%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.log(%22I'm%20really%20bad%20at%20tennis.%22);%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20#END_EDITABLE#%0A%7D%0A%0A#BEGIN_EDITABLE#%0Ajohn%20=%20new%20Person('John',%20'HK',%2015,%20true);%0Ajohn.sayHello();%0Ajohn.about();%0A//%20borrow%20gather%0A#END_EDITABLE###JS_E####CODE_13E####LOGIC_13####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass().if(code.js.editable%5B1%5D.includes('borrow%20gather')).is.true;##JS_E####LOGIC_13E####STEP_13E####STEP_14####INST_14##Create%20a%20new%20snake%0A%0AYour%20instructor%20will%20demonstrate%20how%20to%20add%20a%20new%20snake,%20then%20you%20must%20complete%20the%20following%20and%20get%20approval%20from%20the%20instructor.%0A%0A(***)%0A%0A(!)1.%20On%20+js#two-player#+1,%20create%20a%20variable%20to%20indicate%20two-player%20mode.%0A(!)2.%20On%20+js#var%20gameHasStarted#+2%20&%20js#var%20gameHasStarted#+3,%20create%20two%20empty%20variables%20to%20store%20player%20names.%0A(!)3.%20On%20+js#keydown#+1,%20change%20the%20event%20handler%20to%20*selectMode*%0A(!)4.%20On%20+js#function%20ask#-2,%20create%20a%20function%20called%20*selectMode*.%0A(!)5.%20On%20+js#push(snake1)#+2,%20modify%20the%20*createSnakes*%20function%20to%20work%20with%20two-player%20mode.%0A(!)6.%20On%20+js#buttons%20visible#+1,%20set%20the%20button%20visibility%20back%20to%20*visible*.##INST_14E####CODE_14####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%20/%3E%0D%0A%20%20%20%20%3Clink%20href=%22https://fonts.googleapis.com/css?family=Nunito:200,400,700%22%20rel=%22stylesheet%22%3E%0D%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/head%3E%0D%0A%0D%0A%3Cbody%3E%0D%0A%0D%0A%20%20%20%20%3Ch1%3ESnake%20Game%3C/h1%3E%0D%0A%0D%0A%20%20%20%20%3Cdiv%20id=%22points-wrapper%22%3E%0D%0A%20%20%20%20%20%20%20%20%3Cp%20id=%22pointsLabel%22%3EPoints:%200%3C/p%3E%0D%0A%20%20%20%20%3C/div%3E%0D%0A%0D%0A%20%20%20%20%3Ccanvas%20id=%22gc%22%20width=%22400%22%20height=%22400%22%3E%3C/canvas%3E%0D%0A%0D%0A%20%20%20%20%3Cdiv%20id=%22button-wrapper%22%3E%0D%0A%20%20%20%20%20%20%20%20%3Cbutton%20id='playButton'%3EPlay%3C/button%3E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%3Cp%20id=%22playerLabel%22%3ETwo%20player:%3C/p%3E%0D%0A%20%20%20%20%20%20%20%20%3Clabel%20id=%22playerSwitch%22%20class=%22switch%22%3E%0D%0A%09%09%09%3Cinput%20id=%22playerCheckbox%22%20type=%22checkbox%22%3E%0D%0A%09%09%09%3Cspan%20id=%22slider%22%20class=%22slider%20round%22%3E%3C/span%3E%0D%0A%09%09%3C/label%3E%0D%0A%20%20%20%20%3C/div%3E%0D%0A%20%20%20%20%0D%0A%3C/body%3E%0D%0A%0D%0A%3C/html%3E##HTML_E####CSS##*%20%7B%0D%0A%20%20%20%20font-family:%20%22Nunito%22;%0D%0A%20%20%09text-align:%20center;%0D%0A%7D%0D%0A%0D%0Ah1%20%7B%0D%0A%20%20%20%20font-size:%2035px;%0D%0A%20%20%20%20font-weight:%20200;%0D%0A%7D%0D%0A%0D%0Ap%20%7B%0D%0A%20%20%20%20font-size:%2015;%0D%0A%20%20%20%20font-weight:%20700;%0D%0A%7D%0D%0A%0D%0Acanvas%20%7B%0D%0A%20%20%20%20padding-left:%200;%0D%0A%20%20%20%20padding-right:%200;%0D%0A%20%20%20%20margin-left:%20auto;%0D%0A%20%20%20%20margin-right:%20auto;%0D%0A%20%20%20%20display:%20block;%0D%0A%20%20%20%20width:%20400px;%0D%0A%7D%0D%0A%0D%0Abutton%20%7B%0D%0A%20%20%20%20font-size:%2014px;%0D%0A%20%20%20%20margin:%205px;%0D%0A%7D%0D%0A%0D%0A#points%20%7B%0D%0A%20%20%20%20text-align:%20right;%0D%0A%7D%0D%0A%0D%0A#points-wrapper%20%7B%0D%0A%20%20%20%20width:%20400px;%0D%0A%20%20%20%20margin:%20auto;%0D%0A%7D%0D%0A%0D%0A#button-wrapper%20%7B%0D%0A%20%20%20%20display:%20flex;%0D%0A%20%20%20%20align-items:%20center;%0D%0A%20%20%20%20justify-content:%20center;%0D%0A%7D%0D%0A%0D%0A#select-difficulty%20%7B%0D%0A%20%20%20%20margin-bottom:%200;%0D%0A%7D%0D%0A%0D%0A#playerLabel%20%7B%0D%0A%20%20%20%20margin-left:%205px;%0D%0A%20%20%20%20margin-right:%205px;%0D%0A%20%20%20%20font-weight:%20100;%0D%0A%7D%0D%0A%0D%0A%0D%0A/*%20The%20switch%20-%20the%20box%20around%20the%20slider%20*/%0D%0A%0D%0A.switch%20%7B%0D%0A%20%20%20%20position:%20relative;%0D%0A%20%20%20%20display:%20inline-block;%0D%0A%20%20%20%20width:%2050px;%0D%0A%20%20%20%20height:%2030px;%0D%0A%20%20%20%20margin-left:%205px;%0D%0A%7D%0D%0A%0D%0A%0D%0A/*%20Hide%20default%20HTML%20checkbox%20*/%0D%0A%0D%0A.switch%20input%20%7B%0D%0A%20%20%20%20display:%20none;%0D%0A%7D%0D%0A%0D%0A%0D%0A/*%20The%20slider%20*/%0D%0A%0D%0A.slider%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20cursor:%20pointer;%0D%0A%20%20%20%20top:%200;%0D%0A%20%20%20%20left:%200;%0D%0A%20%20%20%20right:%200;%0D%0A%20%20%20%20bottom:%200;%0D%0A%20%20%20%20background-color:%20#ccc;%0D%0A%20%20%20%20-webkit-transition:%20.4s;%0D%0A%20%20%20%20transition:%20.4s;%0D%0A%7D%0D%0A%0D%0A.slider:before%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20content:%20%22%22;%0D%0A%20%20%20%20height:%2022px;%0D%0A%20%20%20%20width:%2022px;%0D%0A%20%20%20%20left:%204px;%0D%0A%20%20%20%20bottom:%204px;%0D%0A%20%20%20%20background-color:%20white;%0D%0A%20%20%20%20-webkit-transition:%20.4s;%0D%0A%20%20%20%20transition:%20.4s;%0D%0A%7D%0D%0A%0D%0Ainput:checked+.slider%20%7B%0D%0A%20%20%20%20background-color:%20#2196F3;%0D%0A%7D%0D%0A%0D%0Ainput:focus+.slider%20%7B%0D%0A%20%20%20%20box-shadow:%200%200%201px%20#2196F3;%0D%0A%7D%0D%0A%0D%0Ainput:checked+.slider:before%20%7B%0D%0A%20%20%20%20-webkit-transform:%20translateX(22px);%0D%0A%20%20%20%20-ms-transform:%20translateX(20px);%0D%0A%20%20%20%20transform:%20translateX(20px);%0D%0A%7D%0D%0A%0D%0A%0D%0A/*%20Rounded%20sliders%20*/%0D%0A%0D%0A.slider.round%20%7B%0D%0A%20%20%20%20border-radius:%2020px;%0D%0A%7D%0D%0A%0D%0A.slider.round:before%20%7B%0D%0A%20%20%20%20border-radius:%2050%25;%0D%0A%7D#BEGIN_EDITABLE##END_EDITABLE###CSS_E####JS##//%20Segment%20types%20of%20the%20snake%0D%0Avar%20SegmentType%20=%20Object.freeze(%7B%20'head':%201,%20'body':%202,%20'tail':%203%20%7D);%0D%0A//%20Directions%20the%20snake%20can%20travel%0D%0Avar%20Direction%20=%20Object.freeze(%7B%20'up':%20%7B%20'x':%200,%20'y':%20-1%20%7D,%20'down':%20%7B%20'x':%200,%20'y':%201%20%7D,%20'right':%20%7B%20'x':%201,%20'y':%200%20%7D,%20'left':%20%7B%20'x':%20-1,%20'y':%200%20%7D%20%7D);%0D%0A%0D%0A//%20Array%20of%20the%20snakes%20playing%20the%20game%0D%0Avar%20snakes%20=%20%5B%5D;%0D%0A%0D%0A//%20Array%20of%20obstacles%20for%20the%20current%20game%20mode%0D%0Alet%20obstacles%20=%20%5B%5D;%0D%0A%0D%0A//%20The%20current%20apple%20on%20the%20screen%0D%0Avar%20apple;%0D%0A%0D%0A//%20How%20big%20each%20grid%20is%20(px)%0D%0Avar%20gridSize%20=%2020;%0D%0A//%20How%20many%20grids%20are%20in%20the%20canvas%0D%0Avar%20tileCount%20=%2020;%0D%0A//%20How%20many%20times%20the%20scene%20is%20redrawn,%20per%20second%0D%0Avar%20refreshRate%20=%208;%0D%0A%0D%0A//%20Boolean%20indicating%20whether%20two-player%20mode%20is%20on%20or%20off%0D%0A#BEGIN_EDITABLE#var%20isTwoPlayer%20=%20false;#END_EDITABLE#%0D%0A//%20Boolean%20indicating%20whether%20the%20game%20is%20currently%20in%20progress%0D%0Avar%20gameHasStarted%20=%20false;%0D%0A%0D%0A#BEGIN_EDITABLE#var%20player1Name;#END_EDITABLE#%0D%0A#BEGIN_EDITABLE#var%20player2Name;#END_EDITABLE#%0D%0A%0D%0A//%20Define%20the%20function%20to%20be%20called%20when%20the%20window%20loads%0D%0Awindow.onload%20=%20function%20()%20%7B%0D%0A%0D%0A%20%20%20%20//%20Set%20up%20the%20graphics%0D%0A%20%20%09gc.width%20=%20tileCount%20*%20gridSize;%0D%0A%20%20%09gc.height%20=%20tileCount%20*%20gridSize;%0D%0A%20%20%20%20ctx%20=%20gc.getContext('2d');%0D%0A%09%0D%0A%09playerCheckbox.onchange%20=%20function%20()%20%7B%0D%0A%20%20%20%20%20%20%20%20isTwoPlayer%20=%20playerCheckbox.checked;%0D%0A%20%20%20%20%7D;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20Draw%20the%20opening%20screen%0D%0A%20%20%20%20drawStartingScreen();%0D%0A%0D%0A%20%20%09//%20Add%20listener%20for%20key%20presses%0D%0A%20%20%20%20document.addEventListener('keydown',%20keyPush);%0D%0A%20%20%09playButton.addEventListener('click',%20#BEGIN_EDITABLE#selectMode#END_EDITABLE#);%0D%0A%20%20%09%0D%0A%7D;%0D%0A%0D%0A#BEGIN_EDITABLE#%0D%0Afunction%20selectMode()%20%7B%0D%0A%0D%0A%20%20%20%20if%20(isTwoPlayer)%20%7B%0D%0A%20%20%20%20%20%20%20%20askForPlayerNames();%0D%0A%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20startGame();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20setButtonsVisibility('hidden');%0D%0A%0D%0A%7D%0D%0A//%20borrow%20gather%0D%0A#END_EDITABLE#%0D%0A%0D%0Afunction%20askForPlayerNames()%20%7B%0D%0A%0D%0A%20%20%20%20showNamePopup('Player%201%20(left%20snake),%20what%20is%20your%20name?',%20function%20()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20showNamePopup('Player%202%20(right%20snake),%20what%20is%20your%20name?',%20function%20()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20startGame();%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%7D);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20showNamePopup(text,%20handler)%20%7B%0D%0A%0D%0A%20%20%20%20const%20popupBackground%20=%20document.createElement('div');%0D%0A%0D%0A%20%20%20%20popupBackground.style.position%20=%20'absolute';%0D%0A%20%20%20%20popupBackground.style.width%20=%20%60$%7Bwindow.innerWidth%7Dpx%60;%0D%0A%20%20%20%20popupBackground.style.height%20=%20%60$%7Bwindow.innerHeight%7Dpx%60;%0D%0A%20%20%20%20popupBackground.style.left%20=%20'0px';%0D%0A%20%20%20%20popupBackground.style.top%20=%20'0px';%0D%0A%0D%0A%20%20%20%20popupBackground.style.backgroundColor%20=%20'white';%0D%0A%20%20%20%20popupBackground.style.opacity%20=%20'0.7';%0D%0A%0D%0A%20%20%20%20document.body.appendChild(popupBackground);%0D%0A%0D%0A%20%20%20%20const%20banner%20=%20document.createElement('div');%0D%0A%0D%0A%20%20%20%20banner.style.position%20=%20'absolute';%0D%0A%20%20%20%20banner.style.width%20=%20%60$%7Bwindow.innerWidth%7Dpx%60;%0D%0A%20%20%20%20banner.style.height%20=%20'200px';%0D%0A%0D%0A%20%20%20%20document.body.appendChild(banner);%0D%0A%0D%0A%20%20%20%20banner.style.left%20=%20'0px';%0D%0A%20%20%20%20banner.style.top%20=%20%60$%7Bwindow.innerHeight%20/%202%20-%20banner.offsetHeight%20/%202%7Dpx%60;%0D%0A%0D%0A%20%20%20%20banner.style.backgroundColor%20=%20'black';%0D%0A%20%20%20%20banner.style.opacity%20=%20'1.0';%0D%0A%0D%0A%20%20%20%20const%20prompt%20=%20document.createElement('h3');%0D%0A%0D%0A%20%20%20%20prompt.style.position%20=%20'absolute';%0D%0A%20%20%20%20prompt.style.width%20=%20%60$%7Bbanner.offsetWidth%7Dpx%60;%0D%0A%20%20%20%20prompt.style.height%20=%20'30px';%0D%0A%0D%0A%20%20%20%20banner.appendChild(prompt);%0D%0A%0D%0A%20%20%20%20prompt.style.top%20=%20%60$%7Bbanner.offsetHeight%20/%204%7Dpx%60;%0D%0A%20%20%20%20prompt.style.left%20=%20'0px';%0D%0A%0D%0A%20%20%20%20prompt.style.margin%20=%20'0%200%200%200';%0D%0A%20%20%20%20prompt.style.fontSize%20=%20'25px';%0D%0A%20%20%20%20prompt.style.color%20=%20'white';%0D%0A%20%20%20%20prompt.style.fontFamily%20=%20'Nunito';%0D%0A%20%20%20%20prompt.textContent%20=%20text;%0D%0A%0D%0A%20%20%20%20var%20input%20=%20document.createElement('input');%0D%0A%0D%0A%20%20%20%20input.type%20=%20'text';%0D%0A%20%20%20%20input.style.position%20=%20'absolute';%0D%0A%20%20%20%20input.style.width%20=%20'200px';%0D%0A%20%20%20%20input.style.textAlign%20=%20'center';%0D%0A%0D%0A%20%20%20%20banner.appendChild(input);%0D%0A%0D%0A%20%20%20%20input.style.left%20=%20%60$%7Bbanner.offsetWidth%20/%202%20-%20input.offsetWidth%20/%202%7Dpx%60;%0D%0A%20%20%20%20input.style.top%20=%20%60$%7Bprompt.offsetTop%20+%20prompt.offsetHeight%20+%2025%7Dpx%60;%0D%0A%0D%0A%20%20%20%20const%20okayButton%20=%20document.createElement('button');%0D%0A%0D%0A%20%20%20%20okayButton.textContent%20=%20'Okay';%0D%0A%20%20%20%20okayButton.style.position%20=%20'absolute';%0D%0A%20%20%20%20okayButton.style.textAlign%20=%20'center';%0D%0A%20%20%20%20okayButton.style.borderRadius%20=%20'5px';%0D%0A%0D%0A%20%20%20%20banner.appendChild(okayButton);%0D%0A%0D%0A%20%20%20%20okayButton.style.left%20=%20%60$%7Bbanner.offsetWidth%20/%202%20-%20okayButton.offsetWidth%20/%202%7Dpx%60;%0D%0A%20%20%20%20okayButton.style.top%20=%20%60$%7Binput.offsetTop%20+%20input.offsetHeight%20+%2010%7Dpx%60;%0D%0A%0D%0A%20%20%20%20okayButton.onclick%20=%20()%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20validate%20user%20input%0D%0A%20%20%20%20%20%20%20%20if%20(!input.value.trim().length)%20return;%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(player1Name%20==%20null)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20player1Name%20=%20input.value;%0D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20player2Name%20=%20input.value;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20document.body.removeChild(popupBackground);%0D%0A%20%20%20%20%20%20%20%20document.body.removeChild(banner);%0D%0A%0D%0A%20%20%20%20%20%20%20%20handler();%0D%0A%0D%0A%20%20%20%20%7D;%0D%0A%0D%0A%7D%0D%0A%0D%0A//%20Function:%20hide/show%20difficulty%20buttons%20and%20label%20%0D%0Afunction%20setButtonsVisibility(visibility)%20%7B%0D%0A%0D%0A%20%20%20%20playButton.style.visibility%20=%20visibility;%0D%0A%20%20%20%20playerLabel.style.visibility%20=%20visibility;%0D%0A%20%20%20%20playerSwitch.style.visibility%20=%20visibility;%0D%0A%20%20%20%20playerCheckbox.style.visibility%20=%20visibility;%0D%0A%20%20%20%20slider.style.visibility%20=%20visibility;%0D%0A%0D%0A%7D%0D%0A%0D%0A//%20Function:%20starting%20the%20game%20(canvas%20starts%20to%20refresh)%0D%0Afunction%20startGame()%20%7B%0D%0A%0D%0A%20%20%20%20gameHasStarted%20=%20true;%0D%0A%0D%0A%20%20%20%20//%20Create%20how%20many%20snakes%20you%20want%0D%0A%20%20%20%20createSnakes();%0D%0A%0D%0A%20%20%20%20//%20Randomize%20the%20location%20of%20the%20starting%20apple%0D%0A%20%20%20%20spawnNewApple();%0D%0A%0D%0A%20%20%20%20//%20Start%20the%20graphics,%20at%20a%2015%20refreshes%20per%20second%20rate%0D%0A%20%20%20%20window.refresher%20=%20setInterval(refreshGame,%201000%20/%20refreshRate);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20createSnakes()%20%7B%0D%0A%0D%0A%20%20%20%20snakes%20=%20%5B%5D;%0D%0A%0D%0A%20%20%20%20const%20snake1%20=%20new%20Snake(1,%209,%20'green',%20player1Name);%0D%0A%20%20%20%20snake1.control%20=%20%7B%20up:%20'KeyW',%20down:%20'KeyS',%20left:%20'KeyA',%20right:%20'KeyD'%20%7D;%0D%0A%20%20%20%20snakes.push(snake1);%0D%0A%20%20%20%20%0D%0A%20%20%20%20#BEGIN_EDITABLE#%0D%0A%20%20%20%20if%20(isTwoPlayer)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20snake2%20=%20new%20Snake(18,%209,%20'blue',%20player2Name);%0D%0A%20%20%20%20%20%20%20%20snake2.control%20=%20%7B%20up:%20'ArrowUp',%20down:%20'ArrowDown',%20left:%20'ArrowLeft',%20right:%20'ArrowRight'%20%7D;%0D%0A%20%20%20%20%20%20%20%20snakes.push(snake2);%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20#END_EDITABLE#%0D%0A%0D%0A%7D%0D%0A%0D%0A//%20Function:%20called%20multiple%20times%20a%20second%20to%20refresh%20the%20canvas%0D%0Afunction%20refreshGame()%20%7B%0D%0A%0D%0A%20%20%20%20clearCanvas();%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20apple%0D%0A%20%20%20%20apple.draw(ctx);%0D%0A%0D%0A%20%20%20%20refreshSnakes();%0D%0A%0D%0A%20%20%20%20//%20Check%20if%20snakes%20have%20run%20into%20each%20other%0D%0A%20%20%20%20checkForSnakeCollision();%0D%0A%0D%0A%20%20%20%20updatePointsLabel();%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20refreshSnakes()%20%7B%0D%0A%0D%0A%20%20%20%20//%20If%20any%20snake%20draw%20fails,%20stop%20all%20drawing%0D%0A%20%20%20%20snakes.every(snake%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(snake.draw(ctx))%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20snake.checkForApple();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20true;%0D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20checkForSnakeCollision()%20%7B%0D%0A%0D%0A%20%20%20%20var%20losingSnakes%20=%20%5B%5D;%0D%0A%20%20%20%20snakes.forEach(snake%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(snake.checkForSnakeCollision())%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20losingSnakes.push(snake);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20if%20(losingSnakes.length)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerLoses(losingSnakes);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%7D%0D%0A%0D%0A//%20Function:%20resetting%20the%20game%20(if%20the%20player%20dies)%0D%0Afunction%20resetGame()%20%7B%0D%0A%0D%0A%20%20%20%20player1Name%20=%20null;%0D%0A%20%20%20%20player2Name%20=%20null;%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20starting%20snake%20screen%0D%0A%20%20%20%20drawStartingScreen();%0D%0A%0D%0A%20%20%20%20//%20Make%20the%20buttons%20visible%20again%0D%0A%20%20%20%20#BEGIN_EDITABLE#setButtonsVisibility('visible');#END_EDITABLE#%0D%0A%20%20%20%20%0D%0A%20%20%20%20updatePointsLabel();%0D%0A%7D%0D%0A%0D%0A//%20Function:%20handles%20the%20playing-losing%20event%0D%0Afunction%20playerLoses(losingSnakes)%20%7B%0D%0A%0D%0A%20%20%20%20gameHasStarted%20=%20false;%0D%0A%0D%0A%20%20%20%20//%20Stop%20the%20canvas%20from%20refreshing%0D%0A%20%20%20%20clearInterval(window.refresher);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20screen%20showing%20the%20%22L%22%20snake%0D%0A%20%20%20%20drawLosingScreen();%0D%0A%0D%0A%20%20%20%20//%20Wait%203%20seconds,%20and%20then%20reset%20the%20game%0D%0A%20%20%20%20setTimeout(resetGame,%203000);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20spawnNewApple()%20%7B%0D%0A%20%20%20%20apple%20=%20new%20Apple();%0D%0A%7D%0D%0A%0D%0Afunction%20clearCanvas()%20%7B%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(0,%200,%20gc.width,%20gc.height);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20updatePointsLabel()%20%7B%0D%0A%20%20%20%20pointsLabel.innerHTML%20=%20gameHasStarted%20?%20'Points:%20'%20+%20String(snakes%5B0%5D.points)%20:%20'Points:%200';%0D%0A%7D%0D%0A%0D%0Afunction%20keyPush(evt)%20%7B%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(!gameHasStarted)%20%7B%0D%0A%20%20%20%20%20%20%20%20return;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20evt.preventDefault();%0D%0A%0D%0A%20%20%20%20snakes.forEach(snake%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(evt.code%20===%20snake.control.up)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20snake.setDirection(Direction.up);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20if%20(evt.code%20===%20snake.control.down)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20snake.setDirection(Direction.down);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20if%20(evt.code%20===%20snake.control.left)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20snake.setDirection(Direction.left);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20if%20(evt.code%20===%20snake.control.right)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20snake.setDirection(Direction.right);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20drawLosingScreen()%20%7B%0D%0A%0D%0A%20%20%20%20clearCanvas();%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(0,%200,%20gc.width,%20gc.height);%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'green';%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize,%203%20*%20gridSize,%208%20*%20gridSize,%2014%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(8%20*%20gridSize,%203%20*%20gridSize,%206%20*%20gridSize,%2012%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20triangle%20tail%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(13%20*%20gridSize,%2015%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize,%2016%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize,%2015%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(13%20*%20gridSize,%2017%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize,%2016%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize,%2017%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20eyes%0D%0A%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%203%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%20%20%20%20ctx.fillRect(7%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%203%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20tongue%0D%0A%20%20%20%20ctx.fillStyle%20=%20'pink';%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize%20+%205%20/%206%20*%20gridSize,%202.5%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%202%20*%20gridSize);%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(7%20*%20gridSize,%202.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(7%20*%20gridSize,%202%20*%20gridSize%20+%203%20/%208%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6.5%20*%20gridSize,%202%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize%20+%205%20/%206%20*%20gridSize,%202.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(7%20*%20gridSize,%202.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(7%20*%20gridSize,%202%20*%20gridSize%20+%203%20/%208%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(7.5%20*%20gridSize,%202%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(7%20*%20gridSize%20+%201%20/%206%20*%20gridSize,%202.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20drawStartingScreen()%20%7B%0D%0A%0D%0A%20%20%20%20clearCanvas();%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(0,%200,%20gc.width,%20gc.height);%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'green';%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize,%203%20*%20gridSize,%208%20*%20gridSize,%2014%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(8%20*%20gridSize,%205%20*%20gridSize,%206%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize,%2011%20*%20gridSize,%206%20*%20gridSize,%204%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20triangle%20tail%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(7%20*%20gridSize,%2015%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize,%2016%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize,%2015%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(7%20*%20gridSize,%2017%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize,%2016%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize,%2017%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20eyes%0D%0A%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20ctx.fillRect(13%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%203%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%20%20%20%20ctx.fillRect(13%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%204%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20tongue%0D%0A%20%20%20%20ctx.fillStyle%20=%20'pink';%0D%0A%20%20%20%20ctx.fillRect(14%20*%20gridSize,%203%20*%20gridSize%20+%205%20/%206%20*%20gridSize,%201%20/%202%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(14.5%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize%20+%205%20/%208%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(15%20*%20gridSize,%203.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14.5%20*%20gridSize,%203%20*%20gridSize%20+%205%20/%206%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(14.5%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize%20+%205%20/%208%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(15%20*%20gridSize,%204.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14.5%20*%20gridSize,%204%20*%20gridSize%20+%201%20/%206%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%7D%0D%0A%0D%0Aclass%20Snake%20%7B%0D%0A%0D%0A%20%20%20%20constructor(x,%20y,%20color,%20name%20=%20'Snakey')%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20An%20array%20of%20SnakeSegments%0D%0A%20%20%20%20%20%20%20%20this.segments%20=%20%5B%5D;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.color%20=%20color;%0D%0A%20%20%20%20%20%20%20%20this.altColor%20=%20color;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.name%20=%20name;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.direction%20=%20Direction.up;%0D%0A%20%20%20%20%20%20%20%20this.pendingTurn%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Coordinates%20of%20the%20head%20of%20the%20snake%0D%0A%20%20%20%20%20%20%20%20this.x%20=%20x;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%20y;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.prevTailPos%20=%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20x:%200,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20y:%200%0D%0A%20%20%20%20%20%20%20%20%7D;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.points%20=%200;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.generateSnake();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20generateSnake()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Create%20the%20initial%20snake%0D%0A%20%20%20%20%20%20%20%20const%20startSize%20=%205;%0D%0A%20%20%20%20%20%20%20%20for%20(var%20i%20=%200;%20i%20%3C%20startSize;%20i++)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20segment;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!i)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20segment%20=%20new%20SnakeSegment(this.x,%20this.y,%20this.color,%20SegmentType.head);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20(i%20===%20startSize%20-%201)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20segment%20=%20new%20SnakeSegment(this.x,%20this.y,%20this.color,%20SegmentType.tail);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20segment%20=%20new%20SnakeSegment(this.x,%20this.y,%20this.color,%20SegmentType.body);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20this.segments.push(segment);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20drawSnakeTail()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20tail%20=%20this.tail;%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20preTail%20=%20this.getSegment(this.segments.length%20-%202);%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Get%20the%20direction%20that%20the%20tail%20is%20moving%20in%0D%0A%20%20%20%20%20%20%20%20var%20tailXVelocity%20=%20preTail.position.x%20-%20tail.position.x;%0D%0A%20%20%20%20%20%20%20%20var%20tailYVelocity%20=%20preTail.position.y%20-%20tail.position.y;%0D%0A%0D%0A%20%20%20%20%20%20%20%20switch%20(tailXVelocity)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%201:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.moveTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize%20+%209);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20-1:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.moveTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize%20+%209);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%200:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20switch%20(tailYVelocity)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%201:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.moveTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%209,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20-1:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.moveTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%209,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20drawSnakeEyes()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20head%20=%20this.head;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Giving%20the%20snake%20eyes%20based%20off%20of%20its%20direction%0D%0A%20%20%20%20%20%20%20%20switch%20(this.direction.x)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%201:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%2012,%20head.position.y%20*%20gridSize%20+%203,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%2012,%20head.position.y%20*%20gridSize%20+%2011,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20-1:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%202,%20head.position.y%20*%20gridSize%20+%203,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%202,%20head.position.y%20*%20gridSize%20+%2011,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%200:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20switch%20(this.direction.y)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%201:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%203,%20head.position.y%20*%20gridSize%20+%2012,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%2011,%20head.position.y%20*%20gridSize%20+%2012,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20-1:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%203,%20head.position.y%20*%20gridSize%20+%202,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%2011,%20head.position.y%20*%20gridSize%20+%202,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20this.color;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20Called%20to%20draw%20the%20entire%20snake%0D%0A%20%20%20%20draw(ctx)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20this.color;%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20success%20=%20this.updatePositions();%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(!success)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20for%20(var%20i%20=%200;%20i%20%3C%20this.segments.length;%20i++)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20If%20drawing%20the%20tail%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(i%20==%20this.segments.length%20-%201)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.drawSnakeTail();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(this.segments%5Bi%5D.x%20*%20gridSize,%20this.segments%5Bi%5D.y%20*%20gridSize,%20gridSize%20-%202,%20gridSize%20-%202);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20If%20drawing%20the%20head%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!i)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.drawSnakeEyes();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20return%20true;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20updatePositions()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.pendingTurn%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Expressions%20account%20for%20vertical%20and%20horizontal%20wrapping%0D%0A%20%20%20%20%20%20%20%20const%20newX%20=%20this.x%20+%20this.direction.x%20%3E%20tileCount%20-%201%20?%200%20:%20(this.x%20+%20this.direction.x%20%3C%200%20?%20tileCount%20-%201%20:%20this.x%20+%20this.direction.x);%0D%0A%20%20%20%20%20%20%20%20const%20newY%20=%20this.y%20+%20this.direction.y%20%3E%20tileCount%20-%201%20?%200%20:%20(this.y%20+%20this.direction.y%20%3C%200%20?%20tileCount%20-%201%20:%20this.y%20+%20this.direction.y);%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.x%20=%20newX;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%20newY;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Check%20if%20the%20snake%20ran%20into%20an%20obstacle%0D%0A%20%20%20%20%20%20%20%20const%20collision%20=%20obstacles.some(obstacle%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20obstacle.isCollision(this.x,%20this.y);%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(collision)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20playerLoses(%5Bthis%5D);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Go%20through%20the%20segments%20from%20the%20tail%20to%20the%20head,%20assigning%20each%20segment's%20x%20and%20y%20equal%20to%20the%20next%20segment's%20position%0D%0A%20%20%20%20%20%20%20%20for%20(var%20i%20=%20this.segments.length%20-%201;%20i%20%3E=%200;%20i--)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!i)%20%7B%20//%20For%20the%20head%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.segments%5Bi%5D.setPosition(this.x,%20this.y);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(i%20===%20this.segments.length%20-%201)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.prevTailPos%20=%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x:%20this.segments%5Bi%5D.x,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y:%20this.segments%5Bi%5D.y%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20nextX%20=%20this.segments%5Bi%20-%201%5D.x;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20nextY%20=%20this.segments%5Bi%20-%201%5D.y;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(nextX%20===%20this.x%20&&%20nextY%20===%20this.y)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerLoses(this);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.segments%5Bi%5D.setPosition(nextX,%20nextY);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20return%20true;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20checkForApple()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(this.x%20===%20apple.position.x%20&&%20this.y%20===%20apple.position.y)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%09this.points++;%0D%0A%20%20%20%20%20%20%20%20%20%20%09this.addSegment();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20spawnNewApple();%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20Checks%20if%20this%20snake%20has%20run%20into%20any%20other%20snake%0D%0A%20%20%20%20checkForSnakeCollision()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20return%20snakes.some(snake%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(snake%20!==%20this)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20snake.segments.some(segment%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(segment.position.x%20===%20this.x%20&&%20segment.position.y%20===%20this.y)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20addSegment()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20tailSegment%20=%20this.segments%5Bthis.segments.length%20-%201%5D;%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20newSegment%20=%20new%20SnakeSegment(tailSegment.position.x,%20tailSegment.position.y,%20this.color,%20SegmentType.body);%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.segments.splice(this.segments.length%20-%201,%200,%20newSegment);%0D%0A%0D%0A%20%20%20%20%20%20%20%20tailSegment.setPosition(this.prevTailPos.x,%20this.prevTailPos.y);%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20setDirection(direction)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(this.pendingTurn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20this.pendingTurn%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20To%20prevent%20180%20degree%20turns%0D%0A%20%20%20%20%20%20%20%20switch%20(direction)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20Direction.up:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.direction%20===%20Direction.down)%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20Direction.down:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.direction%20===%20Direction.up)%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20Direction.left:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.direction%20===%20Direction.right)%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20Direction.right:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.direction%20===%20Direction.left)%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.direction%20=%20direction;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20get%20head()%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20this.segments%5B0%5D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20get%20tail()%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20this.segments%5Bthis.segments.length%20-%201%5D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20getSegment(i)%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20this.segments%5Bi%5D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%7D%0D%0A%0D%0Aclass%20SnakeSegment%20%7B%0D%0A%0D%0A%20%20%20%20constructor(x,%20y,%20color,%20type)%20%7B%0D%0A%20%20%20%20%20%20%20%20this.x%20=%20x;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%20y;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.color%20=%20color;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20SegmentType%0D%0A%20%20%20%20%20%20%20%20this.type%20=%20type;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20setPosition(x,%20y)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.x%20=%20x;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%20y;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20get%20position()%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20x:%20this.x,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20y:%20this.y%0D%0A%20%20%20%20%20%20%20%20%7D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%7D%0D%0A%0D%0Aclass%20Apple%20%7B%0D%0A%0D%0A%20%20%20%20constructor()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.x%20=%200;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%200;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.initPosition();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20initPosition()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20collision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20do%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20this.x%20=%20Math.floor(Math.random()%20*%20tileCount);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20this.y%20=%20Math.floor(Math.random()%20*%20tileCount);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20collision%20=%20obstacles.some(obstacle%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20obstacle.isCollision(this.x,%20this.y);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D%20while%20(collision);%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20draw(ctx)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Draw%20apple%0D%0A%20%20%20%20%20%20%20%20if%20(this.gold)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'gold';%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'red';%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20ctx.arc(this.x%20*%20gridSize%20+%200.5%20*%20(gridSize%20-%202),%20this.y%20*%20gridSize%20+%200.5%20*%20(gridSize%20-%202),%200.4%20*%20(gridSize%20-%202),%200,%202%20*%20Math.PI);%0D%0A%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Draw%20stem%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'brown';%0D%0A%20%20%20%20%20%20%20%20ctx.fillRect(this.x%20*%20gridSize%20+%207,%20this.y%20*%20gridSize,%204,%200.5%20*%20(gridSize%20-%202));%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Draw%20leaf%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'green';%0D%0A%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20ctx.moveTo(this.x%20*%20gridSize%20+%209,%20this.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20ctx.lineTo(this.x%20*%20gridSize%20+%209,%20this.y%20*%20gridSize%20+%204);%0D%0A%20%20%20%20%20%20%20%20ctx.lineTo(this.x%20*%20gridSize%20+%2018,%20this.y%20*%20gridSize%20+%202);%0D%0A%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20get%20position()%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20x:%20this.x,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20y:%20this.y%0D%0A%20%20%20%20%20%20%20%20%7D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%7D##JS_E####CODE_14E####LOGIC_14####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass().if(code.js.editable%5B3%5D.includes('borrow%20gather')).is.true;##JS_E####LOGIC_14E####STEP_14E####STEP_15####INST_15##Removing%20the%20score%0A%0AGetting%20a%20high%20score%20was%20the%20goal%20of%20the%20game%20for%20single%20player%20mode.%0A%0ABut%20it's%20different%20for%20two-player%20mode,%20where%20the%20goal%20is%20to%20last%20longer%20than%20the%20opponent.%0A%0A(***)%0A%0A(!)On%20+js#selectMode()%20%7B#+3%20&%20js#selectMode()%20%7B#+6,%20hide%20the%20*scoreLabel*%20element%20for%20two-player%20mode.%0A(*)*TIP:*%20remember%20to%20set%20the%20visibility%20back%20to%20*visible*%20for%20single%20player%20mode.##INST_15E####CODE_15####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%20/%3E%0D%0A%20%20%20%20%3Clink%20href=%22https://fonts.googleapis.com/css?family=Nunito:200,400,700%22%20rel=%22stylesheet%22%3E%0D%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/head%3E%0D%0A%0D%0A%3Cbody%3E%0D%0A%0D%0A%20%20%20%20%3Ch1%3ESnake%20Game%3C/h1%3E%0D%0A%0D%0A%20%20%20%20%3Cdiv%20id=%22points-wrapper%22%3E%0D%0A%20%20%20%20%20%20%20%20%3Cp%20id=%22pointsLabel%22%3EPoints:%200%3C/p%3E%0D%0A%20%20%20%20%3C/div%3E%0D%0A%0D%0A%20%20%20%20%3Ccanvas%20id=%22gc%22%20width=%22400%22%20height=%22400%22%3E%3C/canvas%3E%0D%0A%0D%0A%20%20%20%20%3Cdiv%20id=%22button-wrapper%22%3E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%3Cbutton%20id='playButton'%3EPlay%3C/button%3E%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%3Cp%20id=%22playerLabel%22%3ETwo%20player:%3C/p%3E%0D%0A%20%20%20%20%20%20%20%20%3Clabel%20id=%22playerSwitch%22%20class=%22switch%22%3E%0D%0A%09%09%09%3Cinput%20id=%22playerCheckbox%22%20type=%22checkbox%22%3E%0D%0A%09%09%09%3Cspan%20id=%22slider%22%20class=%22slider%20round%22%3E%3C/span%3E%0D%0A%09%09%3C/label%3E%0D%0A%09%09%0D%0A%0D%0A%20%20%20%20%3C/div%3E%0D%0A%0D%0A%20%20%20%20%0D%0A%3C/body%3E%0D%0A%0D%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS##*%20%7B%0D%0A%20%20%20%20font-family:%20%22Nunito%22;%0D%0A%20%20%09text-align:%20center;%0D%0A%7D%0D%0A%0D%0Ah1%20%7B%0D%0A%20%20%20%20font-size:%2035px;%0D%0A%20%20%20%20font-weight:%20200;%0D%0A%7D%0D%0A%0D%0Ap%20%7B%0D%0A%20%20%20%20font-size:%2015;%0D%0A%20%20%20%20font-weight:%20700;%0D%0A%7D%0D%0A%0D%0Acanvas%20%7B%0D%0A%20%20%20%20padding-left:%200;%0D%0A%20%20%20%20padding-right:%200;%0D%0A%20%20%20%20margin-left:%20auto;%0D%0A%20%20%20%20margin-right:%20auto;%0D%0A%20%20%20%20display:%20block;%0D%0A%20%20%20%20width:%20400px;%0D%0A%7D%0D%0A%0D%0Abutton%20%7B%0D%0A%20%20%20%20font-size:%2014px;%0D%0A%20%20%20%20margin:%205px;%0D%0A%7D%0D%0A%0D%0A#points%20%7B%0D%0A%20%20%20%20text-align:%20right;%0D%0A%7D%0D%0A%0D%0A#points-wrapper%20%7B%0D%0A%20%20%20%20width:%20400px;%0D%0A%20%20%20%20margin:%20auto;%0D%0A%7D%0D%0A%0D%0A#button-wrapper%20%7B%0D%0A%20%20%20%20display:%20flex;%0D%0A%20%20%20%20align-items:%20center;%0D%0A%20%20%20%20justify-content:%20center;%0D%0A%7D%0D%0A%0D%0A#select-difficulty%20%7B%0D%0A%20%20%20%20margin-bottom:%200;%0D%0A%7D%0D%0A%0D%0A#playerLabel%20%7B%0D%0A%20%20%20%20margin-left:%205px;%0D%0A%20%20%20%20margin-right:%205px;%0D%0A%20%20%20%20font-weight:%20100;%0D%0A%7D%0D%0A%0D%0A%0D%0A/*%20The%20switch%20-%20the%20box%20around%20the%20slider%20*/%0D%0A%0D%0A.switch%20%7B%0D%0A%20%20%20%20position:%20relative;%0D%0A%20%20%20%20display:%20inline-block;%0D%0A%20%20%20%20width:%2050px;%0D%0A%20%20%20%20height:%2030px;%0D%0A%20%20%20%20margin-left:%205px;%0D%0A%7D%0D%0A%0D%0A%0D%0A/*%20Hide%20default%20HTML%20checkbox%20*/%0D%0A%0D%0A.switch%20input%20%7B%0D%0A%20%20%20%20display:%20none;%0D%0A%7D%0D%0A%0D%0A%0D%0A/*%20The%20slider%20*/%0D%0A%0D%0A.slider%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20cursor:%20pointer;%0D%0A%20%20%20%20top:%200;%0D%0A%20%20%20%20left:%200;%0D%0A%20%20%20%20right:%200;%0D%0A%20%20%20%20bottom:%200;%0D%0A%20%20%20%20background-color:%20#ccc;%0D%0A%20%20%20%20-webkit-transition:%20.4s;%0D%0A%20%20%20%20transition:%20.4s;%0D%0A%7D%0D%0A%0D%0A.slider:before%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20content:%20%22%22;%0D%0A%20%20%20%20height:%2022px;%0D%0A%20%20%20%20width:%2022px;%0D%0A%20%20%20%20left:%204px;%0D%0A%20%20%20%20bottom:%204px;%0D%0A%20%20%20%20background-color:%20white;%0D%0A%20%20%20%20-webkit-transition:%20.4s;%0D%0A%20%20%20%20transition:%20.4s;%0D%0A%7D%0D%0A%0D%0Ainput:checked+.slider%20%7B%0D%0A%20%20%20%20background-color:%20#2196F3;%0D%0A%7D%0D%0A%0D%0Ainput:focus+.slider%20%7B%0D%0A%20%20%20%20box-shadow:%200%200%201px%20#2196F3;%0D%0A%7D%0D%0A%0D%0Ainput:checked+.slider:before%20%7B%0D%0A%20%20%20%20-webkit-transform:%20translateX(22px);%0D%0A%20%20%20%20-ms-transform:%20translateX(20px);%0D%0A%20%20%20%20transform:%20translateX(20px);%0D%0A%7D%0D%0A%0D%0A%0D%0A/*%20Rounded%20sliders%20*/%0D%0A%0D%0A.slider.round%20%7B%0D%0A%20%20%20%20border-radius:%2020px;%0D%0A%7D%0D%0A%0D%0A.slider.round:before%20%7B%0D%0A%20%20%20%20border-radius:%2050%25;%0D%0A%7D#BEGIN_EDITABLE##END_EDITABLE###CSS_E####JS##//%20Segment%20types%20of%20the%20snake%0D%0Avar%20SegmentType%20=%20Object.freeze(%7B%20'head':%201,%20'body':%202,%20'tail':%203%20%7D);%0D%0A//%20Directions%20the%20snake%20can%20travel%0D%0Avar%20Direction%20=%20Object.freeze(%7B%20'up':%20%7B%20'x':%200,%20'y':%20-1%20%7D,%20'down':%20%7B%20'x':%200,%20'y':%201%20%7D,%20'right':%20%7B%20'x':%201,%20'y':%200%20%7D,%20'left':%20%7B%20'x':%20-1,%20'y':%200%20%7D%20%7D);%0D%0A%0D%0A//%20Array%20of%20the%20snakes%20playing%20the%20game%0D%0Avar%20snakes%20=%20%5B%5D;%0D%0A%0D%0A//%20Array%20of%20obstacles%20for%20the%20current%20game%20mode%0D%0Alet%20obstacles%20=%20%5B%5D;%0D%0A%0D%0A//%20The%20current%20apple%20on%20the%20screen%0D%0Avar%20apple;%0D%0A%0D%0A//%20How%20big%20each%20grid%20is%20(px)%0D%0Avar%20gridSize%20=%2020;%0D%0A//%20How%20many%20grids%20are%20in%20the%20canvas%0D%0Avar%20tileCount%20=%2020;%0D%0A//%20How%20many%20times%20the%20scene%20is%20redrawn,%20per%20second%0D%0Avar%20refreshRate%20=%208;%0D%0A%0D%0A//%20Boolean%20indicating%20whether%20two-player%20mode%20is%20on%20or%20off%0D%0Avar%20isTwoPlayer%20=%20false;%0D%0A//%20Boolean%20indicating%20whether%20the%20game%20is%20currently%20in%20progress%0D%0Avar%20gameHasStarted%20=%20false;%0D%0A%0D%0A//%20Variables%20to%20temporarily%20store%20players'%20names%0D%0Avar%20player1Name;%0D%0Avar%20player2Name;%0D%0A%0D%0A%0D%0A//%20Define%20the%20function%20to%20be%20called%20when%20the%20window%20loads%0D%0Awindow.onload%20=%20function%20()%20%7B%0D%0A%0D%0A%20%20%20%20//%20Set%20up%20the%20graphics%0D%0A%20%20%09gc.width%20=%20tileCount%20*%20gridSize;%0D%0A%20%20%09gc.height%20=%20tileCount%20*%20gridSize;%0D%0A%20%20%20%20ctx%20=%20gc.getContext('2d');%0D%0A%09%0D%0A%09playerCheckbox.onchange%20=%20function%20()%20%7B%0D%0A%20%20%20%20%20%20%20%20isTwoPlayer%20=%20playerCheckbox.checked;%0D%0A%20%20%20%20%7D;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20Draw%20the%20opening%20screen%0D%0A%20%20%20%20drawStartingScreen();%0D%0A%0D%0A%20%20%09//%20Add%20listener%20for%20key%20presses%0D%0A%20%20%20%20document.addEventListener('keydown',%20keyPush);%0D%0A%20%20%09playButton.addEventListener('click',%20selectMode);%0D%0A%0D%0A%7D;%0D%0A%0D%0A%0D%0Afunction%20selectMode()%20%7B%0D%0A%0D%0A%20%20%20%20if%20(isTwoPlayer)%20%7B%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#pointsLabel.style.visibility%20=%20'hidden';#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20askForPlayerNames();%0D%0A%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#pointsLabel.style.visibility%20=%20'visible';#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20startGame();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20setButtonsVisibility('hidden');%0D%0A%0D%0A%7D%0D%0A%0D%0A%0D%0Afunction%20askForPlayerNames()%20%7B%0D%0A%0D%0A%20%20%20%20showNamePopup('Player%201%20(left%20snake),%20what%20is%20your%20name?',%20function%20()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20showNamePopup('Player%202%20(right%20snake),%20what%20is%20your%20name?',%20function%20()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20startGame();%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%7D);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20showNamePopup(text,%20handler)%20%7B%0D%0A%0D%0A%20%20%20%20const%20popupBackground%20=%20document.createElement('div');%0D%0A%0D%0A%20%20%20%20popupBackground.style.position%20=%20'absolute';%0D%0A%20%20%20%20popupBackground.style.width%20=%20%60$%7Bwindow.innerWidth%7Dpx%60;%0D%0A%20%20%20%20popupBackground.style.height%20=%20%60$%7Bwindow.innerHeight%7Dpx%60;%0D%0A%20%20%20%20popupBackground.style.left%20=%20'0px';%0D%0A%20%20%20%20popupBackground.style.top%20=%20'0px';%0D%0A%0D%0A%20%20%20%20popupBackground.style.backgroundColor%20=%20'white';%0D%0A%20%20%20%20popupBackground.style.opacity%20=%20'0.7';%0D%0A%0D%0A%20%20%20%20document.body.appendChild(popupBackground);%0D%0A%0D%0A%20%20%20%20const%20banner%20=%20document.createElement('div');%0D%0A%0D%0A%20%20%20%20banner.style.position%20=%20'absolute';%0D%0A%20%20%20%20banner.style.width%20=%20%60$%7Bwindow.innerWidth%7Dpx%60;%0D%0A%20%20%20%20banner.style.height%20=%20'200px';%0D%0A%0D%0A%20%20%20%20document.body.appendChild(banner);%0D%0A%0D%0A%20%20%20%20banner.style.left%20=%20'0px';%0D%0A%20%20%20%20banner.style.top%20=%20%60$%7Bwindow.innerHeight%20/%202%20-%20banner.offsetHeight%20/%202%7Dpx%60;%0D%0A%0D%0A%20%20%20%20banner.style.backgroundColor%20=%20'black';%0D%0A%20%20%20%20banner.style.opacity%20=%20'1.0';%0D%0A%0D%0A%20%20%20%20const%20prompt%20=%20document.createElement('h3');%0D%0A%0D%0A%20%20%20%20prompt.style.position%20=%20'absolute';%0D%0A%20%20%20%20prompt.style.width%20=%20%60$%7Bbanner.offsetWidth%7Dpx%60;%0D%0A%20%20%20%20prompt.style.height%20=%20'30px';%0D%0A%0D%0A%20%20%20%20banner.appendChild(prompt);%0D%0A%0D%0A%20%20%20%20prompt.style.top%20=%20%60$%7Bbanner.offsetHeight%20/%204%7Dpx%60;%0D%0A%20%20%20%20prompt.style.left%20=%20'0px';%0D%0A%0D%0A%20%20%20%20prompt.style.margin%20=%20'0%200%200%200';%0D%0A%20%20%20%20prompt.style.fontSize%20=%20'25px';%0D%0A%20%20%20%20prompt.style.color%20=%20'white';%0D%0A%20%20%20%20prompt.style.fontFamily%20=%20'Nunito';%0D%0A%20%20%20%20prompt.textContent%20=%20text;%0D%0A%0D%0A%20%20%20%20var%20input%20=%20document.createElement('input');%0D%0A%0D%0A%20%20%20%20input.type%20=%20'text';%0D%0A%20%20%20%20input.style.position%20=%20'absolute';%0D%0A%20%20%20%20input.style.width%20=%20'200px';%0D%0A%20%20%20%20input.style.textAlign%20=%20'center';%0D%0A%0D%0A%20%20%20%20banner.appendChild(input);%0D%0A%0D%0A%20%20%20%20input.style.left%20=%20%60$%7Bbanner.offsetWidth%20/%202%20-%20input.offsetWidth%20/%202%7Dpx%60;%0D%0A%20%20%20%20input.style.top%20=%20%60$%7Bprompt.offsetTop%20+%20prompt.offsetHeight%20+%2025%7Dpx%60;%0D%0A%0D%0A%20%20%20%20const%20okayButton%20=%20document.createElement('button');%0D%0A%0D%0A%20%20%20%20okayButton.textContent%20=%20'Okay';%0D%0A%20%20%20%20okayButton.style.position%20=%20'absolute';%0D%0A%20%20%20%20okayButton.style.textAlign%20=%20'center';%0D%0A%20%20%20%20okayButton.style.borderRadius%20=%20'5px';%0D%0A%0D%0A%20%20%20%20banner.appendChild(okayButton);%0D%0A%0D%0A%20%20%20%20okayButton.style.left%20=%20%60$%7Bbanner.offsetWidth%20/%202%20-%20okayButton.offsetWidth%20/%202%7Dpx%60;%0D%0A%20%20%20%20okayButton.style.top%20=%20%60$%7Binput.offsetTop%20+%20input.offsetHeight%20+%2010%7Dpx%60;%0D%0A%0D%0A%20%20%20%20okayButton.onclick%20=%20()%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20validate%20user%20input%0D%0A%20%20%20%20%20%20%20%20if%20(!input.value.trim().length)%20return;%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(player1Name%20==%20null)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20player1Name%20=%20input.value;%0D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20player2Name%20=%20input.value;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20document.body.removeChild(popupBackground);%0D%0A%20%20%20%20%20%20%20%20document.body.removeChild(banner);%0D%0A%0D%0A%20%20%20%20%20%20%20%20handler();%0D%0A%0D%0A%20%20%20%20%7D;%0D%0A%0D%0A%7D%0D%0A%0D%0A//%20Function:%20hide/show%20difficulty%20buttons%20and%20label%20%0D%0Afunction%20setButtonsVisibility(visibility)%20%7B%0D%0A%0D%0A%20%20%20%20playButton.style.visibility%20=%20visibility;%0D%0A%20%20%20%20playerLabel.style.visibility%20=%20visibility;%0D%0A%20%20%20%20playerSwitch.style.visibility%20=%20visibility;%0D%0A%20%20%20%20playerCheckbox.style.visibility%20=%20visibility;%0D%0A%20%20%20%20slider.style.visibility%20=%20visibility;%0D%0A%0D%0A%7D%0D%0A%0D%0A//%20Function:%20starting%20the%20game%20(canvas%20starts%20to%20refresh)%0D%0Afunction%20startGame()%20%7B%0D%0A%0D%0A%20%20%20%20gameHasStarted%20=%20true;%0D%0A%0D%0A%20%20%20%20//%20Create%20how%20many%20snakes%20you%20want%0D%0A%20%20%20%20createSnakes();%0D%0A%0D%0A%20%20%20%20//%20Randomize%20the%20location%20of%20the%20starting%20apple%0D%0A%20%20%20%20spawnNewApple();%0D%0A%0D%0A%20%20%20%20//%20Start%20the%20graphics,%20at%20a%2015%20refreshes%20per%20second%20rate%0D%0A%20%20%20%20window.refresher%20=%20setInterval(refreshGame,%201000%20/%20refreshRate);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20createSnakes()%20%7B%0D%0A%0D%0A%20%20%20%20snakes%20=%20%5B%5D;%0D%0A%0D%0A%20%20%20%20const%20snake1%20=%20new%20Snake(1,%209,%20'green',%20player1Name);%0D%0A%20%20%20%20snake1.control%20=%20%7B%20up:%20'KeyW',%20down:%20'KeyS',%20left:%20'KeyA',%20right:%20'KeyD'%20%7D;%0D%0A%20%20%20%20snakes.push(snake1);%0D%0A%20%20%20%20%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(isTwoPlayer)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20snake2%20=%20new%20Snake(18,%209,%20'blue',%20player2Name);%0D%0A%20%20%20%20%20%20%20%20snake2.control%20=%20%7B%20up:%20'ArrowUp',%20down:%20'ArrowDown',%20left:%20'ArrowLeft',%20right:%20'ArrowRight'%20%7D;%0D%0A%20%20%20%20%20%20%20%20snakes.push(snake2);%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%0D%0A%7D%0D%0A%0D%0A//%20Function:%20called%20multiple%20times%20a%20second%20to%20refresh%20the%20canvas%0D%0Afunction%20refreshGame()%20%7B%0D%0A%0D%0A%20%20%20%20clearCanvas();%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20apple%0D%0A%20%20%20%20apple.draw(ctx);%0D%0A%0D%0A%20%20%20%20refreshSnakes();%0D%0A%0D%0A%20%20%20%20//%20Check%20if%20snakes%20have%20run%20into%20each%20other%0D%0A%20%20%20%20checkForSnakeCollision();%0D%0A%0D%0A%20%20%20%20updatePointsLabel();%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20refreshSnakes()%20%7B%0D%0A%0D%0A%20%20%20%20//%20If%20any%20snake%20draw%20fails,%20stop%20all%20drawing%0D%0A%20%20%20%20snakes.every(snake%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(snake.draw(ctx))%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20snake.checkForApple();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20true;%0D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20checkForSnakeCollision()%20%7B%0D%0A%0D%0A%20%20%20%20var%20losingSnakes%20=%20%5B%5D;%0D%0A%20%20%20%20snakes.forEach(snake%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(snake.checkForSnakeCollision())%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20losingSnakes.push(snake);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20if%20(losingSnakes.length)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerLoses(losingSnakes);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%7D%0D%0A%0D%0A//%20Function:%20resetting%20the%20game%20(if%20the%20player%20dies)%0D%0Afunction%20resetGame()%20%7B%0D%0A%0D%0A%20%20%20%20player1Name%20=%20null;%0D%0A%20%20%20%20player2Name%20=%20null;%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20starting%20snake%20screen%0D%0A%20%20%20%20drawStartingScreen();%0D%0A%0D%0A%20%20%20%20//%20Make%20the%20buttons%20visible%20again%0D%0A%20%20%20%20setButtonsVisibility('visible');%0D%0A%20%20%20%20%0D%0A%20%20%20%20updatePointsLabel();%0D%0A%7D%0D%0A%0D%0A//%20Function:%20handles%20the%20playing-losing%20event%0D%0Afunction%20playerLoses(losingSnakes)%20%7B%0D%0A%0D%0A%20%20%20%20gameHasStarted%20=%20false;%0D%0A%0D%0A%20%20%20%20//%20Stop%20the%20canvas%20from%20refreshing%0D%0A%20%20%20%20clearInterval(window.refresher);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20screen%20showing%20the%20%22L%22%20snake%0D%0A%20%20%20%20drawLosingScreen();%0D%0A%0D%0A%20%20%20%20//%20Wait%203%20seconds,%20and%20then%20reset%20the%20game%0D%0A%20%20%20%20setTimeout(resetGame,%203000);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20spawnNewApple()%20%7B%0D%0A%20%20%20%20apple%20=%20new%20Apple();%0D%0A%7D%0D%0A%0D%0Afunction%20clearCanvas()%20%7B%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(0,%200,%20gc.width,%20gc.height);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20updatePointsLabel()%20%7B%0D%0A%20%20%20%20pointsLabel.innerHTML%20=%20gameHasStarted%20?%20'Points:%20'%20+%20String(snakes%5B0%5D.points)%20:%20'Points:%200';%0D%0A%7D%0D%0A%0D%0Afunction%20keyPush(evt)%20%7B%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(!gameHasStarted)%20%7B%0D%0A%20%20%20%20%20%20%20%20return;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20evt.preventDefault();%0D%0A%0D%0A%20%20%20%20snakes.forEach(snake%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(evt.code%20===%20snake.control.up)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20snake.setDirection(Direction.up);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20if%20(evt.code%20===%20snake.control.down)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20snake.setDirection(Direction.down);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20if%20(evt.code%20===%20snake.control.left)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20snake.setDirection(Direction.left);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20if%20(evt.code%20===%20snake.control.right)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20snake.setDirection(Direction.right);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20drawLosingScreen()%20%7B%0D%0A%0D%0A%20%20%20%20clearCanvas();%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(0,%200,%20gc.width,%20gc.height);%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'green';%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize,%203%20*%20gridSize,%208%20*%20gridSize,%2014%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(8%20*%20gridSize,%203%20*%20gridSize,%206%20*%20gridSize,%2012%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20triangle%20tail%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(13%20*%20gridSize,%2015%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize,%2016%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize,%2015%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(13%20*%20gridSize,%2017%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize,%2016%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize,%2017%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20eyes%0D%0A%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%203%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%20%20%20%20ctx.fillRect(7%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%203%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20tongue%0D%0A%20%20%20%20ctx.fillStyle%20=%20'pink';%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize%20+%205%20/%206%20*%20gridSize,%202.5%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%202%20*%20gridSize);%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(7%20*%20gridSize,%202.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(7%20*%20gridSize,%202%20*%20gridSize%20+%203%20/%208%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6.5%20*%20gridSize,%202%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize%20+%205%20/%206%20*%20gridSize,%202.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(7%20*%20gridSize,%202.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(7%20*%20gridSize,%202%20*%20gridSize%20+%203%20/%208%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(7.5%20*%20gridSize,%202%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(7%20*%20gridSize%20+%201%20/%206%20*%20gridSize,%202.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20drawStartingScreen()%20%7B%0D%0A%0D%0A%20%20%20%20clearCanvas();%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(0,%200,%20gc.width,%20gc.height);%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'green';%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize,%203%20*%20gridSize,%208%20*%20gridSize,%2014%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(8%20*%20gridSize,%205%20*%20gridSize,%206%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize,%2011%20*%20gridSize,%206%20*%20gridSize,%204%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20triangle%20tail%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(7%20*%20gridSize,%2015%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize,%2016%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize,%2015%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(7%20*%20gridSize,%2017%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize,%2016%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize,%2017%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20eyes%0D%0A%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20ctx.fillRect(13%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%203%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%20%20%20%20ctx.fillRect(13%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%204%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20tongue%0D%0A%20%20%20%20ctx.fillStyle%20=%20'pink';%0D%0A%20%20%20%20ctx.fillRect(14%20*%20gridSize,%203%20*%20gridSize%20+%205%20/%206%20*%20gridSize,%201%20/%202%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(14.5%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize%20+%205%20/%208%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(15%20*%20gridSize,%203.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14.5%20*%20gridSize,%203%20*%20gridSize%20+%205%20/%206%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(14.5%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize%20+%205%20/%208%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(15%20*%20gridSize,%204.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14.5%20*%20gridSize,%204%20*%20gridSize%20+%201%20/%206%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%7D%0D%0A%0D%0Aclass%20Snake%20%7B%0D%0A%0D%0A%20%20%20%20constructor(x,%20y,%20color,%20name%20=%20'Snakey')%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20An%20array%20of%20SnakeSegments%0D%0A%20%20%20%20%20%20%20%20this.segments%20=%20%5B%5D;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.color%20=%20color;%0D%0A%20%20%20%20%20%20%20%20this.altColor%20=%20color;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.name%20=%20name;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.direction%20=%20Direction.up;%0D%0A%20%20%20%20%20%20%20%20this.pendingTurn%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Coordinates%20of%20the%20head%20of%20the%20snake%0D%0A%20%20%20%20%20%20%20%20this.x%20=%20x;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%20y;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.prevTailPos%20=%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20x:%200,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20y:%200%0D%0A%20%20%20%20%20%20%20%20%7D;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.points%20=%200;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.generateSnake();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20generateSnake()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Create%20the%20initial%20snake%0D%0A%20%20%20%20%20%20%20%20const%20startSize%20=%205;%0D%0A%20%20%20%20%20%20%20%20for%20(var%20i%20=%200;%20i%20%3C%20startSize;%20i++)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20segment;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!i)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20segment%20=%20new%20SnakeSegment(this.x,%20this.y,%20this.color,%20SegmentType.head);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20(i%20===%20startSize%20-%201)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20segment%20=%20new%20SnakeSegment(this.x,%20this.y,%20this.color,%20SegmentType.tail);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20segment%20=%20new%20SnakeSegment(this.x,%20this.y,%20this.color,%20SegmentType.body);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20this.segments.push(segment);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20drawSnakeTail()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20tail%20=%20this.tail;%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20preTail%20=%20this.getSegment(this.segments.length%20-%202);%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Get%20the%20direction%20that%20the%20tail%20is%20moving%20in%0D%0A%20%20%20%20%20%20%20%20var%20tailXVelocity%20=%20preTail.position.x%20-%20tail.position.x;%0D%0A%20%20%20%20%20%20%20%20var%20tailYVelocity%20=%20preTail.position.y%20-%20tail.position.y;%0D%0A%0D%0A%20%20%20%20%20%20%20%20switch%20(tailXVelocity)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%201:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.moveTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize%20+%209);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20-1:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.moveTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize%20+%209);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%200:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20switch%20(tailYVelocity)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%201:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.moveTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%209,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20-1:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.moveTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%209,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20drawSnakeEyes()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20head%20=%20this.head;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Giving%20the%20snake%20eyes%20based%20off%20of%20its%20direction%0D%0A%20%20%20%20%20%20%20%20switch%20(this.direction.x)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%201:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%2012,%20head.position.y%20*%20gridSize%20+%203,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%2012,%20head.position.y%20*%20gridSize%20+%2011,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20-1:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%202,%20head.position.y%20*%20gridSize%20+%203,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%202,%20head.position.y%20*%20gridSize%20+%2011,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%200:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20switch%20(this.direction.y)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%201:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%203,%20head.position.y%20*%20gridSize%20+%2012,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%2011,%20head.position.y%20*%20gridSize%20+%2012,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20-1:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%203,%20head.position.y%20*%20gridSize%20+%202,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%2011,%20head.position.y%20*%20gridSize%20+%202,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20this.color;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20Called%20to%20draw%20the%20entire%20snake%0D%0A%20%20%20%20draw(ctx)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20this.color;%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20success%20=%20this.updatePositions();%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(!success)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20for%20(var%20i%20=%200;%20i%20%3C%20this.segments.length;%20i++)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20If%20drawing%20the%20tail%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(i%20==%20this.segments.length%20-%201)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.drawSnakeTail();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(this.segments%5Bi%5D.x%20*%20gridSize,%20this.segments%5Bi%5D.y%20*%20gridSize,%20gridSize%20-%202,%20gridSize%20-%202);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20If%20drawing%20the%20head%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!i)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.drawSnakeEyes();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20return%20true;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20updatePositions()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.pendingTurn%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Expressions%20account%20for%20vertical%20and%20horizontal%20wrapping%0D%0A%20%20%20%20%20%20%20%20const%20newX%20=%20this.x%20+%20this.direction.x%20%3E%20tileCount%20-%201%20?%200%20:%20(this.x%20+%20this.direction.x%20%3C%200%20?%20tileCount%20-%201%20:%20this.x%20+%20this.direction.x);%0D%0A%20%20%20%20%20%20%20%20const%20newY%20=%20this.y%20+%20this.direction.y%20%3E%20tileCount%20-%201%20?%200%20:%20(this.y%20+%20this.direction.y%20%3C%200%20?%20tileCount%20-%201%20:%20this.y%20+%20this.direction.y);%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.x%20=%20newX;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%20newY;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Check%20if%20the%20snake%20ran%20into%20an%20obstacle%0D%0A%20%20%20%20%20%20%20%20const%20collision%20=%20obstacles.some(obstacle%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20obstacle.isCollision(this.x,%20this.y);%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(collision)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20playerLoses(%5Bthis%5D);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Go%20through%20the%20segments%20from%20the%20tail%20to%20the%20head,%20assigning%20each%20segment's%20x%20and%20y%20equal%20to%20the%20next%20segment's%20position%0D%0A%20%20%20%20%20%20%20%20for%20(var%20i%20=%20this.segments.length%20-%201;%20i%20%3E=%200;%20i--)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!i)%20%7B%20//%20For%20the%20head%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.segments%5Bi%5D.setPosition(this.x,%20this.y);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(i%20===%20this.segments.length%20-%201)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.prevTailPos%20=%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x:%20this.segments%5Bi%5D.x,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y:%20this.segments%5Bi%5D.y%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20nextX%20=%20this.segments%5Bi%20-%201%5D.x;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20nextY%20=%20this.segments%5Bi%20-%201%5D.y;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(nextX%20===%20this.x%20&&%20nextY%20===%20this.y)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerLoses(this);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.segments%5Bi%5D.setPosition(nextX,%20nextY);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20return%20true;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20checkForApple()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(this.x%20===%20apple.position.x%20&&%20this.y%20===%20apple.position.y)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%09this.points++;%0D%0A%20%20%20%20%20%20%20%20%20%20%09this.addSegment();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20spawnNewApple();%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20Checks%20if%20this%20snake%20has%20run%20into%20any%20other%20snake%0D%0A%20%20%20%20checkForSnakeCollision()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20return%20snakes.some(snake%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(snake%20!==%20this)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20snake.segments.some(segment%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(segment.position.x%20===%20this.x%20&&%20segment.position.y%20===%20this.y)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20addSegment()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20tailSegment%20=%20this.segments%5Bthis.segments.length%20-%201%5D;%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20newSegment%20=%20new%20SnakeSegment(tailSegment.position.x,%20tailSegment.position.y,%20this.color,%20SegmentType.body);%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.segments.splice(this.segments.length%20-%201,%200,%20newSegment);%0D%0A%0D%0A%20%20%20%20%20%20%20%20tailSegment.setPosition(this.prevTailPos.x,%20this.prevTailPos.y);%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20setDirection(direction)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(this.pendingTurn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20this.pendingTurn%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20To%20prevent%20180%20degree%20turns%0D%0A%20%20%20%20%20%20%20%20switch%20(direction)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20Direction.up:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.direction%20===%20Direction.down)%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20Direction.down:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.direction%20===%20Direction.up)%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20Direction.left:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.direction%20===%20Direction.right)%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20Direction.right:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.direction%20===%20Direction.left)%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.direction%20=%20direction;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20get%20head()%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20this.segments%5B0%5D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20get%20tail()%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20this.segments%5Bthis.segments.length%20-%201%5D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20getSegment(i)%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20this.segments%5Bi%5D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%7D%0D%0A%0D%0Aclass%20SnakeSegment%20%7B%0D%0A%0D%0A%20%20%20%20constructor(x,%20y,%20color,%20type)%20%7B%0D%0A%20%20%20%20%20%20%20%20this.x%20=%20x;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%20y;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.color%20=%20color;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20SegmentType%0D%0A%20%20%20%20%20%20%20%20this.type%20=%20type;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20setPosition(x,%20y)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.x%20=%20x;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%20y;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20get%20position()%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20x:%20this.x,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20y:%20this.y%0D%0A%20%20%20%20%20%20%20%20%7D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%7D%0D%0A%0D%0Aclass%20Apple%20%7B%0D%0A%0D%0A%20%20%20%20constructor()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.x%20=%200;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%200;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.initPosition();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20initPosition()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20collision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20do%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20this.x%20=%20Math.floor(Math.random()%20*%20tileCount);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20this.y%20=%20Math.floor(Math.random()%20*%20tileCount);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20collision%20=%20obstacles.some(obstacle%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20obstacle.isCollision(this.x,%20this.y);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D%20while%20(collision);%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20draw(ctx)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Draw%20apple%0D%0A%20%20%20%20%20%20%20%20if%20(this.gold)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'gold';%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'red';%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20ctx.arc(this.x%20*%20gridSize%20+%200.5%20*%20(gridSize%20-%202),%20this.y%20*%20gridSize%20+%200.5%20*%20(gridSize%20-%202),%200.4%20*%20(gridSize%20-%202),%200,%202%20*%20Math.PI);%0D%0A%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Draw%20stem%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'brown';%0D%0A%20%20%20%20%20%20%20%20ctx.fillRect(this.x%20*%20gridSize%20+%207,%20this.y%20*%20gridSize,%204,%200.5%20*%20(gridSize%20-%202));%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Draw%20leaf%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'green';%0D%0A%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20ctx.moveTo(this.x%20*%20gridSize%20+%209,%20this.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20ctx.lineTo(this.x%20*%20gridSize%20+%209,%20this.y%20*%20gridSize%20+%204);%0D%0A%20%20%20%20%20%20%20%20ctx.lineTo(this.x%20*%20gridSize%20+%2018,%20this.y%20*%20gridSize%20+%202);%0D%0A%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20get%20position()%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20x:%20this.x,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20y:%20this.y%0D%0A%20%20%20%20%20%20%20%20%7D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%7D##JS_E####CODE_15E####LOGIC_15####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60pointsLabel.style.visibility%20=%20'hidden';%60);%0Apass.if.js.editable(1).equivalent(%60pointsLabel.style.visibility%20=%20'visible';%60);##JS_E####LOGIC_15E####STEP_15E####STEP_16####INST_16##Obstacles%0A%0AFollow%20in-class%20instructions%20to%20learn%20how%20to%20work%20with%20the%20*Obstacle*%20class,%20complete%20the%20following%20and%20get%20approval%20from%20your%20instructor.%0A%0A(***)%0A%0A(!)1.%20On%20+js#createSnakes();#+3,%20call%20the%20*createObstacles*%20function.%0A(!)2.%20On%20+js#refreshGame()%20%7B#-4,%20create%20the%20*createObstacles*%20function.##INST_16E####CODE_16####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%20/%3E%0D%0A%20%20%20%20%3Clink%20href=%22https://fonts.googleapis.com/css?family=Nunito:200,400,700%22%20rel=%22stylesheet%22%3E%0D%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/head%3E%0D%0A%0D%0A%3Cbody%3E%0D%0A%0D%0A%20%20%20%20%3Ch1%3ESnake%20Game%3C/h1%3E%0D%0A%0D%0A%20%20%20%20%3Cdiv%20id=%22points-wrapper%22%3E%0D%0A%20%20%20%20%20%20%20%20%3Cp%20id=%22pointsLabel%22%3EPoints:%200%3C/p%3E%0D%0A%20%20%20%20%3C/div%3E%0D%0A%0D%0A%20%20%20%20%3Ccanvas%20id=%22gc%22%20width=%22400%22%20height=%22400%22%3E%3C/canvas%3E%0D%0A%0D%0A%20%20%20%20%3Cdiv%20id=%22button-wrapper%22%3E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%3Cbutton%20id='playButton'%3EPlay%3C/button%3E%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%3Cp%20id=%22playerLabel%22%3ETwo%20player:%3C/p%3E%0D%0A%20%20%20%20%20%20%20%20%3Clabel%20id=%22playerSwitch%22%20class=%22switch%22%3E%0D%0A%09%09%09%3Cinput%20id=%22playerCheckbox%22%20type=%22checkbox%22%3E%0D%0A%09%09%09%3Cspan%20id=%22slider%22%20class=%22slider%20round%22%3E%3C/span%3E%0D%0A%09%09%3C/label%3E%0D%0A%09%09%0D%0A%0D%0A%20%20%20%20%3C/div%3E%0D%0A%0D%0A%20%20%20%20%0D%0A%3C/body%3E%0D%0A%0D%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS##*%20%7B%0D%0A%20%20%20%20font-family:%20%22Nunito%22;%0D%0A%20%20%09text-align:%20center;%0D%0A%7D%0D%0A%0D%0Ah1%20%7B%0D%0A%20%20%20%20font-size:%2035px;%0D%0A%20%20%20%20font-weight:%20200;%0D%0A%7D%0D%0A%0D%0Ap%20%7B%0D%0A%20%20%20%20font-size:%2015;%0D%0A%20%20%20%20font-weight:%20700;%0D%0A%7D%0D%0A%0D%0Acanvas%20%7B%0D%0A%20%20%20%20padding-left:%200;%0D%0A%20%20%20%20padding-right:%200;%0D%0A%20%20%20%20margin-left:%20auto;%0D%0A%20%20%20%20margin-right:%20auto;%0D%0A%20%20%20%20display:%20block;%0D%0A%20%20%20%20width:%20400px;%0D%0A%7D%0D%0A%0D%0Abutton%20%7B%0D%0A%20%20%20%20font-size:%2014px;%0D%0A%20%20%20%20margin:%205px;%0D%0A%7D%0D%0A%0D%0A#points%20%7B%0D%0A%20%20%20%20text-align:%20right;%0D%0A%7D%0D%0A%0D%0A#points-wrapper%20%7B%0D%0A%20%20%20%20width:%20400px;%0D%0A%20%20%20%20margin:%20auto;%0D%0A%7D%0D%0A%0D%0A#button-wrapper%20%7B%0D%0A%20%20%20%20display:%20flex;%0D%0A%20%20%20%20align-items:%20center;%0D%0A%20%20%20%20justify-content:%20center;%0D%0A%7D%0D%0A%0D%0A#select-difficulty%20%7B%0D%0A%20%20%20%20margin-bottom:%200;%0D%0A%7D%0D%0A%0D%0A#playerLabel%20%7B%0D%0A%20%20%20%20margin-left:%205px;%0D%0A%20%20%20%20margin-right:%205px;%0D%0A%20%20%20%20font-weight:%20100;%0D%0A%7D%0D%0A%0D%0A%0D%0A/*%20The%20switch%20-%20the%20box%20around%20the%20slider%20*/%0D%0A%0D%0A.switch%20%7B%0D%0A%20%20%20%20position:%20relative;%0D%0A%20%20%20%20display:%20inline-block;%0D%0A%20%20%20%20width:%2050px;%0D%0A%20%20%20%20height:%2030px;%0D%0A%20%20%20%20margin-left:%205px;%0D%0A%7D%0D%0A%0D%0A%0D%0A/*%20Hide%20default%20HTML%20checkbox%20*/%0D%0A%0D%0A.switch%20input%20%7B%0D%0A%20%20%20%20display:%20none;%0D%0A%7D%0D%0A%0D%0A%0D%0A/*%20The%20slider%20*/%0D%0A%0D%0A.slider%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20cursor:%20pointer;%0D%0A%20%20%20%20top:%200;%0D%0A%20%20%20%20left:%200;%0D%0A%20%20%20%20right:%200;%0D%0A%20%20%20%20bottom:%200;%0D%0A%20%20%20%20background-color:%20#ccc;%0D%0A%20%20%20%20-webkit-transition:%20.4s;%0D%0A%20%20%20%20transition:%20.4s;%0D%0A%7D%0D%0A%0D%0A.slider:before%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20content:%20%22%22;%0D%0A%20%20%20%20height:%2022px;%0D%0A%20%20%20%20width:%2022px;%0D%0A%20%20%20%20left:%204px;%0D%0A%20%20%20%20bottom:%204px;%0D%0A%20%20%20%20background-color:%20white;%0D%0A%20%20%20%20-webkit-transition:%20.4s;%0D%0A%20%20%20%20transition:%20.4s;%0D%0A%7D%0D%0A%0D%0Ainput:checked+.slider%20%7B%0D%0A%20%20%20%20background-color:%20#2196F3;%0D%0A%7D%0D%0A%0D%0Ainput:focus+.slider%20%7B%0D%0A%20%20%20%20box-shadow:%200%200%201px%20#2196F3;%0D%0A%7D%0D%0A%0D%0Ainput:checked+.slider:before%20%7B%0D%0A%20%20%20%20-webkit-transform:%20translateX(22px);%0D%0A%20%20%20%20-ms-transform:%20translateX(20px);%0D%0A%20%20%20%20transform:%20translateX(20px);%0D%0A%7D%0D%0A%0D%0A%0D%0A/*%20Rounded%20sliders%20*/%0D%0A%0D%0A.slider.round%20%7B%0D%0A%20%20%20%20border-radius:%2020px;%0D%0A%7D%0D%0A%0D%0A.slider.round:before%20%7B%0D%0A%20%20%20%20border-radius:%2050%25;%0D%0A%7D#BEGIN_EDITABLE##END_EDITABLE###CSS_E####JS##//%20Segment%20types%20of%20the%20snake%0D%0Avar%20SegmentType%20=%20Object.freeze(%7B%20'head':%201,%20'body':%202,%20'tail':%203%20%7D);%0D%0A//%20Directions%20the%20snake%20can%20travel%0D%0Avar%20Direction%20=%20Object.freeze(%7B%20'up':%20%7B%20'x':%200,%20'y':%20-1%20%7D,%20'down':%20%7B%20'x':%200,%20'y':%201%20%7D,%20'right':%20%7B%20'x':%201,%20'y':%200%20%7D,%20'left':%20%7B%20'x':%20-1,%20'y':%200%20%7D%20%7D);%0D%0A%0D%0A//%20Array%20of%20the%20snakes%20playing%20the%20game%0D%0Avar%20snakes%20=%20%5B%5D;%0D%0A%0D%0A//%20Array%20of%20obstacles%20for%20the%20current%20game%20mode%0D%0Alet%20obstacles%20=%20%5B%5D;%0D%0A%0D%0A//%20The%20current%20apple%20on%20the%20screen%0D%0Avar%20apple;%0D%0A%0D%0A//%20How%20big%20each%20grid%20is%20(px)%0D%0Avar%20gridSize%20=%2020;%0D%0A//%20How%20many%20grids%20are%20in%20the%20canvas%0D%0Avar%20tileCount%20=%2020;%0D%0A//%20How%20many%20times%20the%20scene%20is%20redrawn,%20per%20second%0D%0Avar%20refreshRate%20=%208;%0D%0A%0D%0A//%20Boolean%20indicating%20whether%20two-player%20mode%20is%20on%20or%20off%0D%0Avar%20isTwoPlayer%20=%20false;%0D%0A//%20Boolean%20indicating%20whether%20the%20game%20is%20currently%20in%20progress%0D%0Avar%20gameHasStarted%20=%20false;%0D%0A%0D%0A//%20Variables%20to%20temporarily%20store%20players'%20names%0D%0Avar%20player1Name;%0D%0Avar%20player2Name;%0D%0A%0D%0A%0D%0A//%20Define%20the%20function%20to%20be%20called%20when%20the%20window%20loads%0D%0Awindow.onload%20=%20function%20()%20%7B%0D%0A%0D%0A%20%20%20%20//%20Set%20up%20the%20graphics%0D%0A%20%20%09gc.width%20=%20tileCount%20*%20gridSize;%0D%0A%20%20%09gc.height%20=%20tileCount%20*%20gridSize;%0D%0A%20%20%20%20ctx%20=%20gc.getContext('2d');%0D%0A%09%0D%0A%09playerCheckbox.onchange%20=%20function%20()%20%7B%0D%0A%20%20%20%20%20%20%20%20isTwoPlayer%20=%20playerCheckbox.checked;%0D%0A%20%20%20%20%7D;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20Draw%20the%20opening%20screen%0D%0A%20%20%20%20drawStartingScreen();%0D%0A%0D%0A%20%20%09//%20Add%20listener%20for%20key%20presses%0D%0A%20%20%20%20document.addEventListener('keydown',%20keyPush);%0D%0A%20%20%09playButton.addEventListener('click',%20selectMode);%0D%0A%0D%0A%7D;%0D%0A%0D%0A%0D%0Afunction%20selectMode()%20%7B%0D%0A%0D%0A%20%20%20%20if%20(isTwoPlayer)%20%7B%0D%0A%20%20%20%20%20%20%20%20pointsLabel.style.visibility%20=%20'hidden';%0D%0A%20%20%20%20%20%20%20%20askForPlayerNames();%0D%0A%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20pointsLabel.style.visibility%20=%20'visible';%0D%0A%20%20%20%20%20%20%20%20startGame();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20setButtonsVisibility('hidden');%0D%0A%0D%0A%7D%0D%0A%0D%0A%0D%0Afunction%20askForPlayerNames()%20%7B%0D%0A%0D%0A%20%20%20%20showNamePopup('Player%201%20(left%20snake),%20what%20is%20your%20name?',%20function%20()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20showNamePopup('Player%202%20(right%20snake),%20what%20is%20your%20name?',%20function%20()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20startGame();%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%7D);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20showNamePopup(text,%20handler)%20%7B%0D%0A%0D%0A%20%20%20%20const%20popupBackground%20=%20document.createElement('div');%0D%0A%0D%0A%20%20%20%20popupBackground.style.position%20=%20'absolute';%0D%0A%20%20%20%20popupBackground.style.width%20=%20%60$%7Bwindow.innerWidth%7Dpx%60;%0D%0A%20%20%20%20popupBackground.style.height%20=%20%60$%7Bwindow.innerHeight%7Dpx%60;%0D%0A%20%20%20%20popupBackground.style.left%20=%20'0px';%0D%0A%20%20%20%20popupBackground.style.top%20=%20'0px';%0D%0A%0D%0A%20%20%20%20popupBackground.style.backgroundColor%20=%20'white';%0D%0A%20%20%20%20popupBackground.style.opacity%20=%20'0.7';%0D%0A%0D%0A%20%20%20%20document.body.appendChild(popupBackground);%0D%0A%0D%0A%20%20%20%20const%20banner%20=%20document.createElement('div');%0D%0A%0D%0A%20%20%20%20banner.style.position%20=%20'absolute';%0D%0A%20%20%20%20banner.style.width%20=%20%60$%7Bwindow.innerWidth%7Dpx%60;%0D%0A%20%20%20%20banner.style.height%20=%20'200px';%0D%0A%0D%0A%20%20%20%20document.body.appendChild(banner);%0D%0A%0D%0A%20%20%20%20banner.style.left%20=%20'0px';%0D%0A%20%20%20%20banner.style.top%20=%20%60$%7Bwindow.innerHeight%20/%202%20-%20banner.offsetHeight%20/%202%7Dpx%60;%0D%0A%0D%0A%20%20%20%20banner.style.backgroundColor%20=%20'black';%0D%0A%20%20%20%20banner.style.opacity%20=%20'1.0';%0D%0A%0D%0A%20%20%20%20const%20prompt%20=%20document.createElement('h3');%0D%0A%0D%0A%20%20%20%20prompt.style.position%20=%20'absolute';%0D%0A%20%20%20%20prompt.style.width%20=%20%60$%7Bbanner.offsetWidth%7Dpx%60;%0D%0A%20%20%20%20prompt.style.height%20=%20'30px';%0D%0A%0D%0A%20%20%20%20banner.appendChild(prompt);%0D%0A%0D%0A%20%20%20%20prompt.style.top%20=%20%60$%7Bbanner.offsetHeight%20/%204%7Dpx%60;%0D%0A%20%20%20%20prompt.style.left%20=%20'0px';%0D%0A%0D%0A%20%20%20%20prompt.style.margin%20=%20'0%200%200%200';%0D%0A%20%20%20%20prompt.style.fontSize%20=%20'25px';%0D%0A%20%20%20%20prompt.style.color%20=%20'white';%0D%0A%20%20%20%20prompt.style.fontFamily%20=%20'Nunito';%0D%0A%20%20%20%20prompt.textContent%20=%20text;%0D%0A%0D%0A%20%20%20%20var%20input%20=%20document.createElement('input');%0D%0A%0D%0A%20%20%20%20input.type%20=%20'text';%0D%0A%20%20%20%20input.style.position%20=%20'absolute';%0D%0A%20%20%20%20input.style.width%20=%20'200px';%0D%0A%20%20%20%20input.style.textAlign%20=%20'center';%0D%0A%0D%0A%20%20%20%20banner.appendChild(input);%0D%0A%0D%0A%20%20%20%20input.style.left%20=%20%60$%7Bbanner.offsetWidth%20/%202%20-%20input.offsetWidth%20/%202%7Dpx%60;%0D%0A%20%20%20%20input.style.top%20=%20%60$%7Bprompt.offsetTop%20+%20prompt.offsetHeight%20+%2025%7Dpx%60;%0D%0A%0D%0A%20%20%20%20const%20okayButton%20=%20document.createElement('button');%0D%0A%0D%0A%20%20%20%20okayButton.textContent%20=%20'Okay';%0D%0A%20%20%20%20okayButton.style.position%20=%20'absolute';%0D%0A%20%20%20%20okayButton.style.textAlign%20=%20'center';%0D%0A%20%20%20%20okayButton.style.borderRadius%20=%20'5px';%0D%0A%0D%0A%20%20%20%20banner.appendChild(okayButton);%0D%0A%0D%0A%20%20%20%20okayButton.style.left%20=%20%60$%7Bbanner.offsetWidth%20/%202%20-%20okayButton.offsetWidth%20/%202%7Dpx%60;%0D%0A%20%20%20%20okayButton.style.top%20=%20%60$%7Binput.offsetTop%20+%20input.offsetHeight%20+%2010%7Dpx%60;%0D%0A%0D%0A%20%20%20%20okayButton.onclick%20=%20()%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20validate%20user%20input%0D%0A%20%20%20%20%20%20%20%20if%20(!input.value.trim().length)%20return;%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(player1Name%20==%20null)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20player1Name%20=%20input.value;%0D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20player2Name%20=%20input.value;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20document.body.removeChild(popupBackground);%0D%0A%20%20%20%20%20%20%20%20document.body.removeChild(banner);%0D%0A%0D%0A%20%20%20%20%20%20%20%20handler();%0D%0A%0D%0A%20%20%20%20%7D;%0D%0A%0D%0A%7D%0D%0A%0D%0A//%20Function:%20hide/show%20difficulty%20buttons%20and%20label%20%0D%0Afunction%20setButtonsVisibility(visibility)%20%7B%0D%0A%0D%0A%20%20%20%20playButton.style.visibility%20=%20visibility;%0D%0A%20%20%20%20playerLabel.style.visibility%20=%20visibility;%0D%0A%20%20%20%20playerSwitch.style.visibility%20=%20visibility;%0D%0A%20%20%20%20playerCheckbox.style.visibility%20=%20visibility;%0D%0A%20%20%20%20slider.style.visibility%20=%20visibility;%0D%0A%0D%0A%7D%0D%0A%0D%0A//%20Function:%20starting%20the%20game%20(canvas%20starts%20to%20refresh)%0D%0Afunction%20startGame()%20%7B%0D%0A%0D%0A%20%20%20%20gameHasStarted%20=%20true;%0D%0A%0D%0A%20%20%20%20//%20Create%20how%20many%20snakes%20you%20want%0D%0A%20%20%20%20createSnakes();%0D%0A%0D%0A%20%20%20%20//%20Create%20the%20obstacles%20on%20the%20map%0D%0A%20%20%20%20#BEGIN_EDITABLE#createObstacles();#END_EDITABLE#%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20Randomize%20the%20location%20of%20the%20starting%20apple%0D%0A%20%20%20%20spawnNewApple();%0D%0A%0D%0A%20%20%20%20//%20Start%20the%20graphics,%20at%20a%2015%20refreshes%20per%20second%20rate%0D%0A%20%20%20%20window.refresher%20=%20setInterval(refreshGame,%201000%20/%20refreshRate);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20createSnakes()%20%7B%0D%0A%0D%0A%20%20%20%20snakes%20=%20%5B%5D;%0D%0A%0D%0A%20%20%20%20const%20snake1%20=%20new%20Snake(1,%209,%20'green',%20player1Name);%0D%0A%20%20%20%20snake1.control%20=%20%7B%20up:%20'KeyW',%20down:%20'KeyS',%20left:%20'KeyA',%20right:%20'KeyD'%20%7D;%0D%0A%20%20%20%20snakes.push(snake1);%0D%0A%20%20%20%20%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(isTwoPlayer)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20snake2%20=%20new%20Snake(18,%209,%20'blue',%20player2Name);%0D%0A%20%20%20%20%20%20%20%20snake2.control%20=%20%7B%20up:%20'ArrowUp',%20down:%20'ArrowDown',%20left:%20'ArrowLeft',%20right:%20'ArrowRight'%20%7D;%0D%0A%20%20%20%20%20%20%20%20snakes.push(snake2);%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%0D%0A%7D%0D%0A%0D%0A#BEGIN_EDITABLE#%0D%0Afunction%20createObstacles()%20%7B%0D%0A%0D%0A%20%20%20%20obstacles%20=%20%5B%5D;%0D%0A%0D%0A%20%20%20%20const%20obstacle1%20=%20new%20Obstacle(3,%209,%205,%202);%0D%0A%20%20%20%20const%20obstacle2%20=%20new%20Obstacle(12,%209,%205,%202);%0D%0A%20%20%20%20%0D%0A%20%20%20%20obstacles.push(obstacle1);%0D%0A%20%20%20%20obstacles.push(obstacle2);%0D%0A%0D%0A%7D%0D%0A#END_EDITABLE#%0D%0A%0D%0A//%20Function:%20called%20multiple%20times%20a%20second%20to%20refresh%20the%20canvas%0D%0Afunction%20refreshGame()%20%7B%0D%0A%0D%0A%20%20%20%20clearCanvas();%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20apple%0D%0A%20%20%20%20apple.draw(ctx);%0D%0A%0D%0A%20%20%20%20refreshSnakes();%0D%0A%0D%0A%20%20%20%20//%20Check%20if%20snakes%20have%20run%20into%20each%20other%0D%0A%20%20%20%20checkForSnakeCollision();%0D%0A%0D%0A%20%20%20%20updatePointsLabel();%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20refreshSnakes()%20%7B%0D%0A%0D%0A%20%20%20%20//%20If%20any%20snake%20draw%20fails,%20stop%20all%20drawing%0D%0A%20%20%20%20snakes.every(snake%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(snake.draw(ctx))%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20snake.checkForApple();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20true;%0D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20checkForSnakeCollision()%20%7B%0D%0A%0D%0A%20%20%20%20var%20losingSnakes%20=%20%5B%5D;%0D%0A%20%20%20%20snakes.forEach(snake%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(snake.checkForSnakeCollision())%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20losingSnakes.push(snake);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20if%20(losingSnakes.length)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerLoses(losingSnakes);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%7D%0D%0A%0D%0A//%20Function:%20resetting%20the%20game%20(if%20the%20player%20dies)%0D%0Afunction%20resetGame()%20%7B%0D%0A%0D%0A%20%20%20%20player1Name%20=%20null;%0D%0A%20%20%20%20player2Name%20=%20null;%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20starting%20snake%20screen%0D%0A%20%20%20%20drawStartingScreen();%0D%0A%0D%0A%20%20%20%20//%20Make%20the%20buttons%20visible%20again%0D%0A%20%20%20%20setButtonsVisibility('visible');%0D%0A%20%20%20%20%0D%0A%20%20%20%20updatePointsLabel();%0D%0A%7D%0D%0A%0D%0A//%20Function:%20handles%20the%20playing-losing%20event%0D%0Afunction%20playerLoses(losingSnakes)%20%7B%0D%0A%0D%0A%20%20%20%20gameHasStarted%20=%20false;%0D%0A%0D%0A%20%20%20%20//%20Stop%20the%20canvas%20from%20refreshing%0D%0A%20%20%20%20clearInterval(window.refresher);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20screen%20showing%20the%20%22L%22%20snake%0D%0A%20%20%20%20drawLosingScreen();%0D%0A%0D%0A%20%20%20%20//%20Wait%203%20seconds,%20and%20then%20reset%20the%20game%0D%0A%20%20%20%20setTimeout(resetGame,%203000);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20spawnNewApple()%20%7B%0D%0A%20%20%20%20apple%20=%20new%20Apple();%0D%0A%7D%0D%0A%0D%0Afunction%20clearCanvas()%20%7B%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(0,%200,%20gc.width,%20gc.height);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20updatePointsLabel()%20%7B%0D%0A%20%20%20%20pointsLabel.innerHTML%20=%20gameHasStarted%20?%20'Points:%20'%20+%20String(snakes%5B0%5D.points)%20:%20'Points:%200';%0D%0A%7D%0D%0A%0D%0Afunction%20keyPush(evt)%20%7B%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(!gameHasStarted)%20%7B%0D%0A%20%20%20%20%20%20%20%20return;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20evt.preventDefault();%0D%0A%0D%0A%20%20%20%20snakes.forEach(snake%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(evt.code%20===%20snake.control.up)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20snake.setDirection(Direction.up);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20if%20(evt.code%20===%20snake.control.down)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20snake.setDirection(Direction.down);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20if%20(evt.code%20===%20snake.control.left)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20snake.setDirection(Direction.left);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20if%20(evt.code%20===%20snake.control.right)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20snake.setDirection(Direction.right);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20drawLosingScreen()%20%7B%0D%0A%0D%0A%20%20%20%20clearCanvas();%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(0,%200,%20gc.width,%20gc.height);%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'green';%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize,%203%20*%20gridSize,%208%20*%20gridSize,%2014%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(8%20*%20gridSize,%203%20*%20gridSize,%206%20*%20gridSize,%2012%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20triangle%20tail%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(13%20*%20gridSize,%2015%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize,%2016%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize,%2015%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(13%20*%20gridSize,%2017%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize,%2016%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize,%2017%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20eyes%0D%0A%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%203%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%20%20%20%20ctx.fillRect(7%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%203%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20tongue%0D%0A%20%20%20%20ctx.fillStyle%20=%20'pink';%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize%20+%205%20/%206%20*%20gridSize,%202.5%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%202%20*%20gridSize);%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(7%20*%20gridSize,%202.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(7%20*%20gridSize,%202%20*%20gridSize%20+%203%20/%208%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6.5%20*%20gridSize,%202%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize%20+%205%20/%206%20*%20gridSize,%202.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(7%20*%20gridSize,%202.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(7%20*%20gridSize,%202%20*%20gridSize%20+%203%20/%208%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(7.5%20*%20gridSize,%202%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(7%20*%20gridSize%20+%201%20/%206%20*%20gridSize,%202.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%7D%0D%0A%0D%0Afunction%20drawStartingScreen()%20%7B%0D%0A%0D%0A%20%20%20%20clearCanvas();%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(0,%200,%20gc.width,%20gc.height);%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'green';%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize,%203%20*%20gridSize,%208%20*%20gridSize,%2014%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20ctx.fillStyle%20=%20'black';%0D%0A%20%20%20%20ctx.fillRect(8%20*%20gridSize,%205%20*%20gridSize,%206%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.fillRect(6%20*%20gridSize,%2011%20*%20gridSize,%206%20*%20gridSize,%204%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20triangle%20tail%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(7%20*%20gridSize,%2015%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize,%2016%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize,%2015%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(7%20*%20gridSize,%2017%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize,%2016%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(6%20*%20gridSize,%2017%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20eyes%0D%0A%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20ctx.fillRect(13%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%203%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%20%20%20%20ctx.fillRect(13%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%204%20*%20gridSize%20+%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%0D%0A%20%20%20%20//%20Draw%20the%20tongue%0D%0A%20%20%20%20ctx.fillStyle%20=%20'pink';%0D%0A%20%20%20%20ctx.fillRect(14%20*%20gridSize,%203%20*%20gridSize%20+%205%20/%206%20*%20gridSize,%201%20/%202%20*%20gridSize,%201%20/%203%20*%20gridSize);%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(14.5%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize%20+%205%20/%208%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(15%20*%20gridSize,%203.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14.5%20*%20gridSize,%203%20*%20gridSize%20+%205%20/%206%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20ctx.moveTo(14.5%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14%20*%20gridSize%20+%205%20/%208%20*%20gridSize,%204%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(15%20*%20gridSize,%204.5%20*%20gridSize);%0D%0A%20%20%20%20ctx.lineTo(14.5%20*%20gridSize,%204%20*%20gridSize%20+%201%20/%206%20*%20gridSize);%0D%0A%20%20%20%20ctx.fill();%0D%0A%0D%0A%7D%0D%0A%0D%0Aclass%20Snake%20%7B%0D%0A%0D%0A%20%20%20%20constructor(x,%20y,%20color,%20name%20=%20'Snakey')%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20An%20array%20of%20SnakeSegments%0D%0A%20%20%20%20%20%20%20%20this.segments%20=%20%5B%5D;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.color%20=%20color;%0D%0A%20%20%20%20%20%20%20%20this.altColor%20=%20color;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.name%20=%20name;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.direction%20=%20Direction.up;%0D%0A%20%20%20%20%20%20%20%20this.pendingTurn%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Coordinates%20of%20the%20head%20of%20the%20snake%0D%0A%20%20%20%20%20%20%20%20this.x%20=%20x;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%20y;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.prevTailPos%20=%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20x:%200,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20y:%200%0D%0A%20%20%20%20%20%20%20%20%7D;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.points%20=%200;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.generateSnake();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20generateSnake()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Create%20the%20initial%20snake%0D%0A%20%20%20%20%20%20%20%20const%20startSize%20=%205;%0D%0A%20%20%20%20%20%20%20%20for%20(var%20i%20=%200;%20i%20%3C%20startSize;%20i++)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20segment;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!i)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20segment%20=%20new%20SnakeSegment(this.x,%20this.y,%20this.color,%20SegmentType.head);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20(i%20===%20startSize%20-%201)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20segment%20=%20new%20SnakeSegment(this.x,%20this.y,%20this.color,%20SegmentType.tail);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20segment%20=%20new%20SnakeSegment(this.x,%20this.y,%20this.color,%20SegmentType.body);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20this.segments.push(segment);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20drawSnakeTail()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20tail%20=%20this.tail;%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20preTail%20=%20this.getSegment(this.segments.length%20-%202);%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Get%20the%20direction%20that%20the%20tail%20is%20moving%20in%0D%0A%20%20%20%20%20%20%20%20var%20tailXVelocity%20=%20preTail.position.x%20-%20tail.position.x;%0D%0A%20%20%20%20%20%20%20%20var%20tailYVelocity%20=%20preTail.position.y%20-%20tail.position.y;%0D%0A%0D%0A%20%20%20%20%20%20%20%20switch%20(tailXVelocity)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%201:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.moveTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize%20+%209);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20-1:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.moveTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize%20+%209);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%200:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20switch%20(tailYVelocity)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%201:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.moveTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%209,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20-1:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.moveTo(tail.position.x%20*%20gridSize,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%2018,%20tail.position.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.lineTo(tail.position.x%20*%20gridSize%20+%209,%20tail.position.y%20*%20gridSize%20+%2018);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20drawSnakeEyes()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20head%20=%20this.head;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Giving%20the%20snake%20eyes%20based%20off%20of%20its%20direction%0D%0A%20%20%20%20%20%20%20%20switch%20(this.direction.x)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%201:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%2012,%20head.position.y%20*%20gridSize%20+%203,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%2012,%20head.position.y%20*%20gridSize%20+%2011,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20-1:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%202,%20head.position.y%20*%20gridSize%20+%203,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%202,%20head.position.y%20*%20gridSize%20+%2011,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%200:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20switch%20(this.direction.y)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%201:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%203,%20head.position.y%20*%20gridSize%20+%2012,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%2011,%20head.position.y%20*%20gridSize%20+%2012,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20-1:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'white';%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%203,%20head.position.y%20*%20gridSize%20+%202,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(head.position.x%20*%20gridSize%20+%2011,%20head.position.y%20*%20gridSize%20+%202,%204,%204);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20this.color;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20Called%20to%20draw%20the%20entire%20snake%0D%0A%20%20%20%20draw(ctx)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20this.color;%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20success%20=%20this.updatePositions();%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(!success)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20for%20(var%20i%20=%200;%20i%20%3C%20this.segments.length;%20i++)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20If%20drawing%20the%20tail%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(i%20==%20this.segments.length%20-%201)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.drawSnakeTail();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(this.segments%5Bi%5D.x%20*%20gridSize,%20this.segments%5Bi%5D.y%20*%20gridSize,%20gridSize%20-%202,%20gridSize%20-%202);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20If%20drawing%20the%20head%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!i)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.drawSnakeEyes();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20return%20true;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20updatePositions()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.pendingTurn%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Expressions%20account%20for%20vertical%20and%20horizontal%20wrapping%0D%0A%20%20%20%20%20%20%20%20const%20newX%20=%20this.x%20+%20this.direction.x%20%3E%20tileCount%20-%201%20?%200%20:%20(this.x%20+%20this.direction.x%20%3C%200%20?%20tileCount%20-%201%20:%20this.x%20+%20this.direction.x);%0D%0A%20%20%20%20%20%20%20%20const%20newY%20=%20this.y%20+%20this.direction.y%20%3E%20tileCount%20-%201%20?%200%20:%20(this.y%20+%20this.direction.y%20%3C%200%20?%20tileCount%20-%201%20:%20this.y%20+%20this.direction.y);%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.x%20=%20newX;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%20newY;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Check%20if%20the%20snake%20ran%20into%20an%20obstacle%0D%0A%20%20%20%20%20%20%20%20const%20collision%20=%20obstacles.some(obstacle%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20obstacle.isCollision(this.x,%20this.y);%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(collision)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20playerLoses(%5Bthis%5D);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Go%20through%20the%20segments%20from%20the%20tail%20to%20the%20head,%20assigning%20each%20segment's%20x%20and%20y%20equal%20to%20the%20next%20segment's%20position%0D%0A%20%20%20%20%20%20%20%20for%20(var%20i%20=%20this.segments.length%20-%201;%20i%20%3E=%200;%20i--)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!i)%20%7B%20//%20For%20the%20head%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.segments%5Bi%5D.setPosition(this.x,%20this.y);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(i%20===%20this.segments.length%20-%201)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.prevTailPos%20=%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x:%20this.segments%5Bi%5D.x,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y:%20this.segments%5Bi%5D.y%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20nextX%20=%20this.segments%5Bi%20-%201%5D.x;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20nextY%20=%20this.segments%5Bi%20-%201%5D.y;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(nextX%20===%20this.x%20&&%20nextY%20===%20this.y)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerLoses(this);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.segments%5Bi%5D.setPosition(nextX,%20nextY);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20return%20true;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20checkForApple()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(this.x%20===%20apple.position.x%20&&%20this.y%20===%20apple.position.y)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%09this.points++;%0D%0A%20%20%20%20%20%20%20%20%20%20%09this.addSegment();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20spawnNewApple();%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20Checks%20if%20this%20snake%20has%20run%20into%20any%20other%20snake%0D%0A%20%20%20%20checkForSnakeCollision()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20return%20snakes.some(snake%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(snake%20!==%20this)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20snake.segments.some(segment%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(segment.position.x%20===%20this.x%20&&%20segment.position.y%20===%20this.y)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20addSegment()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20tailSegment%20=%20this.segments%5Bthis.segments.length%20-%201%5D;%0D%0A%0D%0A%20%20%20%20%20%20%20%20const%20newSegment%20=%20new%20SnakeSegment(tailSegment.position.x,%20tailSegment.position.y,%20this.color,%20SegmentType.body);%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.segments.splice(this.segments.length%20-%201,%200,%20newSegment);%0D%0A%0D%0A%20%20%20%20%20%20%20%20tailSegment.setPosition(this.prevTailPos.x,%20this.prevTailPos.y);%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20setDirection(direction)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(this.pendingTurn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20this.pendingTurn%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20To%20prevent%20180%20degree%20turns%0D%0A%20%20%20%20%20%20%20%20switch%20(direction)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20Direction.up:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.direction%20===%20Direction.down)%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20Direction.down:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.direction%20===%20Direction.up)%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20Direction.left:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.direction%20===%20Direction.right)%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20Direction.right:%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.direction%20===%20Direction.left)%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.direction%20=%20direction;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20get%20head()%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20this.segments%5B0%5D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20get%20tail()%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20this.segments%5Bthis.segments.length%20-%201%5D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20getSegment(i)%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20this.segments%5Bi%5D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%7D%0D%0A%0D%0Aclass%20SnakeSegment%20%7B%0D%0A%0D%0A%20%20%20%20constructor(x,%20y,%20color,%20type)%20%7B%0D%0A%20%20%20%20%20%20%20%20this.x%20=%20x;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%20y;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.color%20=%20color;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20SegmentType%0D%0A%20%20%20%20%20%20%20%20this.type%20=%20type;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20setPosition(x,%20y)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.x%20=%20x;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%20y;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20get%20position()%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20x:%20this.x,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20y:%20this.y%0D%0A%20%20%20%20%20%20%20%20%7D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%7D%0D%0A%0D%0Aclass%20Obstacle%20%7B%0D%0A%0D%0A%20%20%20%20constructor(x,%20y,%20width,%20height)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.x%20=%20x;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%20y;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.width%20=%20width;%0D%0A%20%20%20%20%20%20%20%20this.height%20=%20height;%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20draw(ctx)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'#8B4513';%0D%0A%20%20%20%20%20%20%20%20for%20(var%20i%20=%200;%20i%20%3C%20this.width;%20i++)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(var%20j%20=%200;%20j%20%3C%20this.height;%20j++)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillRect(this.x%20*%20gridSize%20+%20i%20*%20gridSize,%20this.y%20*%20gridSize%20+%20j%20*%20gridSize,%20gridSize%20-%202,%20gridSize%20-%202);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20isCollision(x,%20y)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(x%20%3E=%20this.x%20&&%20x%20%3C%20this.x%20+%20this.width%20&&%20y%20%3E=%20this.y%20&&%20y%20%3C%20this.y%20+%20this.height)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20true;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%7D%0D%0A%0D%0Aclass%20Apple%20%7B%0D%0A%0D%0A%20%20%20%20constructor()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.x%20=%200;%0D%0A%20%20%20%20%20%20%20%20this.y%20=%200;%0D%0A%0D%0A%20%20%20%20%20%20%20%20this.initPosition();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20initPosition()%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20collision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20do%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20this.x%20=%20Math.floor(Math.random()%20*%20tileCount);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20this.y%20=%20Math.floor(Math.random()%20*%20tileCount);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20collision%20=%20obstacles.some(obstacle%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20obstacle.isCollision(this.x,%20this.y);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%7D%20while%20(collision);%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20draw(ctx)%20%7B%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Draw%20apple%0D%0A%20%20%20%20%20%20%20%20if%20(this.gold)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'gold';%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'red';%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20ctx.arc(this.x%20*%20gridSize%20+%200.5%20*%20(gridSize%20-%202),%20this.y%20*%20gridSize%20+%200.5%20*%20(gridSize%20-%202),%200.4%20*%20(gridSize%20-%202),%200,%202%20*%20Math.PI);%0D%0A%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Draw%20stem%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'brown';%0D%0A%20%20%20%20%20%20%20%20ctx.fillRect(this.x%20*%20gridSize%20+%207,%20this.y%20*%20gridSize,%204,%200.5%20*%20(gridSize%20-%202));%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Draw%20leaf%0D%0A%20%20%20%20%20%20%20%20ctx.fillStyle%20=%20'green';%0D%0A%20%20%20%20%20%20%20%20ctx.beginPath();%0D%0A%20%20%20%20%20%20%20%20ctx.moveTo(this.x%20*%20gridSize%20+%209,%20this.y%20*%20gridSize);%0D%0A%20%20%20%20%20%20%20%20ctx.lineTo(this.x%20*%20gridSize%20+%209,%20this.y%20*%20gridSize%20+%204);%0D%0A%20%20%20%20%20%20%20%20ctx.lineTo(this.x%20*%20gridSize%20+%2018,%20this.y%20*%20gridSize%20+%202);%0D%0A%20%20%20%20%20%20%20%20ctx.fill();%0D%0A%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20get%20position()%20%7B%0D%0A%20%20%20%20%20%20%20%20return%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20x:%20this.x,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20y:%20this.y%0D%0A%20%20%20%20%20%20%20%20%7D;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%7D##JS_E####CODE_16E####LOGIC_16####HTML####HTML_E####CSS####CSS_E####JS####JS_E####LOGIC_16E####STEP_16E##