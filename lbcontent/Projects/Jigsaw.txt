1##STEP_1####INST_1####INST_1E####CODE_1####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%3Chead%3E%0D%0A%09%3Clink%20rel=%22stylesheet%22%20type=%22text/css%22%20href=%22style.css%22/%3E%0D%0A%09%3Cscript%20type=%22text/javascript%22%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/head%3E%0D%0A%3Cbody%3E%0D%0A%20%20%20%20%3Ch1%3EJigsaw%3C/h1%3E%0D%0A%20%20%20%20%3C!--%20puzzle%20goes%20here%20--%3E%0D%0A%09%3Cdiv%20id=%22puzzleContainer%22%3E%3C/div%3E%0D%0A%09%3C!--%20input%20box%20for%20custom%20image%20link%20--%3E%0D%0A%09%3Cinput%20id=%22imageLink%22%20placeholder=%22generate%20a%20puzzle%20using%20your%20own%20image%20link%22%20/%3E%0D%0A%09%3C!--%20button%20to%20reset%20the%20puzzle%20--%3E%0D%0A%09%3Cbutton%20id=%22newPuzzle%22%3ELoading%20image...%3C/button%3E%0D%0A%09%3C!--%20area%20to%20store%20spare%20puzzle%20pieces%20%20--%3E%0D%0A%09%3Cdiv%20id=%22spare%22%3E%3C/div%3E%0D%0A%3C/body%3E%0D%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0D%0A%09margin:%200;%0D%0A%20%20%20%20font-family:%20arial;%0D%0A%20%20%20%20text-align:%20center;%0D%0A%20%20%20%20overflow:%20hidden;%0D%0A%7D%0D%0A%0D%0A#puzzleContainer%20%7B%0D%0A%20%20%20%20position:%20relative;%0D%0A%20%20%20%20margin:%20auto;%0D%0A%20%20%20%20border:%202px%20solid%20black;%0D%0A%20%20%20%20border-radius:%205px;%0D%0A%7D%0D%0A%0D%0A#spare%20%7B%0D%0A%09margin:%200;%0D%0A%09width:%20100%25;%0D%0A%09background:%20skyblue;%0D%0A%7D%0D%0A%0D%0A#imageLink%20%7B%0D%0A%09width:%2090%25;%0D%0A%20%20%09margin-top:%2010px;%0D%0A%09border:%200.5px%20solid%20black;%0D%0A%09border-radius:%202px;%0D%0A%09font-family:%20monospace;%0D%0A%09font-size:%200.8em;%0D%0A%09text-align:%20center;%0D%0A%7D%0D%0A%0D%0A#newPuzzle%20%7B%0D%0A%20%20%20%20height:%2030px;%0D%0A%20%20%09margin:%2010px%200;%0D%0A%09padding:%200%2030px;%0D%0A%09border:%20none;%0D%0A%09border-radius:%2015px;%0D%0A%09background:%20plum;%0D%0A%09color:%20rgba(0,%200,%200,%200.8);%0D%0A%20%20%20%20outline:%20none;%0D%0A%20%20%20%20cursor:%20pointer;%0D%0A%7D%0D%0A%0D%0A.piece%20%7B%0D%0A%09display:%20inline-block;%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20border-radius:%205px;%0D%0A%20%20%20%20border:%20rgba(255,%20255,%20255,%200.6)%20solid%200.5px;%0D%0A%20%20%20%20box-sizing:%20border-box;%0D%0A%20%20%20%20transition-property:%20top,%20left;%0D%0A%20%20%20%20cursor:%20-webkit-grab;%0D%0A%7D%0D%0A%0D%0A.piece:active%20%7B%0D%0A%20%20%20%20cursor:%20-webkit-grabbing;%0D%0A%7D##CSS_E####JS##const%0D%0A%09resolution%20=%20%5B4,%203%5D,%0D%0A%20%20%20%20sizeRatio%20=%200.9;%0D%0A%20%20%20%20%0D%0Alet%0D%0A%09image,%0D%0A%20%20%20%20puzzle%20=%20%5B%5D,%0D%0A%20%20%20%20puzzleGrid%20=%20%5B%5D,%0D%0A%20%20%20%20activeIndex,%0D%0A%20%20%20%20activeGrid,%0D%0A%20%20%20%20secondaryLocation,%0D%0A%20%20%20%20mouseDown%20=%20false;%0D%0A%0D%0A//%20=====%20FUNCTIONS%20=====%0D%0A%0D%0Afunction%20loadImage()%20%7B%0D%0A%09image%20=%20document.createElement('img');%0D%0A%0D%0A%09if%20(imageLink.value)%20%7B%0D%0A%09%09image.src%20=%20imageLink.value;%0D%0A%09%09imageLink.value%20=%20'';%0D%0A%09%7D%20else%20%7B%0D%0A%09%09image.src%20=%20'http://8bitdecals.com/wp-content/uploads/2012/06/EBY-Rio-Poster-34k.png';%0D%0A%09%09//%20http://8bitdecals.com/wp-content/uploads/2012/06/EBY-MarseillePoster-30k1.png%0D%0A%09%09//%20http://8bitdecals.com/wp-content/uploads/2012/06/AOA-amnesty-28.png%0D%0A%09%09//%20http://uploads2.wikiart.org/images/vincent-van-gogh/the-starry-night-1889(1).jpg%0D%0A%09%09//%20https://wallpapers.wallhaven.cc/wallpapers/full/wallhaven-48723.jpg%0D%0A%09%7D%0D%0A%0D%0A%09image.onload%20=%20function()%20%7B%20initialze()%20%7D;%0D%0A%7D%0D%0A%0D%0Afunction%20initialze()%20%7B%0D%0A%09generatePuzzle();%0D%0A%20%20%20%20shuffle(puzzle);%0D%0A%0D%0A%20%20%20%20spare.style.height%20=%20window.innerHeight%20-%20spare.offsetTop%20+%20'px';%0D%0A%20%20%20%20newPuzzle.innerHTML%20=%20'New%20Puzzle';%0D%0A%0D%0A%20%20%20%20puzzle.forEach((piece,%20i)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20puzzleContainer.appendChild(piece);%0D%0A%20%20%20%20%20%20%20%20piece.location%20=%20puzzleGrid%5Bi%5D;%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(Math.random()%20%3E%200.7)%20%7B%0D%0A%20%20%20%20%20%20%20%20%09puzzleGrid%5Bi%5D.isEmpty%20=%20false;%0D%0A%09%20%20%20%20%20%20%20%20piece.style.left%20=%20puzzleGrid%5Bi%5D.x;%0D%0A%09%20%20%20%20%20%20%20%20piece.style.top%20=%20puzzleGrid%5Bi%5D.y;%0D%0A%09%20%20%20%20%7D%20else%20%7B%0D%0A%09%20%20%20%20%09puzzleGrid%5Bi%5D.isEmpty%20=%20true;%0D%0A%09%20%20%20%20%09piece.style.left%20=%20range(10,%20puzzleContainer.offsetWidth%20-%20piece.offsetWidth%20-%2010)%20+%20'px';%0D%0A%09%20%20%20%20%09piece.style.top%20=%20range(spare.offsetTop,%20window.innerHeight%20-%20puzzleContainer.offsetTop%20-%20piece.offsetHeight)%20-%2020%20+%20'px';%0D%0A%09%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20generatePuzzle()%20%7B%0D%0A%20%20%20%20const%0D%0A%20%20%20%20%09hr%20=%20window.innerWidth%20*%20sizeRatio%20/%20image.width,%0D%0A%20%20%20%20%09vr%20=%20window.innerHeight%20*%20sizeRatio%20/%20image.height,%0D%0A%20%20%20%20%09r%20=%20Math.min(hr,%20vr);%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20loop%20to%20create%20all%20pieces%20in%20the%20puzzle%0D%0A%20%20%20%20for%20(let%20i%20=%200;%20i%20%3C%20resolution%5B0%5D%20*%20resolution%5B1%5D;%20i++)%20%7B%0D%0A%20%20%20%20%20%20%20%20const%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20piece%20=%20document.createElement('div'),%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20x%20=%20i%20%25%20resolution%5B0%5D%20*%20(image.width%20*%20r%20/%20resolution%5B0%5D),%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20y%20=%20Math.floor(i%20/%20resolution%5B0%5D)%20*%20(image.height%20*%20r%20/%20resolution%5B1%5D);%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20piece.id%20=%20%60piece$%7Bi%7D%60;%0D%0A%20%20%20%20%20%20%20%20piece.className%20=%20%22piece%22;%0D%0A%20%20%20%20%20%20%20%20piece.style.width%20=%20%60$%7Bimage.width%20*%20r%20/%20resolution%5B0%5D%7Dpx%60;%0D%0A%20%20%20%20%20%20%20%20piece.style.height%20=%20%60$%7Bimage.height%20*%20r%20/%20resolution%5B1%5D%7Dpx%60;%0D%0A%20%20%20%20%20%20%20%20piece.style.backgroundImage%20=%20%60url($%7Bimage.src%7D)%60;%0D%0A%20%20%20%20%20%20%20%20piece.style.backgroundSize%20=%20%60$%7Bimage.width%20*%20r%7Dpx%20%20$%7Bimage.height%20*%20r%7Dpx%60;%0D%0A%20%20%20%20%20%20%20%20piece.style.backgroundPosition%20=%20%60-$%7Bx%7Dpx%20-$%7By%7Dpx%60;%0D%0A%20%20%20%20%20%20%20%20piece.style.zIndex%20=%20'0';%0D%0A%0D%0A%20%20%20%20%09//%20store%20each%20piece%20in%20an%20array%0D%0A%20%20%20%20%09puzzle.push(piece);%0D%0A%20%20%20%20%20%20%20%20puzzleGrid.push(%7Bx:%20%60$%7Bx%7Dpx%60,%20y:%20%60$%7By%7Dpx%60,%20isEmpty:%20true,%20index:%20i%7D);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20puzzleContainer.style.width%20=%20%60$%7Bimage.width%20*%20r%7Dpx%60;%0D%0A%20%20%20%20puzzleContainer.style.height%20=%20%60$%7Bimage.height%20*%20r%7Dpx%60;%0D%0A%7D%0D%0A%0D%0Afunction%20shuffle(array)%20%7B%0D%0A%20%20%20%20let%20counter%20=%20array.length;%0D%0A%0D%0A%20%20%20%20//%20While%20there%20are%20elements%20in%20the%20array%0D%0A%20%20%20%20while%20(counter%20%3E%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20Pick%20a%20random%20index%0D%0A%20%20%20%20%20%20%20%20let%20index%20=%20Math.floor(Math.random()%20*%20counter);%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20Decrease%20counter%20by%201%0D%0A%20%20%20%20%20%20%20%20counter--;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20And%20swap%20the%20last%20element%20with%20it%0D%0A%20%20%20%20%20%20%20%20let%20temp%20=%20array%5Bcounter%5D;%0D%0A%20%20%20%20%20%20%20%20array%5Bcounter%5D%20=%20array%5Bindex%5D;%0D%0A%20%20%20%20%20%20%20%20array%5Bindex%5D%20=%20temp;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20selectPiece(target)%20%7B%0D%0A%20%20%20%20if%20(!Number.isInteger(activeIndex))%20%7B%0D%0A%20%20%20%20%20%20%20%20activeIndex%20=%20puzzle.includes(target)%20?%20puzzle.indexOf(target)%20:%20null;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(Number.isInteger(activeIndex))%20%7B%0D%0A%20%20%20%20%20%20%20%20%09console.clear();%20%20%20%20%20%20%20%20%09%0D%0A%20%20%20%20%20%20%20%20%09console.log('Active:',%20puzzle%5BactiveIndex%5D.id,%20%60puzzle%5B$%7Bpuzzle%5BactiveIndex%5D.location.index%7D%5D%60);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%09puzzle.forEach(piece%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%09%09if%20(piece)%20piece.style.zIndex%20=%20'0';%0D%0A%20%20%20%20%20%20%20%20%09%7D);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20puzzle%5BactiveIndex%5D.style.zIndex%20=%20'1';%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(puzzleGrid%5BactiveIndex%5D.isEmpty)%20secondaryLocation%20=%20%7Bx:%20puzzle%5BactiveIndex%5D.offsetLeft%20+%20'px',%20y:%20puzzle%5BactiveIndex%5D.offsetTop%20+%20'px'%7D;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20s%20=%20puzzleGrid%5BactiveIndex%5D.isEmpty;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20puzzleGrid%5BactiveIndex%5D.isEmpty%20=%20true;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20console.log('Picked%20up%20from',%20puzzleGrid%5BactiveIndex%5D,%20puzzleGrid%5BactiveIndex%5D.isEmpty);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20console.log(%60puzzle%5B$%7BactiveIndex%7D%5D.isEmpty:%20$%7Bs%7D%20=%3E%20$%7BpuzzleGrid%5BactiveIndex%5D.isEmpty%7D%60);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20movePiece(clientX,%20clientY)%20%7B%0D%0A%20%20%20%20if%20(Number.isInteger(activeIndex))%20%7B%0D%0A%20%20%20%20%20%20%20%20const%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20offsetX%20=%20clientX%20-%20puzzleContainer.offsetLeft,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20offsetY%20=%20clientY%20-%20puzzleContainer.offsetTop,%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20piece%20=%20puzzle%5BactiveIndex%5D.getBoundingClientRect();%0D%0A%0D%0A%20%20%20%20%20%20%20%20activeGrid%20=%20puzzleGrid%5BMath.floor(offsetY%20/%20piece.height)%20*%20resolution%5B0%5D%20+%20Math.floor(offsetX%20/%20piece.width)%5D;%0D%0A%0D%0A%20%20%20%20%20%20%20%20puzzle%5BactiveIndex%5D.style.transitionDuration%20=%20'0s';%0D%0A%20%20%20%20%20%20%20%20puzzle%5BactiveIndex%5D.style.left%20=%20%60$%7BoffsetX%20-%20puzzle%5BactiveIndex%5D.offsetWidth%20/%202%7Dpx%60;%0D%0A%20%20%20%20%20%20%20%20puzzle%5BactiveIndex%5D.style.top%20=%20%60$%7BoffsetY%20-%20puzzle%5BactiveIndex%5D.offsetHeight%20/%202%7Dpx%60;%0D%0A%0D%0A%20%20%20%20%20%20%20%20console.clear();%0D%0A%09%20%20%20%20console.log('Picked%20up%20from',%20puzzleGrid%5BactiveIndex%5D);%0D%0A%09%20%20%20%20console.log(%60puzzle%5B$%7BactiveIndex%7D%5D.isEmpty:%20$%7BpuzzleGrid%5BactiveIndex%5D.isEmpty%7D%60);%0D%0A%0D%0A%09%20%20%20%20if%20(activeGrid)%0D%0A%09%20%20%20%20%09console.log('Hovering%20above',%20activeGrid);%0D%0A%09%20%20%20%20else%0D%0A%09%20%20%20%20%09console.log('Hovering%20outside%20puzzle.');%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20dropPiece(clientX,%20clientY)%20%7B%0D%0A%09if%20(Number.isInteger(activeIndex))%20%7B%0D%0A%09%09if%20(activeGrid%20&&%20activeGrid.isEmpty)%20%7B%0D%0A%09%09%09placePiece(activeGrid);%0D%0A%09%09%7D%20else%20%7B%0D%0A%09%09%09const%0D%0A%09%09%09%09h%20=%20clientX%20%3E=%20spare.offsetLeft%20&&%20clientX%20%3C=%20spare.offsetLeft%20+%20spare.offsetWidth,%0D%0A%09%09%09%09v%20=%20clientY%20%3E=%20spare.offsetTop%20+%20puzzle%5BactiveIndex%5D.offsetHeight%20/%202%20&&%20clientY%20%3C=%20spare.offsetTop%20+%20spare.offsetHeight;%0D%0A%09%09%09%0D%0A%09%09%09//%20if%20dropped%20inside%20the%20blue%20area%0D%0A%09%09%09if%20(h%20&&%20v)%20%7B%0D%0A%09%09%09%09placePiece(%7Bx:%20%60$%7Bpuzzle%5BactiveIndex%5D.offsetLeft%7Dpx%60,%20y:%20%60$%7Bpuzzle%5BactiveIndex%5D.offsetTop%7Dpx%60%7D);%0D%0A%09%09%09%09console.log('Dropped%20in%20spare%20box.');%0D%0A%09%09%09%7D%20else%20%7B%0D%0A%09%09%09%09placePiece(secondaryLocation%20%7C%7C%20puzzle%5BactiveIndex%5D.location);%0D%0A%09%09%09%09secondaryLocation%20=%20null;%0D%0A%09%09%09%7D%0D%0A%09%09%7D%0D%0A%09%09activeIndex%20=%20null;%0D%0A%09%7D%0D%0A%09%0D%0A%09const%20selection%20=%20window.getSelection();%0D%0A%09if%20(selection.type%20==%20'Range')%20selection.removeAllRanges();%0D%0A%7D%0D%0A%0D%0Afunction%20placePiece(target)%20%7B%0D%0A%09puzzle%5BactiveIndex%5D.style.transitionDuration%20=%20'0.2s';%0D%0A%20%20%20%20puzzle%5BactiveIndex%5D.style.left%20=%20target.x;%0D%0A%20%20%20%20puzzle%5BactiveIndex%5D.style.top%20=%20target.y;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(target.hasOwnProperty('index'))%20%7B%0D%0A%20%20%20%20%09let%20s%20=%20puzzleGrid%5Btarget.index%5D.isEmpty;%0D%0A%20%20%20%20%09puzzleGrid%5Btarget.index%5D.isEmpty%20=%20false;%0D%0A%20%20%20%20%09console.log(%60puzzleGrid%5B$%7Btarget.index%7D%5D.isEmpty:%20$%7Bs%7D%20=%3E%20$%7BpuzzleGrid%5Btarget.index%5D.isEmpty%7D%60);%0D%0A%09%09%0D%0A%09%09s%20=%20puzzle%5BactiveIndex%5D.location;%0D%0A%09%09puzzle%5BactiveIndex%5D.location%20=%20target;%0D%0A%09%09console.log(%60puzzle%5B$%7BactiveIndex%7D%5D.location:%60,%20s,%20'=%3E',%20puzzle%5BactiveIndex%5D.location);%0D%0A%0D%0A%09%09//%20swap%20pieces%20in%20the%20puzzle%20array%0D%0A%09%09const%20swap%20=%20puzzle%5Btarget.index%5D;%0D%0A%09%09puzzle%5Btarget.index%5D%20=%20puzzle%5BactiveIndex%5D;%0D%0A%09%09puzzle%5BactiveIndex%5D%20=%20swap;%0D%0A%0D%0A%09%09checkPuzzle();%0D%0A%09%7D%0D%0A%7D%0D%0A%0D%0Afunction%20checkPuzzle()%20%7B%0D%0A%09let%20pass%20=%20puzzle.every((piece,%20i)%20=%3E%20%7B%0D%0A%09%09return%20piece.id%20==%20%60piece$%7Bi%7D%60;%0D%0A%09%7D);%0D%0A%0D%0A%09if%20(pass%20&&%20puzzleGrid.every(grid%20=%3E%20!grid.isEmpty))%20%7B%0D%0A%09%09puzzleContainer.style.borderColor%20=%20'green';%0D%0A%09%09newPuzzle.innerHTML%20=%20'You%20solved%20the%20puzzle.%20Play%20again.';%09%09%0D%0A%09%7D%0D%0A%7D%0D%0A%0D%0Afunction%20resetPuzzle()%20%7B%0D%0A%09puzzle.forEach(piece%20=%3E%20puzzleContainer.removeChild(piece));%0D%0A%0D%0A%09image%20=%20null;%0D%0A%20%20%20%20puzzle%20=%20%5B%5D;%0D%0A%20%20%20%20puzzleGrid%20=%20%5B%5D;%0D%0A%20%20%20%20activeIndex%20=%20null;%0D%0A%20%20%20%20activeGrid%20=%20null;%0D%0A%20%20%20%20mouseDown%20=%20false;%0D%0A%20%20%20%20newPuzzle.innerHTML%20=%20'Loading%20image...';%0D%0A%20%20%20%20puzzleContainer.style.borderColor%20=%20'black';%0D%0A%0D%0A%20%20%20%20loadImage();%0D%0A%7D%0D%0A%0D%0Afunction%20range(min,%20max,%20int%20=%20false)%20%7B%0D%0A%20%20%20%20const%20r%20=%20Math.random()%20*%20(max%20-%20min)%20+%20min;%0D%0A%20%20%20%20return%20int%20?%20Math.round(r)%20:%20r;%0D%0A%7D%0D%0A%0D%0A//%20=====%20EVENTS%20=====%0D%0A%0D%0Awindow.onload%20=%20function()%20%7B%20%0D%0A%09loadImage();%0D%0A%09newPuzzle.onclick%20=%20function()%20%7B%20resetPuzzle()%20%7D;%0D%0A%7D;%0D%0A%0D%0Awindow.ontouchstart%20=%20(evt)%20=%3E%20selectPiece(evt.target);%0D%0Awindow.onmousedown%20=%20(evt)%20=%3E%20%7B%0D%0A%20%20%20%20mouseDown%20=%20true;%0D%0A%20%20%20%20selectPiece(evt.target);%0D%0A%7D;%0D%0A%20%20%20%20%0D%0Awindow.ontouchmove%20=%20(evt)%20=%3E%20movePiece(evt.touches%5B0%5D.clientX,%20evt.touches%5B0%5D.clientY);%0D%0Awindow.onmousemove%20=%20(evt)%20=%3E%20%7B%0D%0A%20%20%20%20if%20(mouseDown)%20movePiece(evt.clientX,%20evt.clientY);%0D%0A%7D;%0D%0A%0D%0Awindow.ontouchend%20=%20(evt)%20=%3E%20dropPiece(evt.changedTouches%5B0%5D.clientX,%20evt.changedTouches%5B0%5D.clientY);%0D%0Awindow.onmouseup%20=%20function(evt)%20%7B%0D%0A%20%20%20%20mouseDown%20=%20false;%0D%0A%20%20%20%20dropPiece(evt.clientX,%20evt.clientY);%0D%0A%7D;##JS_E####CODE_1E####LOGIC_1####HTML####HTML_E####CSS####CSS_E####JS####JS_E####LOGIC_1E####STEP_1E##