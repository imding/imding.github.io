69##STEP_1####INST_1##Introduction%0A%0AHello%20and%20welcome!%0A%0ASurely%20you've%20played%20a%20scrolling%20game%20on%20the%20web,%20if%20you%20enjoy%20this%20type%20of%20games%20and%20are%20interested%20to%20learn%20how%20such%20a%20game%20can%20be%20made,%20this%20project%20is%20just%20for%20you.%0A%0AWe%20will%20begin%20with%20%5B#html#HTML%5D%20and%20%5B#css#CSS%5D%20to%20create%20the%20interface%20of%20the%20game,%20and%20then%20quickly%20dive%20into%20%5B#js#JavaScript%5D%20so%20our%20game%20becomes%20playable.%0A%0ABut%20before%20we%20start,%20try%20out%20the%20game%20first%20so%20you%20know%20how%20it%20works.%0A%0A(***)%0A%0A(!)Play%20the%20game%20and%20reach%20the%20finish%20sign%20with%20all%207%20coins%20collected.##INST_1E####CODE_1####HTML##%3C!DOCTYPE%20html%3E%0D%0A%3Chtml%3E%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0D%0A%3C/head%3E%0D%0A%3Cbody%3E%0D%0A%20%20%20%20%3Cdiv%20id=%22game%22%3E%0D%0A%20%20%20%20%20%20%20%20%3Ch1%20id=%22scoreboard%22%3EScore:%20%3Cspan%20id=%22score%22%3E0%3C/span%3E/%3Cspan%20id=%22totalCoins%22%3E?%3C/span%3E%3C/h1%3E%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0D%0A%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22jump%22%3E%3C/div%3E%0D%0A%20%20%20%20%20%20%20%20%3C/div%3E%0D%0A%20%20%20%20%3C/div%3E%0D%0A%20%20%20%20%0D%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0D%0A%3C/body%3E%0D%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0D%0A%20%20%20%20margin:%200;%0D%0A%7D%0D%0A%0D%0A#game%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20width:%20768px;%0D%0A%7D%0D%0A%0D%0A#scoreboard%20%7B%0D%0A%20%20%20%20margin-top:%200;%0D%0A%20%20%20%20text-align:%20center;%0D%0A%7D%0D%0A%0D%0A#scene%20%7B%0D%0A%20%20%20%20position:%20relative;%0D%0A%20%20%20%20width:%20768px;%0D%0A%20%20%20%20height:%20600px;%0D%0A%20%20%20%20margin:%20auto;%0D%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0D%0A%20%20%20%20background-size:%20cover;%0D%0A%20%20%20%20overflow:%20hidden;%0D%0A%7D%0D%0A%0D%0A#player%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20top:%20-100%25;%0D%0A%20%20%20%20width:%2064px;%0D%0A%20%20%20%20height:%2064px;%0D%0A%20%20%20%20background-size:%20contain;%0D%0A%20%20%20%20background-repeat:%20no-repeat;%0D%0A%7D%0D%0A%0D%0A.run%20%7B%0D%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0D%0A%7D%0D%0A%0D%0A.jump%20%7B%0D%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0D%0A%7D%0D%0A%0D%0A.crash%20%7B%0D%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0D%0A%7D%0D%0A%0D%0A#terrainContainer%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20left:%200;%0D%0A%20%20%20%20bottom:%200;%0D%0A%20%20%20%20height:%20100%25;%0D%0A%7D%0D%0A%0D%0A.block%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20width:%2064px;%0D%0A%20%20%20%20height:%2064px;%0D%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0D%0A%20%20%20%20background-size:%20cover;%0D%0A%7D%0D%0A%0D%0A.top%20%7B%0D%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0D%0A%7D%0D%0A%0D%0A.platform%20%7B%0D%0A%20%20%20%20height:%2032px;%0D%0A%7D%0D%0A%0D%0A.coin%20%7B%0D%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/spin_coin.gif%22);%0D%0A%20%20%20%20background-size:%20contain;%0D%0A%20%20%20%20width:%2030px;%0D%0A%20%20%20%20height:%2030px;%0D%0A%20%20%20%20position:%20absolute;%0D%0A%7D%0D%0A%0D%0A#finishSign%20%7B%0D%0A%20%20%20%20position:%20absolute;%0D%0A%20%20%20%20width:%2064px;%0D%0A%20%20%20%20height:%2064px;%0D%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0D%0A%20%20%20%20background-size:%20cover;%0D%0A%7D%0D%0A%0D%0A.collected%20%7B%0D%0A%20%20%20%20display:%20none;%0D%0A%7D##CSS_E####JS##var%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0Avar%20score%20=%20document.querySelector(%22#score%22);%0D%0A%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerStartTop%20=%20300;%0D%0Avar%20playerTop%20=%20playerStartTop;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%20%5B2,%201,%201,%200,%200,%200,%200,%201,%203,%203,%205,%205,%203,%202,%202,%204,%204%5D;%0D%0Avar%20platform%20=%20%5B0,%200,%200,%203,%202,%202%5D;%0D%0Avar%20coins%20=%20%20%20%20%5B0,%200,%200,%203,%204,%203,%202,%202,%200,%203,%200,%207%5D;%0D%0A%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0AgenerateTerrain();%0D%0AgameLoop();%0D%0A%0D%0Awindow.onload%20=%20window.onresize%20=%20resizeGame;%0D%0A%0D%0Awindow.onkeydown%20=%20function()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20===%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D;%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20var%20timeThisFrame%20=%20Date.now();%0D%0A%20%20%20%20var%20elapsed%20=%20timeThisFrame%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20timeThisFrame%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectCoinCollision();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%20%20%20%20detectFinishSign();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20true%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20%20%20%20%20var%20blockNearPlayer%20=%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20playerLeft%20+%20playerWidth%20%3E%20blockLeft%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20playerLeft%20%3C%20blockLeft%20+%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(blockNearPlayer%20===%20true%20&&%20playerActive%20===%20true)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20topCollision%20=%20playerTop%20+%20playerHeight%20%3E=%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(topCollision%20===%20true)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20adjustTop%20=%20blockTop%20-%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20-%20adjustTop%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(block.classList.contains(%22platform%22)%20===%20false)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20(pixelPerFrame%20%3E=%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20adjustTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20===%20true)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectCoinCollision()%20%7B%0D%0A%20%20%20%20coins.forEach(coin%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(coin.className%20===%20%22coin%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinLeft%20=%20coin.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20collected%20=%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerLeft%20+%20playerWidth%20%3E%20coinLeft%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerLeft%20%3C%20coinLeft%20+%20coin.offsetWidth%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20+%20playerHeight%20%3E%20coin.offsetTop%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20%3C%20coin.offsetTop%20+%20coin.offsetHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(collected)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20currentScore%20=%20parseInt(score.textContent);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20score.textContent%20=%20currentScore%20+%201;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20coin.classList.add(%22collected%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20detectFinishSign()%20%7B%0D%0A%20%20%20%20var%20signLeft%20=%20finishSign.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20var%20finished%20=%20playerInAir%20===%20false%20&&%20playerLeft%20%3E=%20signLeft;%0D%0A%0D%0A%20%20%20%20if%20(finished)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerActive%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20if%20(confirm(%22You%20finished%20this%20level,%20play%20again?%22))%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%20%20%20%20//%20%7D%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20playerTop%20+%20playerHeight%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20terrain.forEach((column,%20nthColumn)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(column).fill();%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20nthColumn%20*%20blockSize%20+%20playerLeft;%0D%0A%20%20%20%20%20%20%20%20var%20finalColumn%20=%20nthColumn%20===%20terrain.length%20-%201;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20nthBlock)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20(column%20-%20nthBlock%20-%201)%20*%20blockSize%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(nthBlock%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(finalColumn%20===%20true)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20finishSign%20=%20document.createElement(%22div%22);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.id%20=%20%22finishSign%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(finishSign);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.left%20=%20newBlock.style.left;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.bottom%20=%20parseFloat(newBlock.style.bottom)%20+%20blockSize%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(platform%5BnthColumn%5D%20%3E%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20newPlatform%20=%20document.createElement(%22div%22);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newPlatform.className%20=%20%22block%20top%20platform%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newPlatform);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newPlatform.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newPlatform.style.bottom%20=%20platform%5BnthColumn%5D%20*%20blockSize%20-%2032%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20if%20(coins%5BnthColumn%5D%20%3E%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20newCoin%20=%20document.createElement(%22div%22);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.className%20=%20%22coin%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newCoin);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20widthDiff%20=%20(blockSize%20-%20newCoin.offsetWidth)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20heightDiff%20=%20(blockSize%20-%20newCoin.offsetHeight)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20floatHeight%20=%20coins%5BnthColumn%5D%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.left%20=%20columnLeft%20+%20widthDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.bottom%20=%20floatHeight%20+%20heightDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20coins%20=%20document.querySelectorAll(%22.coin%22);%0D%0A%20%20%20%20totalCoins.textContent%20=%20coins.length;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20playerStartTop;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%0D%0A%20%20%20%20score.textContent%20=%200;%0D%0A%20%20%20%20coins.forEach(coin%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20coin.classList.remove(%22collected%22);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20resizeGame()%20%7B%0D%0A%20%20%20%20var%20gameRatio%20=%20game.offsetWidth%20/%20game.offsetHeight;%0D%0A%20%20%20%20var%20windowRatio%20=%20window.innerWidth%20/%20window.innerHeight;%0D%0A%20%20%20%20%0D%0A%20%20%20%20game.style.left%20=%20%60$%7B(window.innerWidth%20-%20game.offsetWidth)%20/%202%7Dpx%60;%0D%0A%20%20%20%20game.style.top%20=%20%60$%7B(window.innerHeight%20-%20game.offsetHeight)%20/%202%7Dpx%60;%0D%0A%20%20%20%20game.style.transform%20=%20%60scale($%7BgameRatio%20%3E%20windowRatio%20?%20window.innerWidth%20/%20game.offsetWidth%20:%20window.innerHeight%20/%20game.offsetHeight%7D)%60;%0D%0A%7D%0D%0A##JS_E####CODE_1E####LOGIC_1####HTML####HTML_E####CSS####CSS_E####JS##pass.on('detectFinishSign').var('finished%20&&%20score.textContent%20==%20%227%22');##JS_E####LOGIC_1E####STEP_1E####STEP_2####INST_2##Scene%20container%0A%0AOkay,%20let's%20begin%20by%20adding%20an%20%5B#html#element%5D%20to%20our%20page,%20we%20will%20later%20put%20everything%20in%20our%20game,%20such%20as%20the%20background%20image,%20character%20and%20terrain,%20into%20this%20element.%0A%0AWe%20don't%20want%20to%20actually%20see%20this%20element,%20it's%20just%20there%20to%20hold%20other%20elements,%20that's%20why%20the%20%60%3Cdiv%3E%60%20is%20the%20perfect%20choice.%0A%0AAfterwards,%20we'll%20also%20add%20an%20*id*%20%5B#html#attribute%5D%20so%20a%20CSS%20rule%20can%20be%20created%20for%20it.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#html#%3Cdiv%3E%5D%0A%09(*)%5B#html#id%5D%0A%09(*)%5B#css#rule%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+html#/body#-1,%20create%20a%20%60%3Cdiv%3E%60%20element%20and%20set%20the%20%60id%60%20attribute%20to%20*scene*.%0A%0A(%3E%3Estyle.css)%0A%0A(!)On%20+css#body#+4,%20create%20an%20empty%20rule%20for%20*#scene*.##INST_2E####CODE_2####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20#BEGIN_EDITABLE#%3Cdiv%20id=%22scene%22%3E%3C/div%3E#END_EDITABLE#%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#BEGIN_EDITABLE##scene%20%7B%7D#END_EDITABLE###CSS_E####JS###BEGIN_EDITABLE##END_EDITABLE###JS_E####CODE_2E####LOGIC_2####HTML##//%20Expectation:%0Apass.if.html.editable(0).equivalent(%60%3Cdiv%20id=%22scene%22%3E%3C/div%3E%60);##HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60#scene%20%7B%7D%60);##CSS_E####JS####JS_E####LOGIC_2E####STEP_2E####STEP_3####INST_3##Scene%20image%0A%0AIf%20you're%20not%20seeing%20the%20%60%3Cdiv%3E%60%20that%20you%20just%20created,%20you're%20doing%20it%20right.%20%0A%0A%60%3Cdiv%3E%60%20elements%20have%200%20height%20by%20default,%20you%20can%20see%20this%20by%20using%20the%20*Inspect*%20tool%20on%20the%20output%20panel.%0A%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_no_height.png%5D%0A%0AWe%20are%20going%20to%20give%20the%20*#scene*%20element%20a%20width,%20height%20and%20a%20background%20image.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#css#width%5D%0A%09(*)%5B#css#height%5D%0A%09(*)%5B#css#background-image%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+css#scene%20%7B#+1,%20make%20the%20*#scene*%20element%20*768%20pixels*%20wide.%0A%0A(!)On%20+css#scene%20%7B#+2,%20make%20the%20*#scene*%20element%20*600%20pixels*%20tall.%0A%0A(!)On%20+css#scene%20%7B#+3,%20use%20the%20following%20image%20as%20background%20image%20for%20*#scene*.%0A(*)https://app.bsd.education/resources/game_bg.png%0A%5Bimg::https://app.bsd.education/resources/game_bg.png%5D##INST_3E####CODE_3####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%3C/div%3E%0A%3C/body%3E%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20#BEGIN_EDITABLE#width:%20768px;#END_EDITABLE#%0A%20%20%20%20#BEGIN_EDITABLE#height:%20600px;#END_EDITABLE#%0A%20%20%20%20#BEGIN_EDITABLE#background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);#END_EDITABLE#%0A%7D##CSS_E####JS####JS_E####CODE_3E####LOGIC_3####HTML####HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60width:%20768px;%60);%0Apass.if.css.editable(1).equivalent(%60height:%20600px;%60);%0Apass.if.css.editable(2).equivalent(%60background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%60);##CSS_E####JS####JS_E####LOGIC_3E####STEP_3E####STEP_4####INST_4##Scene%20image%20adjustments%0A%0AIf%20you%20maximise%20the%20output%20panel,%20you%20will%20see%20that%20our%20scene%20is%20not%20centred%20on%20the%20page.%0A%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_maximise_output.png%5D%0A%0AThis%20won't%20affect%20our%20game%20in%20a%20major%20way,%20but%20details%20are%20important%20and%20we're%20going%20to%20make%20it%20the%20best%20we%20can.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#css#margin%5D%0A%09(*)%5B#css#background-size%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+css#600px#+1,%20center%20the%20*#scene*%20element%20using%20the%20%60margin%60%20property.%0A%0A(!)On%20+css#url#+1,%20resize%20the%20background%20image%20to%20fully%20cover%20the%20*#scene*%20element.##INST_4E####CODE_4####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%3C/div%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20#BEGIN_EDITABLE#margin:%20auto;#END_EDITABLE#%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20#BEGIN_EDITABLE#background-size:%20cover;#END_EDITABLE#%0A%7D##CSS_E####JS####JS_E####CODE_4E####LOGIC_4####HTML####HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60margin:%20auto;%60).or(%60margin:%200%20auto%60);%0Apass.if.css.editable(1).equivalent(%60background-size:%20cover;%60);##CSS_E####JS####JS_E####LOGIC_4E####STEP_4E####STEP_5####INST_5##Character%20container%0A%0AThe%20scene%20is%20done!%20However,%20it's%20rather%20empty%20at%20the%20moment,%20let's%20start%20working%20on%20the%20character.%0A%0AWe%20will%20once%20again%20use%20the%20%60%3Cdiv%3E%60%20element%20here.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#html#%3Cdiv%3E%5D%0A%09(*)%5B#html#id%5D%20&%20%5B#html#class%5D%0A%09(*)%5B#css#rule%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+html#%3Cbody#+2,%20create%20a%20%60%3Cdiv%3E%60%20element,%20set%20the%20%60id%60%20attribute%20to%20*player*%20and%20the%20%60class%60%20attribute%20to%20*run*.%0A%0A(%3E%3Estyle.css)%0A%0A(!)On%20+css#cover#+3,%20create%20an%20empty%20rule%20for%20*#player*.%0A%0A(!)On%20+css#cover#+5,%20create%20an%20empty%20rule%20for%20*.run*.##INST_5E####CODE_5####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E#END_EDITABLE#%0A%20%20%20%20%3C/div%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#BEGIN_EDITABLE##player%20%7B%7D#END_EDITABLE#%0A%0A#BEGIN_EDITABLE#.run%20%7B%7D#END_EDITABLE###CSS_E####JS####JS_E####CODE_5E####LOGIC_5####HTML##//%20Expectation:%0Apass.if.html.editable(0).equivalent(%60%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%60);##HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60#player%20%7B%7D%60);%0Apass.if.css.editable(1).equivalent(%60.run%20%7B%7D%60);##CSS_E####JS####JS_E####LOGIC_5E####STEP_5E####STEP_6####INST_6##Character%20image%0A%0AJust%20like%20the%20*#scene*%20element,%20our%20*#player*%20element%20is%20also%20a%20%60%3Cdiv%3E%60,%20which%20is%20invisible%20by%20default.%0A%0AWe%20need%20to%20resize%20the%20player%20and%20also%20give%20it%20a%20background%20image.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#css#width%5D%0A%09(*)%5B#css#height%5D%0A%09(*)%5B#css#background-image%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+css#%5C#player#+1,%20make%20the%20*#player*%20element%20*64%20pixels*%20wide.%0A(!)On%20+css#%5C#player#+2,%20make%20the%20*#player*%20element%20*64%20pixels*%20tall.%0A%0A(!)On%20+css#.run#+1,%20use%20the%20following%20image%20as%20background%20image%20for%20*.run*.%0A(*)https://app.bsd.education/resources/mario_run.gif%0A%5Bimg::https://app.bsd.education/resources/mario_run.gif%5D##INST_6E####CODE_6####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%3C/body%3E%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20#BEGIN_EDITABLE#width:%2064px;#END_EDITABLE#%0A%20%20%20%20#BEGIN_EDITABLE#height:%2064px;#END_EDITABLE#%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20#BEGIN_EDITABLE#background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);#END_EDITABLE#%0A%7D##CSS_E####JS####JS_E####CODE_6E####LOGIC_6####HTML####HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60width:%2064px;%60);%0Apass.if.css.editable(1).equivalent(%60height:%2064px;%60);%0Apass.if.css.editable(2).equivalent(%60background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%60);##CSS_E####JS####JS_E####LOGIC_6E####STEP_6E####STEP_7####INST_7##Character%20image%20adjustments%0A%0AWe%20added%20the%20character%20image%20however,%20the%20*#player*%20element%20is%20only%2064%20pixels%20by%2064%20pixels%20and%20the%20image%20is%20bigger%20than%20that.%20We%20can%20fix%20that%20using%20the%20%60background-%60%20properties.%0A%0AOur%20character%20can%20have%203%20different%20appearances%20in%20the%20game%20-%20*run*,%20*jump*%20and%20*crash*%20(%20when%20you%20run%20into%20a%20block%20or%20fall%20off%20the%20platform%20).%0A%0AWe've%20already%20created%20the%20rule%20and%20property%20for%20running,%20and%20the%20process%20is%20the%20same%20for%20the%20other%20two.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#css#background-size%5D%0A%09(*)%5B#css#background-repeat%5D%0A%09(*)%5B#css#rule%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+css#%5C#player#+3,%20resize%20the%20background%20image%20to%20be%20*contained*%20within%20the%20*#player*%20element.%0A%0A(!)On%20+css#%5C#player#+4,%20disable%20repeating%20of%20the%20background%20image.%0A%0A(!)On%20+css#.run#+4,%20create%20an%20empty%20rule%20for%20*.jump*.%0A%0A(!)On%20+css#.run#+6,%20create%20an%20empty%20rule%20for%20*.crash*.##INST_7E####CODE_7####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20#BEGIN_EDITABLE#background-size:%20contain;#END_EDITABLE#%0A%20%20%20%20#BEGIN_EDITABLE#background-repeat:%20no-repeat;#END_EDITABLE#%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A#BEGIN_EDITABLE#.jump%20%7B%7D#END_EDITABLE#%0A%0A#BEGIN_EDITABLE#.crash%20%7B%7D#END_EDITABLE###CSS_E####JS####JS_E####CODE_7E####LOGIC_7####HTML####HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60background-size:%20contain;%60);%0Apass.if.css.editable(1).equivalent(%60background-repeat:%20no-repeat;%60);%0Apass.if.css.editable(2).equivalent(%60.jump%20%7B%7D%60);%0Apass.if.css.editable(3).equivalent(%60.crash%20%7B%7D%60);##CSS_E####JS####JS_E####LOGIC_7E####STEP_7E####STEP_8####INST_8##Other%20character%20images%0A%0AFor%20each%20of%20the%20two%20new%20rules%20we%20created,%20we'll%20also%20need%20to%20give%20them%20each%20a%20background%20image.%0A%0AAfter%20that,%20you%20can%20change%20the%20class%20name%20of%20the%20*#player*%20element%20in%20HTML%20to%20either%20*jump*%20or%20*crash*%20to%20see%20those%20images.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#css#background-image%5D%0A%09(*)%5B#html#class%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+css#.jump#+1,%20use%20the%20following%20image%20as%20background%20image%20for%20*.jump*.%0A(*)https://app.bsd.education/resources/mario_jump.png%0A%5Bimg::https://app.bsd.education/resources/mario_jump.png%5D%0A%0A(!)On%20+css#.crash#+1,%20use%20the%20following%20image%20as%20background%20image%20for%20*.crash*.%0A(*)https://app.bsd.education/resources/mario_crash.png%0A%5Bimg::https://app.bsd.education/resources/mario_crash.png%5D%0A%0A(%3E%3Eindex.html)%0A%0A(!)On%20+html#scene#+1,%20change%20the%20class%20attribute%20value%20to%20*jump*%20or%20*crash*.%0A(*)Make%20sure%20the%20correct%20image%20is%20shown%20for%20each%20class%20name.##INST_8E####CODE_8####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22#BEGIN_EDITABLE#run#END_EDITABLE#%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20#BEGIN_EDITABLE#background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);#END_EDITABLE#%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20#BEGIN_EDITABLE#background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);#END_EDITABLE#%0A%7D##CSS_E####JS####JS_E####CODE_8E####LOGIC_8####HTML##//%20Expectation:%0Apass.if.html.editable(0).equivalent(%60jump%60).or(%60crash%60);##HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%60);%0Apass.if.css.editable(1).equivalent(%60background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%60);##CSS_E####JS####JS_E####LOGIC_8E####STEP_8E####STEP_9####INST_9##Character%20positioning%0A%0AThe%20character%20asset%20is%20now%20done!%0A%0ANext%20we%20need%20to%20figure%20out%20how%20to%20position%20it%20at%20a%20specific%20place%20in%20the%20scene.%0A%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_player_position.png%5D%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#css#position%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+css#%5C#scene#+1,%20change%20the%20position%20mode%20to%20*relative*.%0A%0A(!)On%20+css#%5C#player#+1,%20change%20the%20position%20mode%20to%20*absolute*.%0A%0A(!)On%20+css#%5C#player#+2,%20place%20the%20*#player*%20element%20*300%20pixels*%20below%20the%20top%20edge%20of%20*#scene*.%0A%0A(!)On%20+css#%5C#player#+3,%20place%20the%20*#player*%20element%20*200%20pixels*%20away%20from%20the%20left%20edge%20of%20*#scene*.##INST_9E####CODE_9####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%3C/body%3E%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20#BEGIN_EDITABLE#position:%20relative;#END_EDITABLE#%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20#BEGIN_EDITABLE#position:%20absolute;#END_EDITABLE#%0A%20%20%20%20#BEGIN_EDITABLE#top:%20300px;#END_EDITABLE#%0A%20%20%20%20#BEGIN_EDITABLE#left:%20200px;#END_EDITABLE#%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%7B%20%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D##CSS_E####JS####JS_E####CODE_9E####LOGIC_9####HTML####HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60position:%20relative;%60);%0Apass.if.css.editable(1).equivalent(%60position:%20absolute;%60);%0Apass.if.css.editable(2).equivalent(%60top:%20300px;%60);%0Apass.if.css.editable(3).equivalent(%60left:%20200px;%60);##CSS_E####JS####JS_E####LOGIC_9E####STEP_9E####STEP_10####INST_10##Terrain%20container%0A%0AThe%20next%20asset%20we%20need%20to%20create%20is%20the%20terrain%20-%20blocks%20that%20the%20character%20will%20run%20on.%0A%0AThese%20blocks%20will%20go%20into%20a%20container,%20so%20later%20on%20we%20can%20move%20all%20the%20blocks%20by%20moving%20this%20one%20container.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#html#%3Cdiv%3E%5D%0A%09(*)%5B#html#id%5D%0A%09(*)%5B#css#rule%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+html#%3Cbody#+2,%20create%20a%20%60%3Cdiv%3E%60%20element%20and%20set%20the%20%60id%60%20attribute%20to%20*terrainContainer*.%0A%0A(%3E%3Estyle.css)%0A%0A(!)On%20+css#_crash#+3,%20create%20an%20empty%20rule%20for%20*#terrainContainer*.##INST_10E####CODE_10####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E#END_EDITABLE#%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%20200px;%0A%20%20%20%20top:%20300px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#BEGIN_EDITABLE##terrainContainer%20%7B%7D#END_EDITABLE###CSS_E####JS####JS_E####CODE_10E####LOGIC_10####HTML##//%20Expectation:%0Apass.if.html.editable(0).equivalent(%60%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%60);##HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60#terrainContainer%20%7B%7D%60);##CSS_E####JS####JS_E####LOGIC_10E####STEP_10E####STEP_11####INST_11##Terrain%20block%20container%0A%0AInside%20the%20*#terrainContainer*%20element,%20we%20need%20to%20add%20a%20few%20blocks.%0A%0AWe%20will%20only%20create%20and%20style%203%20blocks%20just%20to%20test%20things%20out,%20and%20then%20use%20JavaScript%20to%20add%20many%20more%20blocks%20later.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#html#%3Cdiv%3E%5D%0A%09(*)%5B#html#class%5D%0A%09(*)%5B#css#rule%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+html#%3Cbody#+3,%20html#%3Cbody#+4%20&%20html#%3Cbody#+5,%20create%20three%20%60%3Cdiv%3E%60%20elements%20and%20set%20the%20%60class%60%20attribute%20to%20*block*.%0A%0A(%3E%3Estyle.css)%0A%0A(!)On%20+css#bottom:#+3,%20create%20an%20empty%20rule%20for%20*.block*.##INST_11E####CODE_11####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#%3Cdiv%20class=%22block%22%3E%3C/div%3E#END_EDITABLE#%0A%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#%3Cdiv%20class=%22block%22%3E%3C/div%3E#END_EDITABLE#%0A%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#%3Cdiv%20class=%22block%22%3E%3C/div%3E#END_EDITABLE#%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%20200px;%0A%20%20%20%20top:%20300px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#BEGIN_EDITABLE#.block%20%7B%7D#END_EDITABLE###CSS_E####JS####JS_E####CODE_11E####LOGIC_11####HTML##//%20Expectation:%0Apass.if.html.editable(0).equivalent(%60%3Cdiv%20class=%22block%22%3E%3C/div%3E%60);%0Apass.if.html.editable(1).equivalent(%60%3Cdiv%20class=%22block%22%3E%3C/div%3E%60);%0Apass.if.html.editable(2).equivalent(%60%3Cdiv%20class=%22block%22%3E%3C/div%3E%60);##HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60.block%20%7B%7D%60);##CSS_E####JS####JS_E####LOGIC_11E####STEP_11E####STEP_12####INST_12##Terrain%20block%20image%0A%0ASimilar%20to%20the%20*#player*%20element,%20we%20need%20to%20also%20give%20the%20*.block*%20elements%20a%20size%20and%20a%20background%20image.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#css#width%5D%0A%09(*)%5B#css#height%5D%0A%09(*)%5B#css#background-image%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+css#.block#+1,%20make%20*.block*%20elements%20*64%20pixels*%20wide.%0A%0A(!)On%20+css#.block#+2,%20make%20*.block*%20elements%20*64%20pixels*%20tall.%0A%0A(!)On%20+css#.block#+3,%20use%20the%20following%20image%20as%20background%20image%20for%20*.block*%20elements.%0A(*)https://app.bsd.education/resources/floor.png%0A%5Bimg::https://app.bsd.education/resources/floor.png%5D##INST_12E####CODE_12####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%3C/body%3E%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%20200px;%0A%20%20%20%20top:%20300px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20#BEGIN_EDITABLE#width:%2064px;#END_EDITABLE#%0A%20%20%20%20#BEGIN_EDITABLE#height:%2064px;#END_EDITABLE#%0A%20%20%20%20#BEGIN_EDITABLE#background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);#END_EDITABLE#%0A%7D##CSS_E####JS####JS_E####CODE_12E####LOGIC_12####HTML####HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60width:%2064px;%60);%0Apass.if.css.editable(1).equivalent(%60height:%2064px;%60);%0Apass.if.css.editable(2).equivalent(%60background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%60);##CSS_E####JS####JS_E####LOGIC_12E####STEP_12E####STEP_13####INST_13##Terrain%20block%20ID%20names%0A%0AAlthough%20we%20only%20have%203%20blocks%20now%20and%20it's%20easy%20to%20keep%20track%20which%20is%20which,%20the%20game%20will%20need%20a%20lot%20more%20blocks%20to%20be%20interesting.%0A%0AAnd%20to%20keep%20track%20of%20all%20the%20blocks%20and%20be%20able%20to%20position%20each%20of%20them%20at%20the%20correct%20place,%20they%20will%20each%20need%20a%20unique%20ID%20name.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#html#id%5D%0A%09(*)%5B#css#rule%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+html#scene#+2,%20html#scene#+3%20&%20html#scene#+4,%20add%20three%20%60id%60%20attributes%20and%20set%20them%20to%20*floor1*,%20*floor2*%20and%20*floor3*.%0A%0A(%3E%3Estyle.css)%0A%0A(!)On%20+css#bottom#+3,%20css#bottom#+5%20&%20css#bottom#+7,%20create%20three%20empty%20rules%20for%20*#floor1*,%20*#floor2*%20and%20*#floor3*.##INST_13E####CODE_13####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20#BEGIN_EDITABLE#id=%22floor1%22#END_EDITABLE#%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20#BEGIN_EDITABLE#id=%22floor2%22#END_EDITABLE#%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20#BEGIN_EDITABLE#id=%22floor3%22#END_EDITABLE#%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%20200px;%0A%20%20%20%20top:%20300px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#BEGIN_EDITABLE##floor1%20%7B%7D#END_EDITABLE#%0A%0A#BEGIN_EDITABLE##floor2%20%7B%7D#END_EDITABLE#%0A%0A#BEGIN_EDITABLE##floor3%20%7B%7D#END_EDITABLE#%0A%0A.block%20%7B%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%7D##CSS_E####JS####JS_E####CODE_13E####LOGIC_13####HTML##//%20Expectation:%0Apass.if.html.editable(0).equivalent(%60id=%22floor1%22%60);%0Apass.if.html.editable(1).equivalent(%60id=%22floor2%22%60);%0Apass.if.html.editable(2).equivalent(%60id=%22floor3%22%60);##HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60#floor1%20%7B%7D%60);%0Apass.if.css.editable(1).equivalent(%60#floor2%20%7B%7D%60);%0Apass.if.css.editable(2).equivalent(%60#floor3%20%7B%7D%60);##CSS_E####JS####JS_E####LOGIC_13E####STEP_13E####STEP_14####INST_14##Terrain%20block%20positioning%20-%201/2%0A%0ARight%20now%20the%20blocks%20are%20all%20stacked%20together%20at%20the%20bottom%20left,%20we%20need%20to%20be%20able%20to%20position%20them%20around%20the%20scene,%20so%20that%20with%20enough%20blocks,%20a%20level%20can%20be%20created.%0A%0AFirst%20let's%20try%20moving%20*#floor3*%20to%20the%20position%20indicated%20by%20the%20image%20below:%0A%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_block_position.png%5D%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#css#position%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+css#.block#+1,%20set%20the%20%60position%60%20property%20to%20*absolute*.%0A%0A(!)On%20+css#%5C#floor3#+1,%20place%20the%20*#floor3*%20element%20*192%20pixels*%20away%20from%20the%20left%20edge%20of%20*#scene*.%0A%0A(!)On%20+css#%5C#floor3#+2,%20place%20the%20*#floor3*%20element%20*64%20pixels*%20above%20the%20bottom%20edge%20of%20*#scene*.##INST_14E####CODE_14####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%3C/body%3E%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%20200px;%0A%20%20%20%20top:%20300px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor1%20%7B%7D%0A%0A#floor2%20%7B%7D%0A%0A#floor3%20%7B%0A%20%20%20%20#BEGIN_EDITABLE#left:%20192px;#END_EDITABLE#%0A%20%20%20%20#BEGIN_EDITABLE#bottom:%2064px;#END_EDITABLE#%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20#BEGIN_EDITABLE#position:%20absolute;#END_EDITABLE#%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%7D##CSS_E####JS####JS_E####CODE_14E####LOGIC_14####HTML####HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60left:%20192px;%60);%0Apass.if.css.editable(1).equivalent(%60bottom:%2064px;%60);%0Apass.if.css.editable(2).equivalent(%60position:%20absolute;%60);##CSS_E####JS####JS_E####LOGIC_14E####STEP_14E####STEP_15####INST_15##Terrain%20block%20positioning%20-%202/2%0A%0ALet's%20also%20move%20the%20other%202%20blocks.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#css#position%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+css#%5C#floor1#+1,%20place%20the%20*#floor1*%20element%20*128%20pixels*%20away%20from%20the%20left%20edge%20of%20*#scene*.%0A%0A(!)On%20+css#%5C#floor2#+1,%20place%20the%20*#floor2*%20element%20*192%20pixels*%20away%20from%20the%20left%20edge%20of%20*#scene*.%0A%0A(!)On%20+css#%5C#floor1#+2%20&%20css#%5C#floor2#+2,%20place%20the%20*#floor1*%20and%20*#floor2*%20elements%20*0*%20units%20above%20the%20bottom%20edge%20of%20*#scene*.##INST_15E####CODE_15####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%20200px;%0A%20%20%20%20top:%20300px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20#BEGIN_EDITABLE#left:%20128px;#END_EDITABLE#%0A%20%20%20%20#BEGIN_EDITABLE#bottom:%200;#END_EDITABLE#%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20#BEGIN_EDITABLE#left:%20192px;#END_EDITABLE#%0A%20%20%20%20#BEGIN_EDITABLE#bottom:%200;#END_EDITABLE#%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%7D##CSS_E####JS####JS_E####CODE_15E####LOGIC_15####HTML####HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60left:%20128px;%60);%0Apass.if.css.editable(1).equivalent(%60bottom:%200;%60).or(%60bottom:%200px%60);%0Apass.if.css.editable(2).equivalent(%60left:%20192px;%60);%0Apass.if.css.editable(3).equivalent(%60bottom:%200;%60).or(%60bottom:%200px%60);##CSS_E####JS####JS_E####LOGIC_15E####STEP_15E####STEP_16####INST_16##Top%20block%20class%0A%0ASimilar%20to%20how%20the%20*#player*%20element%20can%20display%20a%20different%20image%20depending%20on%20its%20class%20name,%20we%20can%20do%20the%20same%20to%20the%20blocks%20so%20that%20the%20first%20block%20in%20a%20column%20will%20show%20a%20different%20image%20with%20grass%20on%20top.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#html#class%5D%0A%09(*)%5B#css#rule%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+html#scene#+2%20&%20html#scene#+4,%20add%20*top*%20as%20the%20second%20class%20name%20for%20*#floor1*%20and%20*#floor3*.%0A%0A(%3E%3Estyle.css)%0A%0A(!)On%20+css#floor.png#+3,%20create%20an%20empty%20rule%20for%20*.top*.##INST_16E####CODE_16####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20#BEGIN_EDITABLE#class=%22block%22#END_EDITABLE#%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20#BEGIN_EDITABLE#class=%22block%22#END_EDITABLE#%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%20200px;%0A%20%20%20%20top:%20300px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%7D%0A%0A#BEGIN_EDITABLE#.top%20%7B%7D#END_EDITABLE#%0A##CSS_E####JS####JS_E####CODE_16E####LOGIC_16####HTML##//%20Expectation:%0Apass.if.html.editable(0).equivalent(%60class=%22block%20top%22%60);%0Apass.if.html.editable(1).equivalent(%60class=%22block%20top%22%60);##HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60.top%20%7B%7D%60);##CSS_E####JS####JS_E####LOGIC_16E####STEP_16E####STEP_17####INST_17##Top%20block%20image%0A%0AThe%20top%20block%20will%20need%20a%20different%20image%20-%20one%20with%20grass%20on%20top.%0A%0ALet's%20add%20that%20in%20now.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#css#background-image%5D%0A%09(*)%5B#css#background-size%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+css#.top#+1,%20use%20the%20following%20image%20as%20background%20image%20for%20the%20*.top*%20elements.%0A(*)https://app.bsd.education/resources/top_floor.png%0A%5Bimg::https://app.bsd.education/resources/top_floor.png%5D%0A%0A(!)On%20+css#.top#-3,%20resize%20the%20background%20image%20to%20be%20contained%20within%20the%20*.block*%20elements.##INST_17E####CODE_17####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%3C/body%3E%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%20200px;%0A%20%20%20%20top:%20300px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20#BEGIN_EDITABLE#background-size:%20contain;#END_EDITABLE#%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20#BEGIN_EDITABLE#background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);#END_EDITABLE#%0A%7D##CSS_E####JS####JS_E####CODE_17E####LOGIC_17####HTML####HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60background-size:%20contain;%60);%0Apass.if.css.editable(1).equivalent(%60background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%60);##CSS_E####JS####JS_E####LOGIC_17E####STEP_17E####STEP_18####INST_18##Styling%20in%20JavaScript%20-%201/3%0A%0AWell%20done!%20you%20have%20finished%20building%20all%20the%20game%20assets%20that%20the%20game%20needs%20to%20have.%0A%0ANow%20we%20will%20begin%20to%20work%20with%20JavaScript,%20so%20that%20our%20game%20can%20become%20interactive%20and%20playable.%0A%0AThe%20first%20thing%20we%20need%20to%20do%20is%20to%20link%20the%20JS%20file%20in%20our%20HTML%20document,%20and%20then%20we'll%20create%20a%20variable%20to%20store%20the%20*#player*%20element.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#html#%3Cscript%3E%5D%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#querySelector%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+html#/body#-1,%20create%20a%20%60%3Cscript%3E%60%20element%20and%20set%20the%20%60src%60%20attribute%20to%20*script.js*.%0A(%3E%3Escript.js)%0A%0A(!)On%20+js#JavaScript#+1,%20create%20a%20variable%20called%20*player*%20to%20store%20the%20*#player*%20element.%0A(*)*Tip*:%20use%20the%20%60document.querySelector()%60%20syntax##INST_18E####CODE_18####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20#BEGIN_EDITABLE#%3Cscript%20src=%22script.js%22%3E%3C/script%3E#END_EDITABLE#%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%20200px;%0A%20%20%20%20top:%20300px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D#BEGIN_EDITABLE##END_EDITABLE###CSS_E####JS##//%20%20JavaScript%0D%0A#BEGIN_EDITABLE#var%20player%20=%20document.querySelector(%22#player%22);#END_EDITABLE#%0D%0A##JS_E####CODE_18E####LOGIC_18####HTML##//%20Expectation:%0Apass.if.html.editable(0).equivalent(%60%3Cscript%20src=%22script.js%22%3E%3C/script%3E%60);##HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20player%20=%20document.querySelector(%22#player%22);%60);##JS_E####LOGIC_18E####STEP_18E####STEP_19####INST_19##Styling%20in%20JavaScript%20-%202/3%0A%0ANow%20the%20*#player*%20element%20is%20stored%20in%20the%20variable%20*player*,%20we%20can%20do%20some%20styling%20for%20it%20in%20JavaScript%20using%20the%20%60.style%60%20syntax.%0A%0AWe%20will%20remove%20the%20%60left%60%20CSS%20property%20from%20the%20player%20and%20add%20it%20in%20JavaScript%20instead,%20for%20that%20we'll%20also%20need%20to%20create%20a%20variable%20to%20store%20the%20left%20position.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#style%5D%0A%09(*)%5B#js#arithmetic%20operators%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+css#%5C#player#+2,%20remove%20the%20%60left%60%20%20property%20and%20value.%0A%0A(%3E%3Escript.js)%0A%0A(!)On%20+js#%5C#player#+1,%20create%20a%20variable%20called%20*playerLeft*%20to%20store%20the%20number%20*200*.%0A%0A(!)On%20+js#initial#+1,%20use%20the%20value%20of%20*playerLeft*%20as%20the%20*left*%20position%20for%20the%20*player*%20element.%0A(*)*Tip*:%20use%20the%20%60.style%60%20syntax##INST_19E####CODE_19####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20#BEGIN_EDITABLE#left:%20200px;#END_EDITABLE#%0A%20%20%20%20top:%20300px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20JavaScript%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0A#BEGIN_EDITABLE#var%20playerLeft%20=%20200;#END_EDITABLE#%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0A#BEGIN_EDITABLE#player.style.left%20=%20playerLeft%20+%20%22px%22;#END_EDITABLE#%0D%0A##JS_E####CODE_19E####LOGIC_19####HTML####HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60%60);##CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20playerLeft%20=%20200;%60);%0Apass.if.js.editable(1).equivalent(%60player.style.left%20=%20playerLeft%20+%20%22px%22;%60);##JS_E####LOGIC_19E####STEP_19E####STEP_20####INST_20##Styling%20in%20JavaScript%20-%203/3%0A%0AIt%20is%20a%20little%20more%20complicated%20for%20the%20top%20position,%20because%20the%20character%20can%20jump%20and%20fall%20(%20therefore%20the%20top%20position%20changes%20),%20we%20don't%20want%20the%20CSS%20to%20visibly%20affect%20the%20top%20position.%0A%0ASo%20we%20will%20set%20the%20%60top%60%20CSS%20property%20to%20a%20negative%20value%20and%20do%20the%20properly%20positioning%20in%20JavaScript.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#style%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+css#%5C#player#+2,%20set%20the%20%60top%60%20property%20to%20*-100px*.%0A%0A(%3E%3Escript.js)%0A%0A(!)On%20+js#JavaScript#+2,%20create%20a%20variable%20called%20*playerTop*%20to%20store%20the%20number%20*300*.%0A%0A(!)On%20+js#initial#+1,%20use%20the%20value%20of%20*playerTop*%20as%20the%20*top*%20position%20for%20the%20*player*%20element.##INST_20E####CODE_20####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20#BEGIN_EDITABLE#top:%20300px;#END_EDITABLE#%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20JavaScript%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0A#BEGIN_EDITABLE#var%20playerTop%20=%20300;#END_EDITABLE#%0D%0Avar%20playerLeft%20=%20200;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0A#BEGIN_EDITABLE#player.style.top%20=%20playerTop%20+%20%22px%22;#END_EDITABLE#%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A##JS_E####CODE_20E####LOGIC_20####HTML####HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60top:%20-100px;%60);##CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20playerTop%20=%20300;%60);%0Apass.if.js.editable(1).equivalent(%60player.style.top%20=%20playerTop%20+%20%22px%22;%60);##JS_E####LOGIC_20E####STEP_20E####STEP_21####INST_21##Gravity%20-%201/3%0A%0AWe%20have%20added%20some%20JavaScript%20code,%20namely%20the%20*gameLoop*%20and%20*actionPerFrame*%20functions.%0A%0A(*)The%20*gameLoop*%20function%20is%20called%20once%20(%20+js#gameLoop();#%20)%20and%20then%20it%20calls%20itself%20(%20+js#call%20gameLoop#+1%20),%20this%20creates%20an%20infinite%20loop.%0A(*)The%20code%20inside%20the%20*gameLoop*%20function%20does%20its%20best%20to%20call%20the%20*actionPerFrame*%20function%2030%20times%20per%20second%20(%20defined%20by%20the%20variable%20*maxFPS*%20at%20+js#var%20maxFPS#%20).%0A%0AThere%20are%20many%20things%20we%20need%20to%20do%20at%20every%20frame%20for%20the%20game%20to%20work%20correctly.%0A%0AFirst%20we%20need%20to%20simulate%20free-fall%20under%20the%20effect%20of%20gravity,%20we%20will%20create%20a%20function%20for%20this%20first%20and%20fill%20in%20the%20code%20later.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#function%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#Frame()#+1,%20call%20the%20*animateFreefall*%20function.%0A%0A(!)On%20+js#Frame()#+4,%20create%20a%20function%20called%20*animateFreefall*.##INST_21E####CODE_21####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D#BEGIN_EDITABLE##END_EDITABLE###CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.top%20=%20playerTop%20+%20%22px%22;%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20#BEGIN_EDITABLE#animateFreefall();#END_EDITABLE#%0D%0A%7D%0D%0A%0D%0A#BEGIN_EDITABLE#function%20animateFreefall()%20%7B%7D#END_EDITABLE#%0D%0A##JS_E####CODE_21E####LOGIC_21####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60animateFreefall();%60);%0Apass.if.js.editable(1).equivalent(%60function%20animateFreefall()%20%7B%7D%60);##JS_E####LOGIC_21E####STEP_21E####STEP_22####INST_22##Gravity%20-%202/3%0A%0ATo%20make%20the%20character%20fall%20under%20the%20effect%20of%20gravity,%20we%20will%20need%202%20more%20variables%20-%20one%20for%20the%20number%20of%20pixels%20the%20character%20will%20move%20every%20frame%20and%20a%20maximum%20speed%20that%20the%20character%20can%20reach.%0A%0AAnd%20in%20the%20*animateFreefall*%20function,%20we%20will%20increase%20the%20speed%20once%20every%20frame,%20this%20is%20reflected%20in%20the%20real%20world%20where%20things%20fall%20at%20an%20increasing%20speed.%20But%20we'll%20only%20increase%20the%20speed%20if%20it's%20smaller%20than%20the%20maximum%20speed.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#if%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#freefall#+1,%20create%20a%20variable%20called%20*pixelPerFrame*%20to%20store%20the%20number%20*0*.%0A%0A(!)On%20+js#freefall#+2,%20create%20a%20variable%20called%20*maxPixelPerFrame*%20to%20store%20the%20number%20*12*.%0A%0A(!)On%20+js#reached#+1,%20create%20an%20%60if%60%20statement%20to%20check%20whether%20*pixelPerFrame*%20is%20smaller%20than%20*maxPixelPerFrame*.##INST_22E####CODE_22####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0A#BEGIN_EDITABLE#var%20pixelPerFrame%20=%200;#END_EDITABLE#%0D%0A#BEGIN_EDITABLE#var%20maxPixelPerFrame%20=%2012;#END_EDITABLE#%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.top%20=%20playerTop%20+%20%22px%22;%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20#BEGIN_EDITABLE#if%20(pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%7D#END_EDITABLE#%0D%0A%7D%0D%0A##JS_E####CODE_22E####LOGIC_22####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20pixelPerFrame%20=%200;%60);%0Apass.if.js.editable(1).equivalent(%60var%20maxPixelPerFrame%20=%2012;%60);%0Apass.if.js.editable(2).equivalent(%60if%20(pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%7D%60);##JS_E####LOGIC_22E####STEP_22E####STEP_23####INST_23##Gravity%20-%203/3%0A%0AInside%20the%20conditional%20statement,%20we%20can%20increase%20the%20value%20of%20*pixelPerFrame*%20by%20a%20fixed%20amount,%20we%20will%20call%20this%20increment%20*gravity*.%0A%0AAs%20the%20last%20thing%20in%20the%20*animateFreefall*%20function,%20we%20can%20add%20the%20value%20of%20*pixelPerFrame*%20to%20*playerTop*.%0A%0AAnd%20finally,%20we%20can%20use%20*playerTop*%20to%20set%20the%20%60left%60%20CSS%20property%20for%20the%20player%20element.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#style%5D%0A%09(*)%5B#js#arithmetic%20operators%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#12#-2,%20create%20a%20variable%20called%20*gravity*%20to%20store%20the%20number%20*2*.%0A%0A(!)On%20+js#falling#+1,%20increase%20*pixelPerFrame*%20by%20the%20value%20of%20*gravity*.%0A%0A(!)On%20+js#modify#+1,%20increase%20*playerTop*%20by%20the%20value%20of%20*pixelPerFrame*.%0A%0A(!)On%20+js#reached#-4,%20use%20the%20value%20of%20*playerTop*%20as%20the%20*top*%20position%20for%20the%20*player*%20element.##INST_23E####CODE_23####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0A#BEGIN_EDITABLE#var%20gravity%20=%202;#END_EDITABLE#%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.top%20=%20playerTop%20+%20%22px%22;%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20#BEGIN_EDITABLE#player.style.top%20=%20playerTop%20+%20%22px%22;#END_EDITABLE#%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#pixelPerFrame%20+=%20gravity;#END_EDITABLE#%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20#BEGIN_EDITABLE#playerTop%20+=%20pixelPerFrame;#END_EDITABLE#%0D%0A%7D%0D%0A##JS_E####CODE_23E####LOGIC_23####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20gravity%20=%202;%60);%0Apass.if.js.editable(1).equivalent(%60player.style.top%20=%20playerTop%20+%20%22px%22;%60);%0Apass.if.js.editable(2).equivalent(%60pixelPerFrame%20+=%20gravity;%60);%0Apass.if.js.editable(3).equivalent(%60playerTop%20+=%20pixelPerFrame;%60);##JS_E####LOGIC_23E####STEP_23E####STEP_24####INST_24##Collision%20-%201/4%0A%0AWe've%20successfully%20simulated%20gravity%20in%20our%20mini%20game!%20However%20this%20introduces%20another%20problem%20for%20us%20to%20solve:%20*collision*.%0A%0AWe%20have%20created%20the%20*detectGroundCollision*%20function,%20this%20function%20will%20need%20to%20be%20called%20once%20every%20frame.%20And%20in%20it%20we%20need%20to%20determine%20the%20minimum%20and%20maximum%20left%20position%20of%20a%20block%20for%20it%20to%20be%20underneath%20the%20character.%0A%0A(*)In%20*detectGroundCollision*,%20all%20the%20ground%20blocks%20are%20stored%20in%20the%20variable%20called%20*blocks*%20as%20an%20*array*%20(%20+js#var%20blocks#%20),%20and%20the%20*forEach*%20function%20allows%20us%20to%20write%20code%20that%20will%20run%20for%20each%20of%20the%20blocks.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#function%5D%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#arithmetic%20operators%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#on%20act#+2,%20call%20the%20*detectGroundCollision*%20function.%0A%0A(!)On%20+js#=%3E#+3,%20create%20a%20variable%20called%20*minLeft*%20to%20store%20the%20minimum%20left%20position%20of%20a%20block%20that%20can%20collide%20with%20the%20player.%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_minLeft.png%5D%0A(!)On%20+js#=%3E#+4,%20create%20a%20variable%20called%20*maxLeft*%20to%20store%20the%20maximum%20left%20position%20of%20a%20block%20that%20can%20collide%20with%20the%20player.%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_maxLeft.png%5D##INST_24E####CODE_24####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0A%0D%0A//%20%20%20width%20&%20height%20of%20each%20block%0D%0Avar%20blockSize%20=%2064;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20#BEGIN_EDITABLE#detectGroundCollision();#END_EDITABLE#%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#var%20minLeft%20=%20playerLeft%20-%20blockSize;#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#var%20maxLeft%20=%20playerLeft%20+%20playerWidth;#END_EDITABLE#%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A##JS_E####CODE_24E####LOGIC_24####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60detectGroundCollision();%60);%0Apass.if.js.editable(1).equivalent(%60var%20minLeft%20=%20playerLeft%20-%20blockSize;%60);%0Apass.if.js.editable(2).equivalent(%60var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%60);##JS_E####LOGIC_24E####STEP_24E####STEP_25####INST_25##Collision%20-%202/4%0A%0AOnce%20we%20have%20the%20minimum%20and%20maximum%20left%20positions,%20we%20can%20then%20compare%20it%20with%20every%20block%20and%20check%20if%20the%20block%20is%20within%20that%20range.%0A%0ATo%20do%20this%20we%20will%20need%20to%20use%20*conditional%20statements*%20and%20*relational%20operators*.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#if%5D%0A%09(*)%5B#js#relational%20operators%5D%0A%09(*)%5B#js#logic%20operators%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#var%20blockLeft#+3,%20create%20an%20%60if%60%20statement%20to%20check%20whether%20*blockLeft*%20is%20smaller%20than%20*maxLeft*%20and%20greater%20than%20*minLeft*.%0A(*)*Tip*:%20use%20the%20%60&&%60%20logic%20operator##INST_25E####CODE_25####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0A%0D%0A//%20%20%20width%20&%20height%20of%20each%20block%0D%0Avar%20blockSize%20=%2064;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%7D#END_EDITABLE#%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A##JS_E####CODE_25E####LOGIC_25####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%7D%60).or(%60if%20(blockLeft%20%3E%20minLeft%20&&%20blockLeft%20%3C%20maxLeft)%20%7B%7D%60);##JS_E####LOGIC_25E####STEP_25E####STEP_26####INST_26##Collision%20-%203/4%0A%0AAll%20the%20blocks%20that%20pass%20the%20check%20on%20+js#var%20blockTop#-1,%20we%20know%20they%20are%20directly%20under%20our%20character.%0A%0AInside%20the%20%60if%60%20statement,%20we%20then%20need%20to%20calculate%20the%20*character's%20maximum%20top%20position*%20before%20it%20collides%20with%20each%20of%20the%20blocks%20mentioned%20above.%0A%0AAnd%20if%20the%20player's%20actual%20top%20position%20(%20stored%20in%20variable%20*playerTop*%20)%20is%20greater%20than%20that%20value,%20we%20know%20it%20has%20collided%20with%20a%20block.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#arithmetic%20operators%5D%0A%09(*)%5B#js#if%5D%0A%09(*)%5B#js#relational%20operators%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#collides#+1,%20create%20a%20variable%20called%20*maxTop*%20to%20store%20the%20maximum%20top%20position%20for%20the%20player%20without%20colliding%20with%20a%20block.%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_maxTop.png%5D%0A%0A(!)On%20+js#collides#+3,%20create%20an%20%60if%60%20statement%20to%20check%20whether%20*playerTop*%20is%20greater%20than%20or%20equal%20to%20*maxTop*.%0A(*)*Tip*:%20avoid%20using%20the%20%60%7C%7C%60%20logic%20operator.##INST_26E####CODE_26####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0A%0D%0A//%20%20%20width%20&%20height%20of%20each%20block%0D%0Avar%20blockSize%20=%2064;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#var%20maxTop%20=%20blockTop%20-%20playerHeight;#END_EDITABLE#%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#if%20(playerTop%20%3E=%20maxTop)%20%7B%7D#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A##JS_E####CODE_26E####LOGIC_26####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20maxTop%20=%20blockTop%20-%20playerHeight;%60);%0Apass.if.js.editable(1).equivalent(%60if%20(playerTop%20%3E=%20maxTop)%20%7B%7D%60);##JS_E####LOGIC_26E####STEP_26E####STEP_27####INST_27##Collision%20-%204/4%0A%0AAfter%20we%20detect%20a%20collision,%20we%20need%20to%20stop%20the%20player%20from%20moving%20downward%20further.%0A%0ATo%20achieve%20this,%20we%20need%20to%20do%20two%20things:%0A%0A%5B-%0A%09(*)Make%20*playerTop*%20equal%20to%20*maxTop*.%0A%09(*)Change%20*pixelPerFrame*%20to%20*0*.%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#prevent#+1,%20assign%20the%20value%20of%20*maxTop*%20to%20*playerTop*.%0A%0A(!)On%20+js#stop#+1,%20assign%20the%20number%20*0*%20to%20*pixelPerFrame*.%0A(*)*Tip*:%20use%20the%20%60=%60%20sign%20to%20assign%20values.##INST_27E####CODE_27####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D#BEGIN_EDITABLE##END_EDITABLE###CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0A%0D%0A//%20%20%20width%20&%20height%20of%20each%20block%0D%0Avar%20blockSize%20=%2064;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#playerTop%20=%20maxTop;#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#pixelPerFrame%20=%200;#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A##JS_E####CODE_27E####LOGIC_27####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60playerTop%20=%20maxTop;%60);%0Apass.if.js.editable(1).equivalent(%60pixelPerFrame%20=%200;%60);##JS_E####LOGIC_27E####STEP_27E####STEP_28####INST_28##Jump%20Mechanic%20-%201/5%0A%0AOkay,%20now%20our%20character%20falls%20under%20gravity%20and%20stays%20on%20top%20of%20the%20blocks.%20Next%20we%20will%20make%20the%20character%20jump%20when%20the%20space%20bar%20is%20pressed.%0A%0AThis%20can%20be%20done%20using%20the%20one%20of%20the%20event%20listeners%20available%20in%20JavaScript.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#onkeydown%5D%0A%09(*)%5B#js#function%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#FUNC#-3,%20handle%20the%20%60window.onkeydown%60%20event%20using%20the%20*jump*%20function.%0A%0A(!)On%20+js#FUNC#+3,%20create%20a%20function%20called%20*jump*.##INST_28E####CODE_28####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0A%0D%0A//%20%20%20width%20&%20height%20of%20each%20block%0D%0Avar%20blockSize%20=%2064;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0A#BEGIN_EDITABLE#window.onkeydown%20=%20jump;#END_EDITABLE#%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0A#BEGIN_EDITABLE#function%20jump()%20%7B%7D#END_EDITABLE#%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A##JS_E####CODE_28E####LOGIC_28####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60window.onkeydown%20=%20jump;%60);%0Apass.if.js.editable(1).equivalent(%60function%20jump()%20%7B%7D%60);##JS_E####LOGIC_28E####STEP_28E####STEP_29####INST_29##Jump%20Mechanic%20-%202/5%0A%0AEvent%20handling%20works%20by%20calling%20a%20provided%20function%20every%20time%20the%20specified%20event%20is%20detected.%0A%0AIn%20our%20case,%20every%20time%20we%20*press%20any%20key*%20on%20the%20keyboard%20(%20hence%20*onkeydown*%20),%20the%20function%20*jump*%20will%20run.%0A%0ATherefore%20in%20the%20*jump*%20function,%20we%20need%20to%20know%20a%20bit%20more%20about%20the%20*keydown*%20event%20(%20using%20the%20%60event.code%60%20syntax%20)%20and%20check%20whether%20they%20key%20is%20the%20space%20key.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#if%5D%0A%09(*)%5B#js#relational%20operators%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#on%20jump#+1,%20create%20an%20%60if%60%20statement%20to%20check%20whether%20%60event.code%60%20is%20equal%20to%20*%22Space%22*.##INST_29E####CODE_29####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0A%0D%0A//%20%20%20width%20&%20height%20of%20each%20block%0D%0Avar%20blockSize%20=%2064;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20#BEGIN_EDITABLE#if%20(event.code%20==%20%22Space%22)%20%7B%7D#END_EDITABLE#%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A##JS_E####CODE_29E####LOGIC_29####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60if%20(event.code%20==%20%22Space%22)%20%7B%7D%60);##JS_E####LOGIC_29E####STEP_29E####STEP_30####INST_30##Jump%20Mechanic%20-%203/5%0A%0AIf%20a%20positive%20*pixelPerFrame*%20value%20makes%20our%20character%20fall,%20then%20a%20negative%20value%20will%20make%20it%20go%20up.%0A%0ATo%20control%20how%20much%20the%20character%20can%20jump,%20we%20will%20make%20a%20variable,%20and%20then%20*subtract*%20it%20from%20the%20*pixelPerFrame*%20value.%0A%0AIn%20addition,%20remember%20the%20*.jump*%20rule%20we%20created%20which%20displays%20the%20background%20image%20of%20our%20character%20jumping?%20Now%20it's%20the%20time%20to%20use%20it.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#arithmetic%20operators%5D%0A%09(*)%5B#js#className%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#12#-2,%20create%20a%20variable%20called%20*jumpPower*%20to%20store%20the%20number%20*24*.%0A%0A(!)On%20+js#.code#+1,%20decrease%20*pixelPerFrame*%20by%20the%20value%20of%20*jumpPower*.%0A%0A(!)On%20+js#.code#+2,%20change%20the%20class%20name%20of%20the%20*player*%20element%20to%20*jump*.%0A%0A(!)On%20+js#vis#-2,%20change%20the%20class%20name%20of%20the%20*player*%20element%20to%20*run*.%0A(*)Since%20we%20already%20wrote%20the%20code%20to%20detect%20collision,%20we%20can%20simply%20set%20the%20class%20name%20back%20to%20*run*%20here.##INST_30E####CODE_30####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0A#BEGIN_EDITABLE#var%20jumpPower%20=%2024;#END_EDITABLE#%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0A%0D%0A//%20%20%20width%20&%20height%20of%20each%20block%0D%0Avar%20blockSize%20=%2064;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#pixelPerFrame%20-=%20jumpPower;#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#player.className%20=%20%22jump%22;#END_EDITABLE#%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#player.className%20=%20%22run%22;#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A##JS_E####CODE_30E####LOGIC_30####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20jumpPower%20=%2024;%60);%0Apass.if.js.editable(1).equivalent(%60pixelPerFrame%20-=%20jumpPower;%60).or(%60pixelPerFrame%20=%20pixelPerFrame%20-%20jumpPower;%60);%0Apass.if.js.editable(2).equivalent(%60player.className%20=%20%22jump%22;%60);%0Apass.if.js.editable(3).equivalent(%60player.className%20=%20%22run%22;%60);##JS_E####LOGIC_30E####STEP_30E####STEP_31####INST_31##Jump%20Mechanic%20-%204/5%0A%0ATry%20pressing%20space%20bar%20many%20times%20quickly,%20you%20will%20see%20the%20character%20can%20actually%20keep%20moving%20upward.%0A%0AWhile%20this%20may%20be%20fun%20for%20a%20while,%20allowing%20players%20to%20do%20so%20takes%20the%20fun%20out%20of%20the%20game%20because%20it%20will%20no%20longer%20be%20challenging.%0A%0ASo%20we%20will%20need%20to%20keep%20track%20of%20whether%20or%20not%20the%20character%20is%20already%20in%20the%20air%20before%20allowing%20it%20to%20jump.%0A%0AFirst%20we%20create%202%20variables.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#variable%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#%5C#player#+5,%20create%20a%20variable%20called%20*playerInAir*%20to%20store%20the%20Boolean%20*true*.%0A%0A(!)On%20+js#assume#+1,%20create%20a%20variable%20called%20*noCollision*%20to%20store%20the%20Boolean%20*true*.##INST_31E####CODE_31####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0A#BEGIN_EDITABLE#var%20playerInAir%20=%20true;#END_EDITABLE#%0D%0A%0D%0A//%20%20%20width%20&%20height%20of%20each%20block%0D%0Avar%20blockSize%20=%2064;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20#BEGIN_EDITABLE#var%20noCollision%20=%20true;#END_EDITABLE#%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A##JS_E####CODE_31E####LOGIC_31####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20playerInAir%20=%20true;%60);%0Apass.if.js.editable(1).equivalent(%60var%20noCollision%20=%20true;%60);##JS_E####LOGIC_31E####STEP_31E####STEP_32####INST_32##Jump%20Mechanic%20-%205/5%0A%0AIn%20the%20*detectGroundCollision*%20function,%20which%20runs%20every%20frame,%20we%20start%20off%20with%20*noCollision*%20set%20to%20*true*.%20We%20need%20to%20change%20it%20to%20*false*%20if%20the%20character%20collides%20with%20any%20block,%20so%20that%20*playerInAir*%20can%20take%20its%20value%20at%20the%20end%20of%20the%20function.%0A%0AThen,%20we%20will%20just%20add%20*playerInAir*%20as%20another%20condition%20to%20check%20in%20addition%20to%20%60event.code%20==%20%22Space%22%60%20when%20deciding%20whether%20to%20allow%20the%20character%20to%20jump.%0A%0AThis%20will%20prevent%20the%20player%20from%20jumping%20while%20in%20the%20air.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#relational%20operators%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#stop#+2,%20assign%20the%20Boolean%20*false*%20to%20*noCollision*.%0A%0A(!)On%20+js#black#+5,%20assign%20the%20value%20of%20*noCollision*%20to%20*playerInAir*.%0A%0A(!)On%20+js#on%20jump#+1,%20add%20the%20condition%20to%20check%20if%20*playerInAir*%20is%20equal%20to%20*false*.##INST_32E####CODE_32####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor1%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22floor3%22%20class=%22block%20top%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0A%0D%0A//%20%20%20width%20&%20height%20of%20each%20block%0D%0Avar%20blockSize%20=%2064;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(#BEGIN_EDITABLE#playerInAir%20===%20false#END_EDITABLE#%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#noCollision%20=%20false;#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20#BEGIN_EDITABLE#playerInAir%20=%20noCollision;#END_EDITABLE#%0D%0A%7D%0D%0A##JS_E####CODE_32E####LOGIC_32####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60playerInAir%20===%20false%60).or(%60playerInAir%20==%20false%60).or(%60!playerInAir%60);%0Apass.if.js.editable(1).equivalent(%60noCollision%20=%20false;%60);%0Apass.if.js.editable(2).equivalent(%60playerInAir%20=%20noCollision;%60);##JS_E####LOGIC_32E####STEP_32E####STEP_33####INST_33##Terrain%20generator%20-%201/4%0A%0AOur%20game%20is%20basically%20working%20now,%20the%20only%20missing%20mechanic%20is%20to%20move%20the%20*terranContainer*%20that%20holds%20all%20the%20blocks%20to%20the%20left,%20so%20our%20character%20appears%20to%20be%20going%20forward.%0A%0AHowever,%20we%20need%20to%20add%20many%20more%20blocks%20before%20we%20animate%20them,%20so%20the%20character%20has%20enough%20ground%20to%20cover.%0A%0AWe%20could%20add%20more%20%60%3Cdiv%3E%60%20elements,%20attach%20ID%20and%20class%20names%20and%20then%20style%20them%20in%20CSS,%20but%20there%20is%20a%20much%20more%20clever%20way%20-%20the%20*modular%20approach*.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#function%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+html#scene#+2,%20html#scene#+3%20&%20html#scene#+4,%20remove%20the%20three%20%60%3Cdiv%3E%60%20elements.%0A(%3E%3Escript.js)%0A%0A(!)On%20+js#start#-1,%20call%20the%20*generateTerrain*%20function.%0A%0A(!)On%20+js#on%20jump#-2,%20create%20a%20function%20called%20*generateTerrain*.##INST_33E####CODE_33####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#%3Cdiv%20id=%22floor1%22%20class=%22block%20top%22%3E%3C/div%3E#END_EDITABLE#%0A%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#%3Cdiv%20id=%22floor2%22%20class=%22block%22%3E%3C/div%3E#END_EDITABLE#%0A%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#%3Cdiv%20id=%22floor3%22%20class=%22block%20top%22%3E%3C/div%3E#END_EDITABLE#%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A#floor1%20%7B%0A%20%20%20%20left:%20128px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor2%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%200;%0A%7D%0A%0A#floor3%20%7B%0A%20%20%20%20left:%20192px;%0A%20%20%20%20bottom:%2064px;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0A%0D%0A//%20%20%20width%20&%20height%20of%20each%20block%0D%0Avar%20blockSize%20=%2064;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0A#BEGIN_EDITABLE#generateTerrain();#END_EDITABLE#%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0A#BEGIN_EDITABLE#function%20generateTerrain()%20%7B%7D#END_EDITABLE#%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A##JS_E####CODE_33E####LOGIC_33####HTML##//%20Expectation:%0Apass.if.html.editable(0).equivalent(%60%60);%0Apass.if.html.editable(1).equivalent(%60%60);%0Apass.if.html.editable(2).equivalent(%60%60);%0A//%20const%20el%20=%20code.html.text.split('%5Cn').splice(7,%205).join('%5Cn');%0A//%20code.html.editable%5B0%5D%20=%20el;%0A//%20pass.if.html.editable(0).equivalent(%60%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%60);##HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60generateTerrain();%60);%0Apass.if.js.editable(1).equivalent(%60function%20generateTerrain()%20%7B%7D%60);##JS_E####LOGIC_33E####STEP_33E####STEP_34####INST_34##Terrain%20generator%20-%202/4%0A%0ATo%20modularly%20create%20the%20terrain,%20we%20first%20need%20to%20represent%20any%20arrangement%20of%20blocks%20using%20an%20*array*,%20where%20each%20number%20in%20the%20array%20represents%20a%20column%20in%20the%20terrain,%20and%20the%20value%20of%20each%20number%20represents%20the%20number%20of%20blocks%20in%20that%20column.%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_terrain_array.png%5D%0A%0AThen,%20we%20can%20*iterate*%20through%20the%20array%20and%20determine%20the%20~horizontal~%20position%20of%20each%20column%20using%20*playerLeft*,%20*columnLeft*%20and%20*blockSize*.%0A%0A(*)To%20*iterate*%20through%20an%20array%20is%20to%20write%20some%20code%20that%20will%20run%20as%20many%20times%20as%20there%20are%20items%20in%20that%20array,%20this%20can%20be%20done%20using%20the%20%5B#js#forEach%5D%20syntax.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#array%5D%0A%09(*)%5B#js#arithmetic%20operators%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#initial#-2,%20create%20a%20variable%20called%20*terrain*%20to%20store%20the%20array%20*%5B2,%202,%201,%203%5D*.%0A%0A(!)On%20+js#Array#+2,%20create%20a%20variable%20called%20*columnLeft*%20to%20store%20the%20left%20position%20of%20all%20blocks%20in%20each%20column.%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_columnLeft.png%5D##INST_34E####CODE_34####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D#BEGIN_EDITABLE##END_EDITABLE###CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0A%0D%0A//%20%20%20width%20&%20height%20of%20each%20block%0D%0Avar%20blockSize%20=%2064;%0D%0A#BEGIN_EDITABLE#var%20terrain%20=%20%5B2,%202,%201,%203%5D;#END_EDITABLE#%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;#END_EDITABLE#%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A##JS_E####CODE_34E####LOGIC_34####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20terrain%20=%20%5B2,%202,%201,%203%5D;%60);%0Apass.if.js.editable(1).equivalent(%60var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%60).or(%60var%20columnLeft%20=%20playerLeft%20+%20blockSize%20*%20columnIndex;%60).or(%60var%20columnLeft%20=%20columnIndex%20*%20blockSize%20+%20playerLeft;%60).or(%60var%20columnLeft%20=%20blockSize%20*%20columnIndex%20+%20playerLeft;%60);##JS_E####LOGIC_34E####STEP_34E####STEP_35####INST_35##Terrain%20generator%20-%203/4%0A%0ANow%20we%20know%20the%20horizontal%20position%20of%20each%20column,%20we%20can%20focus%20on%20the%20blocks%20in%20each%20column%20(%20stored%20in%20a%20variable%20called%20*newBlocks*%20on%20+js#fill()#%20)%20and%20figure%20out%20their%20*vertical%20positions*.%0A%0AEach%20block%20is%20a%20certain%20distance%20away%20from%20the%20bottom%20edge%20of%20the%20scene,%20to%20calculate%20this%20distance,%20we%20can%20design%20a%20formula%20that%20uses:%0A%5B-%0A%09(*)*blockIndex*%20-%20its%20position%20in%20a%20column%0A%09(*)*columnSize*%20-%20the%20total%20size%20of%20the%20column%0A%09(*)*blockSize*%20-%20the%20size%20of%20each%20block%0A-%5D%0A%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_blockBottom.jpg%5D%0A%0AAnother%20thing%20we%20can%20do%20while%20positioning%20each%20block%20vertically,%20is%20to%20check%20if%20a%20particular%20block%20is%20the%20top%20block%20in%20a%20column%20(%20by%20checking%20if%20the%20*blockIndex*%20is%20zero%20),%20if%20so,%20we%20will%20add%20the%20class%20name%20*top*%20so%20it%20displays%20the%20correct%20background%20image.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#className%5D%0A%09(*)%5B#js#if%5D%0A%09(*)%5B#js#relational%20operators%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#append#+3,%20create%20a%20variable%20called%20*blockBottom*%20to%20store%20the%20bottom%20position%20of%20each%20block%20in%20the%20column.%0A%0A(!)On%20+js#first#-2,%20change%20the%20class%20name%20of%20the%20*newBlock*%20element%20to%20*block*.%0A%0A(!)On%20+js#first#+1,%20create%20an%20%60if%60%20statement%20to%20check%20whether%20*blockIndex*%20is%20equal%20to%20*0*.##INST_35E####CODE_35####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20border:%20dashed%201px%20black;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#newBlock.className%20=%20%22block%22;#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#if%20(blockIndex%20===%200)%20%7B%7D#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A##JS_E####CODE_35E####LOGIC_35####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%60).or(%60var%20blockBottom%20=%20blockSize%20*%20(columnSize%20-%20blockIndex%20-%201);%60);%0Apass.if.js.editable(1).equivalent(%60newBlock.className%20=%20%22block%22;%60);%0Apass.if.js.editable(2).equivalent(%60if%20(blockIndex%20===%200)%20%7B%7D%60).or(%60if%20(blockIndex%20==%200)%20%7B%7D%60).or(%60if%20(!blockIndex)%20%7B%7D%60);##JS_E####LOGIC_35E####STEP_35E####STEP_36####INST_36##Terrain%20generator%20-%204/4%0A%0AAnd%20lastly%20for%20the%20*generateTerrain*%20function,%20we%20will%20give%20all%20the%20blocks%20with%20an%20index%20of%200%20the%20correct%20class%20name.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#className%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#first#+2,%20change%20the%20class%20name%20of%20the%20*newBlock*%20element%20to%20*block%20top*.##INST_36E####CODE_36####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#newBlock.className%20=%20%22block%20top%22;#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A##JS_E####CODE_36E####LOGIC_36####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60newBlock.className%20=%20%22block%20top%22;%60);##JS_E####LOGIC_36E####STEP_36E####STEP_37####INST_37##Terrain%20animation%20-%201/3%0A%0AWe%20can%20now%20put%20more%20blocks%20into%20the%20game%20by%20editing%20the%20*terrain*%20array,%20however,%20we%20can't%20yet%20test%20our%20level%20because%20our%20character%20is%20still%20just%20standing%20in%20one%20place.%0A%0ATo%20make%20it%20look%20like%20our%20character%20is%20moving%20forward,%20we%20will%20move%20the%20terrain%20in%20the%20opposite%20direction.%0A%0AFirst%20we%20need%20to%20create%20the%20function%20that%20will%20animate%20the%20terrain%20and%20call%20it%20every%20frame.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#function%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#on%20act#+2,%20call%20the%20*animateTerrain*%20function.%0A%0A(!)On%20+js#modify#+4,%20create%20a%20function%20called%20*animateTerrain*.##INST_37E####CODE_37####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20#BEGIN_EDITABLE#animateTerrain();#END_EDITABLE#%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0A#BEGIN_EDITABLE#function%20animateTerrain()%20%7B%7D#END_EDITABLE#%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A##JS_E####CODE_37E####LOGIC_37####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60animateTerrain();%60);%0Apass.if.js.editable(1).equivalent(%60function%20animateTerrain()%20%7B%7D%60);##JS_E####LOGIC_37E####STEP_37E####STEP_38####INST_38##Terrain%20animation%20-%202/3%0A%0AWhen%20we%20generated%20the%20terrain,%20all%20the%20blocks%20were%20put%20inside%20the%20*terrainContainer*%20element%20(%20+js#add%20new#+1%20),%20this%20makes%20animating%20terrain%20much%20easier.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#arithmetic%20operators%5D%0A%09(*)%5B#js#style%5D%0A%09(*)%5B#js#string%20concatenation%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#2,%202#-2,%20create%20a%20variable%20called%20*terrainLeft*%20to%20store%20the%20number%20*0*.%0A%0A(!)On%20+js#2,%202#-1,%20create%20a%20variable%20called%20*terrainScroll*%20to%20store%20the%20number%20*3*.%0A%0A(!)On%20+js#modify#+5,%20decrease%20*terrainLeft*%20by%20the%20value%20of%20*terrainScroll*.%0A%0A(!)On%20+js#modify#+6,%20use%20the%20value%20of%20*terrainLeft*%20as%20the%20*left*%20position%20for%20the%20*terrainContainer*%20element.##INST_38E####CODE_38####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2064;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0A#BEGIN_EDITABLE#var%20terrainLeft%20=%200;#END_EDITABLE#%0D%0A#BEGIN_EDITABLE#var%20terrainScroll%20=%203;#END_EDITABLE#%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20animateTerrain();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20#BEGIN_EDITABLE#terrainLeft%20-=%20terrainScroll;#END_EDITABLE#%0D%0A%20%20%20%20#BEGIN_EDITABLE#terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;#END_EDITABLE#%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A##JS_E####CODE_38E####LOGIC_38####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20terrainLeft%20=%200;%60);%0Apass.if.js.editable(1).equivalent(%60var%20terrainScroll%20=%203;%60);%0Apass.if.js.editable(2).equivalent(%60terrainLeft%20-=%20terrainScroll;%60).or(%60terrainLeft%20=%20terrainLeft%20-%20terrainScroll%60);%0Apass.if.js.editable(3).equivalent(%60terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%60);##JS_E####LOGIC_38E####STEP_38E####STEP_39####INST_39##Terrain%20animation%20-%203/3%0A%0AWith%20the%20animated%20terrain,%20our%20character%20appears%20to%20move%20forward,%20our%20game%20is%20finally%20playable.%0A%0ABut%20you%20will%20probably%20notice%20a%20few%20problems%20with%20our%20game%20in%20its%20current%20state,%20one%20of%20them%20is%20the%20character's%20collision%20box.%0A%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_coll_box.gif%5D%0A%0ALet's%20fix%20this%20first%20before%20tackling%20the%20other%20issues.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#variable%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#200#+1,%20change%20the%20value%20of%20*playerWidth*%20to%20*35*.##INST_39E####CODE_39####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%20%20%20%20border:%201px%20grey%20dotted;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0A#BEGIN_EDITABLE#var%20playerWidth%20=%2064;#END_EDITABLE#%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20animateTerrain();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A##JS_E####CODE_39E####LOGIC_39####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20playerWidth%20=%2035;%60);##JS_E####LOGIC_39E####STEP_39E####STEP_40####INST_40##Detect%20out%20of%20frame%20-%201/4%0A%0AWhen%20the%20character%20reaches%20the%20bottom%20edge%20of%20the%20*scene*%20element,%20rather%20than%20it%20keep%20falling,%20we%20should%20stop%20the%20terrain%20animation,%20disable%20the%20control%20and%20change%20the%20character%20image%20to%20the%20*crash*%20image%20we%20specified%20on%20+css#.crash#+1.%0A%0AFirst%20we'll%20need%20a%20Boolean%20variable%20to%20keep%20track%20of%20the%20character%20status%20-%20true%20when%20not%20out%20of%20frame,%20and%20false%20for%20out%20of%20frame,%20and%20a%20function%20that%20will%20handle%20all%20of%20the%20logic%20relating%20to%20detecting%20when%20character%20is%20out%20of%20frame.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#function%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#%5C#terrain#-3,%20create%20a%20variable%20called%20*playerActive*%20to%20store%20the%20Boolean%20*true*.%0A(*)This%20will%20be%20helpful%20for%20us%20to%20%0A%0A(!)On%20+js#on%20act#+5,%20call%20the%20*detectOutOfFrame*%20function.%0A%0A(!)On%20+js#Collision;#+3,%20create%20a%20function%20called%20*detectOutOfFrame*.##INST_40E####CODE_40####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0A#BEGIN_EDITABLE#var%20playerActive%20=%20true;#END_EDITABLE#%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20animateTerrain();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20#BEGIN_EDITABLE#detectOutOfFrame();#END_EDITABLE#%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0A#BEGIN_EDITABLE#function%20detectOutOfFrame()%20%7B%7D#END_EDITABLE#%0D%0A##JS_E####CODE_40E####LOGIC_40####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20playerActive%20=%20true;%60);%0Apass.if.js.editable(1).equivalent(%60detectOutOfFrame();%60);%0Apass.if.js.editable(2).equivalent(%60function%20detectOutOfFrame()%20%7B%7D%60);##JS_E####LOGIC_40E####STEP_40E####STEP_41####INST_41##Detect%20out%20of%20frame%20-%202/4%0A%0AWe%20know%20the%20height%20of%20the%20*scene*%20and%20the%20*character*%20element,%20as%20well%20as%20the%20top%20position%20of%20the%20*character*%20element.%0A%0ATo%20check%20whether%20the%20character%20has%20reached%20the%20bottom%20edge,%20we%20must%20use%20all%203%20values.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#relational%20operators%5D%0A%09(*)%5B#js#if%5D%0A%09(*)%5B#js#logic%20operators%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#define#+1,%20create%20a%20variable%20called%20*atBottomEdge*%20to%20store%20whether%20or%20not%20the%20player%20element%20has%20reached%20the%20bottom%20edge%20of%20the%20scene.%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_atBottomEdge.png%5D%0A%0A(!)On%20+js#define#+3,%20create%20an%20%60if%60%20statement%20to%20check%20whether%20both%20*playerActive*%20and%20*atBottomEdge*%20are%20true.##INST_41E####CODE_41####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20animateTerrain();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20#BEGIN_EDITABLE#var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;#END_EDITABLE#%0D%0A%20%20%20%20%0D%0A%20%20%20%20#BEGIN_EDITABLE#if%20(playerActive%20&&%20atBottomEdge)%20%7B%7D#END_EDITABLE#%0D%0A%7D%0D%0A##JS_E####CODE_41E####LOGIC_41####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%60).or(%60var%20atBottomEdge%20=%20sceneHeight%20%3C%20playerTop%20+%20playerHeight;%60);%0Apass.if.js.editable(1).equivalent(%60if%20(playerActive%20&&%20atBottomEdge)%20%7B%7D%60).or(%60if%20(playerActive%20==%20true%20&&%20atBottomEdge)%20%7B%7D%60).or(%60if%20(playerActive%20===%20true%20&&%20atBottomEdge)%20%7B%7D%60).or(%60if%20(playerActive%20&&%20atBottomEdge%20==%20true)%20%7B%7D%60).or(%60if%20(playerActive%20&&%20atBottomEdge%20===%20true)%20%7B%7D%60).or(%60if%20(playerActive%20==%20true%20&&%20atBottomEdge%20==%20true)%20%7B%7D%60).or(%60if%20(playerActive%20==%20true%20&&%20atBottomEdge%20===%20true)%20%7B%7D%60).or(%60if%20(playerActive%20===%20true%20&&%20atBottomEdge%20==%20true)%20%7B%7D%60).or(%60if%20(playerActive%20===%20true%20&&%20atBottomEdge%20===%20true)%20%7B%7D%60);##JS_E####LOGIC_41E####STEP_41E####STEP_42####INST_42##Detect%20out%20of%20frame%20-%203/4%0A%0AWe%20could%20write%20the%20code%20in%20the%20*detectOutOfFrame*%20function%20to%20do%20everything%20when%20the%20player%20loses%20an%20attempt,%20but%20we%20would%20have%20to%20write%20it%20again%20for%20when%20the%20character%20runs%20into%20a%20block.%0A%0ASo%20we're%20going%20to%20create%20a%20new%20function,%20that%20way%20when%20we%20get%20around%20handling%20the%20other%20losing%20scenario,%20we%20can%20simply%20call%20this%20function.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#function%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#Edge)#+1,%20call%20the%20*playerCrash*%20function.%0A%0A(!)On%20+js#Edge)#+5,%20create%20a%20function%20called%20*playerCrash*.##INST_42E####CODE_42####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20animateTerrain();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#playerCrash();#END_EDITABLE#%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0A#BEGIN_EDITABLE#function%20playerCrash()%20%7B%7D#END_EDITABLE#%0D%0A##JS_E####CODE_42E####LOGIC_42####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60playerCrash();%60);%0Apass.if.js.editable(1).equivalent(%60function%20playerCrash()%20%7B%7D%60);##JS_E####LOGIC_42E####STEP_42E####STEP_43####INST_43##Detect%20out%20of%20frame%20-%204/4%0A%0AInside%20the%20*playerCrash*%20function,%20we%20want%20to%20do%203%20things:%0A%0A%5B-%0A%09(*)Set%20the%20*pixelPerFrame*%20variable%20to%20a%20negative%20number,%20so%20the%20character%20will%20start%20moving%20upwards.%0A%09(*)Change%20the%20background%20picture%20of%20the%20*player*%20element.%0A%09(*)Flip%20the%20value%20of%20*playerActive*%20from%20true%20to%20false.%0A-%5D%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#className%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#neg#+1,%20assign%20the%20negative%20value%20of%20*maxPixelPerFrame*%20to%20*pixelPerFrame*.%0A%0A(!)On%20+js#neg#+2,%20change%20the%20class%20name%20of%20the%20*player*%20element%20to%20*crash*.%0A%0A(!)On%20+js#neg#+3,%20assign%20the%20Boolean%20*false*%20to%20*playerActive*.##INST_43E####CODE_43####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20animateTerrain();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20#BEGIN_EDITABLE#pixelPerFrame%20=%20-maxPixelPerFrame;#END_EDITABLE#%0D%0A%20%20%20%20#BEGIN_EDITABLE#player.className%20=%20%22crash%22;#END_EDITABLE#%0D%0A%20%20%20%20#BEGIN_EDITABLE#playerActive%20=%20false;#END_EDITABLE#%0D%0A%7D%0D%0A##JS_E####CODE_43E####LOGIC_43####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60pixelPerFrame%20=%20-maxPixelPerFrame;%60).or(%60pixelPerFrame%20=%20maxPixelPerFrame%20*%20-1;%60).or(%60pixelPerFrame%20=%20-1%20*%20maxPixelPerFrame;%60);%0Apass.if.js.editable(1).equivalent(%60player.className%20=%20%22crash%22;%60);%0Apass.if.js.editable(2).equivalent(%60playerActive%20=%20false;%60);##JS_E####LOGIC_43E####STEP_43E####STEP_44####INST_44##Stop%20terrain%20animation%20-%201/2%0A%0AThe%20next%20thing%20we%20need%20to%20do%20is%20to%20stop%20the%20terrain%20from%20moving%20when%20the%20player%20loses.%0A%0ATo%20do%20this,%20we%20can%20simply%20add%20a%20condition%20for%20running%20the%20*aniamteTerrain*%20function.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#if%5D%0A%09(*)%5B#js#relational%20operators%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#on%20act#+3,%20create%20an%20%60if%60%20statement%20to%20check%20whether%20*playerActive*%20is%20equal%20to%20*true*.##INST_44E####CODE_44####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20%0D%0A%20%20%20%20#BEGIN_EDITABLE#if%20(playerActive)%20%7B%7D#END_EDITABLE#%0D%0A%20%20%20%20%0D%0A%20%20%20%20animateTerrain();%0D%0A%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D##JS_E####CODE_44E####LOGIC_44####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60if%20(playerActive)%20%7B%7D%60).or(%60if%20(playerActive%20==%20true)%20%7B%7D%60).or(%60if%20(playerActive%20===%20true)%20%7B%7D%60);##JS_E####LOGIC_44E####STEP_44E####STEP_45####INST_45##Stop%20terrain%20animation%20-%202/2%0A%0AAnother%20function%20that%20we%20don't%20need%20to%20run%20when%20*playerActive*%20is%20false,%20is%20the%20*detectGroundCollision*%20function,%20so%20we%20will%20also%20move%20that%20into%20the%20conditional%20statement.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#function%5D%0A-%5D%0A%0A(***)%0A%0A(!)Move%20the%20*animateTerrain()*%20function%20call%20to%20+js#on%20act#+4%20inside%20the%20%60if%60%20statement.%0A%0A(!)Move%20the%20*detectGroundCollision()*%20function%20call%20to%20+js#on%20act#+5%20inside%20the%20%60if%60%20statement.##INST_45E####CODE_45####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#animateTerrain();#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#detectGroundCollision();#END_EDITABLE#%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20#BEGIN_EDITABLE#animateTerrain();#END_EDITABLE#%0D%0A%20%20%20%20#BEGIN_EDITABLE#detectGroundCollision();#END_EDITABLE#%0D%0A%20%20%20%20%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D##JS_E####CODE_45E####LOGIC_45####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60animateTerrain();%60);%0Apass.if.js.editable(1).equivalent(%60detectGroundCollision();%60);%0Apass.if.js.editable(2).equivalent(%60%60);%0Apass.if.js.editable(3).equivalent(%60%60);##JS_E####LOGIC_45E####STEP_45E####STEP_46####INST_46##Reset%20game%20-%201/3%0A%0AThe%20last%20thing%20we%20need%20to%20add%20before%20our%20game%20is%20fully%20functional,%20is%20the%20*reset*%20feature%20-%20players%20should%20be%20able%20to%20play%20the%20game%20from%20the%20start%20after%20losing.%0A%0AWe%20want%20to%20reset%20the%20game%20after%20the%20character%20is%20completely%20below%20the%20bottom%20edge.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#else%20if%5D%0A%09(*)%5B#js#relational%20operators%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#Edge)#+3,%20create%20an%20%60else%20if%60%20statement%20to%20check%20whether%20*playerTop*%20is%20greater%20than%20*sceneHeight*.##INST_46E####CODE_46####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTo;p%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20#BEGIN_EDITABLE#else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%7D#END_EDITABLE#%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D##JS_E####CODE_46E####LOGIC_46####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%7D%60);##JS_E####LOGIC_46E####STEP_46E####STEP_47####INST_47##Reset%20game%20-%202/3%0A%0AWe%20will%20also%20be%20putting%20the%20code%20for%20resetting%20the%20game%20into%20its%20own%20function,%20because%20later%20on%20we%20will%20need%20to%20reset%20the%20game%20in%20another%20function.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#function%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#Height)#+1,%20call%20the%20*resetGame*%20function.%0A%0A(!)On%20+js#crash#+4,%20create%20a%20function%20called%20*resetGame*.##INST_47E####CODE_47####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#resetGame();#END_EDITABLE#%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0A#BEGIN_EDITABLE#function%20resetGame()%20%7B%7D#END_EDITABLE#%0D%0A##JS_E####CODE_47E####LOGIC_47####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60resetGame();%60);%0Apass.if.js.editable(1).equivalent(%60function%20resetGame()%20%7B%7D%60);##JS_E####LOGIC_47E####STEP_47E####STEP_48####INST_48##Reset%20game%20-%203/3%0A%0ATo%20reset%20the%20game,%20we%20need%20to%20make%20sure%20values%20for%20all%20the%20variables%20revert%20back%20to%20their%20values.%0A%0AFor%20example,%20*playerInAir*%20was%20initially%20*true*%20and%20*pixelPerFrame*%20was%20initially%20*0*.%0A%0A(***)%0A%0A(!)On%20+js#on%20reset#+1,%20assign%20the%20Boolean%20*true*%20to%20*playerInAir*.%0A%0A(!)On%20+js#on%20reset#+2,%20assign%20the%20Boolean%20*true*%20to%20*playerActive*.%0A%0A(!)On%20+js#on%20reset#+3,%20assign%20the%20number%20*0*%20to%20*pixelPerFrame*.%0A%0A(!)On%20+js#on%20reset#+4,%20assign%20the%20number%20*0*%20to%20*terrainLeft*.##INST_48E####CODE_48####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%20%20%20%20%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20#BEGIN_EDITABLE#playerInAir%20=%20true;#END_EDITABLE#%0D%0A%20%20%20%20#BEGIN_EDITABLE#playerActive%20=%20true;#END_EDITABLE#%0D%0A%20%20%20%20#BEGIN_EDITABLE#pixelPerFrame%20=%200;#END_EDITABLE#%0D%0A%20%20%20%20#BEGIN_EDITABLE#terrainLeft%20=%200;#END_EDITABLE#%0D%0A%7D%0D%0A##JS_E####CODE_48E####LOGIC_48####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60playerInAir%20=%20true;%60);%0Apass.if.js.editable(1).equivalent(%60playerActive%20=%20true;%60);%0Apass.if.js.editable(2).equivalent(%60pixelPerFrame%20=%200;%60);%0Apass.if.js.editable(3).equivalent(%60terrainLeft%20=%200;%60);##JS_E####LOGIC_48E####STEP_48E####STEP_49####INST_49##Horizontal%20collision%20-%201/2%0A%0AWe%20still%20have%20on%20last%20issue%20with%20the%20game%20-%20the%20character%20automatically%20climbs%20a%20columns%20of%20blocks%20on%20contact,%20this%20is%20because%20our%20*detectGroundCollision*%20function%20puts%20the%20character%20on%20top%20of%20any%20block%20it%20collides%20with%20(%20+js#%3E=%20maxTop#%20&%20js#=%20maxTop;#%20).%0A%0ATo%20create%20the%20correct%20behaviour%20for%20colliding%20with%20a%20block%20from%20the%20side,%20we%20first%20need%20to%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block.%0A%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_vDist.png%5D%0A%0AThis%20vertical%20distance%20should%20not%20be%20bigger%20than%20*maxPixelPerFrame*%20at%20any%20given%20time,%20otherwise%20we%20consider%20the%20collision%20to%20be%20illegal%20and%20the%20player%20will%20lose.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#arithmetic%20operators%5D%0A%09(*)%5B#js#if%5D%0A%09(*)%5B#js#relational%20operators%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#vert#+1,%20create%20a%20variable%20called%20*vDist*%20to%20store%20the%20vertical%20distance%20between%20the%20player%20and%20a%20block.%0A%0A(!)On%20+js#vert#+4,%20create%20an%20%60if%60%20statement%20to%20check%20whether%20*vDist*%20is%20greater%20than%20*maxPixelPerFrame*.%0A%0A(!)On%20+js#vert#+5,%20create%20an%20%60else%60%20statement.##INST_49E####CODE_49####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20/*top:%20-100px;*/%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20400;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;#END_EDITABLE#%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%7D#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#else%20%7B%7D#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D##JS_E####CODE_49E####LOGIC_49####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%60).or(%60var%20vDist%20=%20playerHeight%20+%20playerTop%20-%20blockTop;%60);%0Apass.if.js.editable(1).equivalent(%60if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%7D%60);%0Apass.if.js.editable(2).equivalent(%60else%20%7B%7D%60);##JS_E####LOGIC_49E####STEP_49E####STEP_50####INST_50##Horizontal%20collision%20-%202/2%0A%0ARemember%20the%20*playerCrash*%20function%20we%20created%20on%20+js#on%20play#?%20Now%20we%20can%20call%20it%20in%20the%20%60if%60%20statement%20(%20+js#vDist%20%3E#%20),%20and%20in%20the%20%60else%60%20statement,%20we%20will%20handle%20collisions%20as%20usual%20by%20putting%20the%20character%20on%20top%20of%20a%20colliding%20block.%0A%0ANow%20because%20the%20*playerCrash*%20will%20make%20the%20character%20jump%20up,%20we%20also%20need%20to%20set%20the%20*noCollision*%20variable%20to%20*true*.%0A%0AAnd%20in%20addition,%20in%20the%20*resetGame*%20function,%20we%20need%20to%20reset%20the%20character's%20position%20and%20image.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#function%5D%0A%09(*)%5B#js#className%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#vDist%20%3E#+1,%20call%20the%20*playerCrash*%20function.%0A%0A(!)On%20+js#vDist%20%3E#+2,%20assign%20the%20Boolean%20*true*%20to%20*noCollision*.%0A%0A(!)On%20+js#on%20res#+1,%20assign%20the%20number%20*300*%20to%20*playerTop*.%0A%0A(!)On%20+js#on%20res#+2,%20change%20the%20class%20name%20of%20the%20*player*%20element%20to%20*jump*.##INST_50E####CODE_50####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#playerCrash();#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#noCollision%20=%20true;#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20#BEGIN_EDITABLE#playerTop%20=%20300;#END_EDITABLE#%0D%0A%20%20%20%20#BEGIN_EDITABLE#player.className%20=%20%22jump%22;#END_EDITABLE#%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D##JS_E####CODE_50E####LOGIC_50####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60playerCrash();%60);%0Apass.if.js.editable(1).equivalent(%60noCollision%20=%20true;%60);%0Apass.if.js.editable(2).equivalent(%60playerTop%20=%20300;%60);%0Apass.if.js.editable(3).equivalent(%60player.className%20=%20%22jump%22;%60);##JS_E####LOGIC_50E####STEP_50E####STEP_51####INST_51##Finish%20sign%20-%201/4%0A%0AThe%20player%20can%20now%20lose%20and%20reset%20the%20game,%20but%20not%20win%20the%20game.%0A%0AWe%20can%20add%20a%20finish%20sign%20at%20the%20end%20of%20our%20level,%20reaching%20it%20can%20be%20the%20winning%20condition%20for%20the%20level.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#html#%3Cdiv%3E%5D%0A%09(*)%5B#html#id%5D%0A%09(*)%5B#css#rule%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+html#scene#+2,%20create%20a%20%60%3Cdiv%3E%60%20element%20and%20set%20the%20%60id%60%20attribute%20to%20*finishSign*.%0A%0A(%3E%3Estyle.css)%0A%0A(!)On%20+css#top_#+3,%20create%20an%20empty%20rule%20for%20*#finishSign*.##INST_51E####CODE_51####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E#END_EDITABLE#%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#BEGIN_EDITABLE##finishSign%20%7B%7D#END_EDITABLE#%0A##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D%0D%0A#BEGIN_EDITABLE##END_EDITABLE###JS_E####CODE_51E####LOGIC_51####HTML##//%20Expectation:%0Apass.if.html.editable(0).equivalent(%60%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%60);##HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60#finishSign%20%7B%7D%60);##CSS_E####JS####JS_E####LOGIC_51E####STEP_51E####STEP_52####INST_52##Finish%20sign%20-%202/4%0A%0ATo%20represent%20the%20finish%20sign,%20we%20will%20use%20an%20image%20for%20the%20%60%3Cdiv%3E%60%20element.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#css#background-image%5D%0A%09(*)%5B#css#background-size%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+css#%5C#finish#+4,%20use%20the%20following%20image%20as%20background%20image%20for%20the%20*#finishSign*%20element.%0A(*)https://app.bsd.education/resources/finishSign.png%0A%5Bimg::https://app.bsd.education/resources/finishSign.png%5D%0A%0A(!)On%20+css#%5C#finish#+5,%20resize%20the%20background%20image%20to%20fully%20cover%20the%20*#finishSign*%20element.##INST_52E####CODE_52####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E%0A#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20#BEGIN_EDITABLE#background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);#END_EDITABLE#%0A%20%20%20%20#BEGIN_EDITABLE#background-size:%20cover;#END_EDITABLE#%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D##JS_E####CODE_52E####LOGIC_52####HTML####HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%60);%0Apass.if.css.editable(1).equivalent(%60background-size:%20cover;%60);##CSS_E####JS####JS_E####LOGIC_52E####STEP_52E####STEP_53####INST_53##Finish%20sign%20-%203/4%0A%0AWe%20can't%20specify%20a%20fixed%20position%20for%20the%20finish%20sign%20because%20we%20don't%20know%20how%20long%20the%20level%20is,%20or%20how%20many%20blocks%20are%20in%20the%20final%20column,%20it%20all%20depends%20on%20the%20*terrain*%20array.%0A%0AFortunately,%20we%20already%20have%20a%20*forEach*%20loop%20for%20it,%20we%20just%20need%20to%20write%20some%20code%20inside%20the%20loop%20to%20determine%20whether%20a%20column%20is%20the%20final%20column.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#length%5D%0A%09(*)%5B#js#relational%20operators%5D%0A%09(*)%5B#js#if%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#Block,#-2,%20create%20a%20variable%20called%20*finalColumn*%20to%20store%20whether%20*columnIndex*%20is%20the%20last%20index%20in%20the%20*terrain*%20array.%0A%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_lastColumn.png%5D%0A%0A(!)On%20+js#top%22#+2,%20create%20an%20%60if%60%20statement%20to%20check%20whether%20*finalColumn*%20is%20equal%20to%20*true*.##INST_53E####CODE_53####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A#BEGIN_EDITABLE##END_EDITABLE#%0A##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20coloumnSize%20is%20the%20last%20number%20in%20the%20tarrain%20array%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#var%20finalColumn%20=%20columnIndex%20==%20terrain.length%20-%201;#END_EDITABLE#%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#if%20(finalColumn)%20%7B%7D#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D##JS_E####CODE_53E####LOGIC_53####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20finalColumn%20=%20columnIndex%20==%20terrain.length%20-%201;%60).or(%60var%20finalColumn%20=%20terrain.length%20-%201%20==%20columnIndex;%60);%0Apass.if.js.editable(1).equivalent(%60if%20(finalColumn)%20%7B%7D%60).or(%60if%20(finalColumn%20==%20true)%20%7B%7D%60).or(%60if%20(finalColumn%20===%20true)%20%7B%7D%60);##JS_E####LOGIC_53E####STEP_53E####STEP_54####INST_54##Finish%20sign%20-%204/4%0A%0AAfter%20identifying%20the%20final%20columns,%20we%20need%20to%20find%20the%20first%20block%20in%20the%20column%20and%20put%20the%20finish%20sign%20above%20that%20block.%0A%0ALet's%20figure%20out%20the%20left%20and%20bottom%20position%20for%20the%20finish%20sign.%0A%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_sign_position.png%5D%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#style%5D%0A%09(*)%5B#js#string%20concatenation%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#(final#+1,%20assign%20the%20left%20position%20of%20*newBlock*%20to%20*finishSign*.%0A%20%0A(!)On%20+js#(final#+2,%20place%20the%20*finishSign*%20element%20directly%20on%20top%20of%20the%20first%20block%20of%20the%20final%20column.##INST_54E####CODE_54####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20coloumnSize%20is%20the%20last%20number%20in%20the%20tarrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20finalColumn%20=%20columnIndex%20==%20terrain.length%20-%201;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(finalColumn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#finishSign.style.left%20=%20newBlock.style.left;#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#finishSign.style.bottom%20=%20blockBottom%20+%20blockSize%20+%20%22px%22;#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D##JS_E####CODE_54E####LOGIC_54####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60finishSign.style.left%20=%20newBlock.style.left;%60);%0Apass.if.js.editable(1).equivalent(%60finishSign.style.bottom%20=%20blockBottom%20+%20blockSize%20+%20%22px%22;%60).or(%60finishSign.style.bottom%20=%20blockSize%20+%20blockBottom%20+%20%22px%22;%60);##JS_E####LOGIC_54E####STEP_54E####STEP_55####INST_55##Sign%20collision%20-%201/4%0A%0AFor%20the%20finish%20sign%20to%20function%20properly,%20we%20need%20to%20also%20detect%20collision%20between%20it%20and%20the%20character.%0A%0AThis%20will%20need%20to%20be%20done%20every%20frame%20as%20long%20as%20the%20player%20is%20active.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#function%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#on%20act#+6,%20call%20the%20*detectFinishSign*%20function.%0A%0A(!)On%20+js#%5C#scene#-3,%20create%20a%20function%20called%20*detectFinishSign*.##INST_55E####CODE_55####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20coloumnSize%20is%20the%20last%20number%20in%20the%20tarrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20lastColumn%20=%20columnIndex%20==%20terrain.length%20-%201;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(lastColumn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.left%20=%20newBlock.style.left;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.bottom%20=%20blockBottom%20+%20blockSize%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#detectFinishSign();#END_EDITABLE#%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0A#BEGIN_EDITABLE#function%20detectFinishSign()%20%7B%7D#END_EDITABLE#%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D##JS_E####CODE_55E####LOGIC_55####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60detectFinishSign();%60);%0Apass.if.js.editable(1).equivalent(%60function%20detectFinishSign()%20%7B%7D%60);##JS_E####LOGIC_55E####STEP_55E####STEP_56####INST_56##Sign%20collision%20-%202/4%0A%0AThere%20are%20only%20two%20conditions%20we%20need%20to%20check%20before%20we%20know%20for%20sure%20that%20the%20player%20has%20finished%20the%20level:%0A%0A%5B-%0A%09(*)The%20left%20position%20of%20the%20character%20is%20bigger%20than%20or%20equal%20to%20that%20of%20the%20sign.%0A%09(*)The%20character%20is%20not%20in%20the%20air.%0A-%5D%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#relational%20operators%5D%0A%09(*)%5B#js#if%5D%0A%09(*)%5B#js#logic%20operators%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#%5C#scene#-6,%20create%20a%20variable%20called%20*finished*%20to%20store%20whether%20or%20not%20*playerLeft*%20is%20greater%20than%20or%20equal%20to%20*signLeft*.%0A(*)*Tip*:%20avoid%20using%20the%20%60%7C%7C%60%20logic%20operator%0A%0A(!)On%20+js#%5C#scene#-4,%20create%20an%20%60if%60%20statement%20to%20check%20whether%20*finished*%20is%20equal%20to%20*true*%20and%20*playerInAir*%20is%20equal%20to%20*false*.%0A(*)*Tip*:%20use%20the%20%60&&%60%20logic%20operator##INST_56E####CODE_56####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20coloumnSize%20is%20the%20last%20number%20in%20the%20tarrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20lastColumn%20=%20columnIndex%20==%20terrain.length%20-%201;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(lastColumn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.left%20=%20newBlock.style.left;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.bottom%20=%20blockBottom%20+%20blockSize%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%20%20%20%20detectFinishSign();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectFinishSign()%20%7B%0D%0A%20%20%20%20var%20signLeft%20=%20finishSign.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20#BEGIN_EDITABLE#var%20finished%20=%20playerLeft%20%3E=%20signLeft;#END_EDITABLE#%0D%0A%20%20%20%20%0D%0A%20%20%20%20#BEGIN_EDITABLE#if%20(finished%20&&%20playerInAir%20===%20false)%20%7B%7D#END_EDITABLE#%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D##JS_E####CODE_56E####LOGIC_56####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20finished%20=%20playerLeft%20%3E=%20signLeft;%60);%0Apass.if.js.editable(1).equivalent(%60if%20(finished%20&&%20!playerInAir)%20%7B%7D%60).or(%60if%20(finished%20==%20true%20&&%20!playerInAir)%20%7B%7D%60).or(%60if%20(finished%20===%20true%20&&%20!playerInAir)%20%7B%7D%60).or(%60if%20(finished%20&&%20playerInAir%20==%20false)%20%7B%7D%60).or(%60if%20(finished%20&&%20playerInAir%20===%20false)%20%7B%7D%60).or(%60if%20(finished%20==%20true%20&&%20playerInAir%20===%20false)%20%7B%7D%60).or(%60if%20(finished%20===%20true%20&&%20playerInAir%20==%20false)%20%7B%7D%60).or(%60if%20(finished%20===%20true%20&&%20playerInAir%20===%20false)%20%7B%7D%60);##JS_E####LOGIC_56E####STEP_56E####STEP_57####INST_57##Sign%20collision%20-%202/4%0A%0AInside%20the%20%60if%60%20statement,%20we%20will%20disable%20the%20player%20element%20by%20setting%20*playerActive*%20to%20false,%20and%20then%20display%20a%20confirmation%20pop%20up.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#if%5D%0A%09(*)%5B#js#confirm%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#%5C#scene#-7,%20assign%20the%20Boolean%20*false*%20to%20*playerActive*.%0A%0A(!)On%20+js#%5C#scene#-5,%20create%20an%20%60if%60%20statement%20to%20check%20whether%20the%20*confirm*%20function%20returns%20*true*.%0A(*)*Tip*:%20use%20the%20%60&&%60%20logic%20operator##INST_57E####CODE_57####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20coloumnSize%20is%20the%20last%20number%20in%20the%20tarrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20finalColumn%20=%20columnIndex%20==%20terrain.length%20-%201;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(finalColumn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.left%20=%20newBlock.style.left;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.bottom%20=%20blockBottom%20+%20blockSize%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%20%20%20%20detectFinishSign();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectFinishSign()%20%7B%0D%0A%20%20%20%20var%20signLeft%20=%20finishSign.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20var%20finished%20=%20playerLeft%20%3E=%20signLeft;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(finished%20&&%20!playerInAir)%20%7B%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#playerActive%20=%20false;#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#if%20(confirm())%20%7B%7D#END_EDITABLE#%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D##JS_E####CODE_57E####LOGIC_57####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60playerActive%20=%20false;%60);%0Apass.if.js.editable(1).equivalent(%60if%20(confirm())%20%7B%7D%60).or(%60if%20(confirm()%20==%20true)%20%7B%7D%60).or(%60if%20(confirm()%20===%20true)%20%7B%7D%60).or(%60if%20(true%20==%20confirm())%20%7B%7D%60).or(%60if%20(true%20===%20confirm())%20%7B%7D%60);##JS_E####LOGIC_57E####STEP_57E####STEP_58####INST_58##Sign%20collision%20-%204/4%0A%0ATry%20reaching%20the%20finish%20sign%20in%20the%20game%20and%20you%20will%20see%20a%20pop%20up%20window%20in%20which%20you%20have%20two%20options,%20pressing%20*Okay*%20will%20return%20true%20to%20the%20%60if%60%20statement%20and%20we%20will%20call%20the%20*resetGame*%20function,%20otherwise%20nothing%20will%20happen.%0A%0AWe%20should%20also%20add%20a%20message%20asking%20players%20whether%20they%20want%20to%20play%20again.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#confirm%5D%0A%09(*)%5B#js#function%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#!#+3,%20show%20the%20string%20*%22You%20finished%20the%20level,%20play%20again?%22*%20in%20the%20confirm%20dialogue.%0A%0A(!)On%20+js#!#+4,%20call%20the%20*resetGame*%20function.##INST_58E####CODE_58####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20coloumnSize%20is%20the%20last%20number%20in%20the%20tarrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20finalColumn%20=%20columnIndex%20==%20terrain.length%20-%201;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(finalColumn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.left%20=%20newBlock.style.left;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.bottom%20=%20blockBottom%20+%20blockSize%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%20%20%20%20detectFinishSign();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectFinishSign()%20%7B%0D%0A%20%20%20%20var%20signLeft%20=%20finishSign.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20var%20finished%20=%20playerLeft%20%3E=%20signLeft;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(finished%20&&%20!playerInAir)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerActive%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(#BEGIN_EDITABLE#confirm(%22You%20finished%20the%20level,%20play%20again?%22)#END_EDITABLE#)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#resetGame();#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D##JS_E####CODE_58E####LOGIC_58####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60confirm(%22You%20finished%20the%20level,%20play%20again?%22)%60);%0Apass.if.js.editable(1).equivalent(%60resetGame();%60);##JS_E####LOGIC_58E####STEP_58E####STEP_59####INST_59##Coin%20generator%20-%201/5%0A%0AOur%20next%20new%20game%20feature%20is%20collectable%20coins,%20this%20will%20add%20competitiveness%20to%20our%20game%20and%20encourage%20people%20to%20play%20this%20game%20multiple%20times.%0A%0AFirst%20we%20will%20need%20to%20create%20a%20score%20keeper.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#html#%3Ch1%3E%5D%0A%09(*)%5B#html#id%5D%0A%09(*)%5B#css#rule%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+html#%3Cbody#+1,%20create%20an%20%60%3Ch1%3E%60%20element,%20set%20the%20%60id%60%20attribute%20to%20*scoreboard*,%20and%20add%20the%20text%20*Score:*%20between%20the%20tags.%0A%0A(%3E%3Estyle.css)%0A%0A(!)On%20+css#%5C#scene#-2,%20create%20an%20empty%20rule%20for%20*#scoreboard*.##INST_59E####CODE_59####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20#BEGIN_EDITABLE#%3Ch1%20id=%22scoreboard%22%3EScore:%3C/h1%3E#END_EDITABLE#%0A%20%20%20%20%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#BEGIN_EDITABLE##scoreboard%20%7B%7D#END_EDITABLE#%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20coloumnSize%20is%20the%20last%20number%20in%20the%20tarrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20finalColumn%20=%20columnIndex%20==%20terrain.length%20-%201;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(finalColumn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.left%20=%20newBlock.style.left;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.bottom%20=%20blockBottom%20+%20blockSize%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%20%20%20%20detectFinishSign();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectFinishSign()%20%7B%0D%0A%20%20%20%20var%20signLeft%20=%20finishSign.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20var%20finished%20=%20playerLeft%20%3E=%20signLeft;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(finished%20&&%20!playerInAir)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerActive%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(confirm(%22You%20finished%20the%20level,%20play%20again?%22))%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D%0D%0A#BEGIN_EDITABLE##END_EDITABLE###JS_E####CODE_59E####LOGIC_59####HTML##//%20Expectation:%0Apass.if.html.editable(0).equivalent(%60%3Ch1%20id=%22scoreboard%22%3EScore:%3C/h1%3E%60);##HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60#scoreboard%20%7B%7D%60);##CSS_E####JS####JS_E####LOGIC_59E####STEP_59E####STEP_60####INST_60##Coin%20generator%20-%202/5%0A%0AEventually,%20we%20will%20want%20to%20focus%20on%20designing%20our%20level,%20without%20having%20to%20worry%20about%20how%20many%20coins%20are%20in%20the%20level.%0A%0AThat's%20why%20we%20will%20create%20separate%20elements%20each%20with%20unique%20ID%20name%20so%20we%20can%20make%20JavaScript%20do%20the%20score%20keeping%20automatically.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#html#%3Cspan%3E%5D%0A%09(*)%5B#html#id%5D%0A%09(*)%5B#css#text-align%5D%0A%09(*)%5B#js#querySelector%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+html#Score:#+1,%20create%20a%20%60%3Cspan%3E%60%20element,%20set%20the%20%60id%60%20attribute%20to%20*score*,%20and%20add%20the%20text%20*0*%20between%20the%20tags.%0A%0A(!)On%20+html#Score:#+3,%20create%20a%20%60%3Cspan%3E%60%20element,%20set%20the%20%60id%60%20attribute%20to%20*totalCoins*,%20and%20add%20the%20text%20*?*%20between%20the%20tags.%0A%0A(%3E%3Estyle.css)%0A%0A(!)On%20+css#%5C#score#+1,%20center%20the%20*#scoreboard*%20element%20on%20the%20page.%0A%0A(%3E%3Escript.js)%0A%0A(!)On%20+js#12#+2,%20create%20a%20variable%20called%20*score*%20to%20store%20the%20*#score*%20element.##INST_60E####CODE_60####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Ch1%20id=%22scoreboard%22%3E%0A%20%20%20%20%20%20%20%20Score:%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#%3Cspan%20id=%22score%22%3E0%3C/span%3E#END_EDITABLE#%0A%20%20%20%20%20%20%20%20/%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#%3Cspan%20id=%22totalCoins%22%3E?%3C/span%3E#END_EDITABLE#%0A%20%20%20%20%3C/h1%3E%0A%20%20%20%20%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scoreboard%20%7B%0A%20%20%20%20#BEGIN_EDITABLE#text-align:%20center;#END_EDITABLE#%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0A#BEGIN_EDITABLE#var%20score%20=%20document.querySelector(%22#score%22);#END_EDITABLE#%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%202,%201,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20coloumnSize%20is%20the%20last%20number%20in%20the%20tarrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20finalColumn%20=%20columnIndex%20==%20terrain.length%20-%201;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(finalColumn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.left%20=%20newBlock.style.left;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.bottom%20=%20blockBottom%20+%20blockSize%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%20%20%20%20detectFinishSign();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectFinishSign()%20%7B%0D%0A%20%20%20%20var%20signLeft%20=%20finishSign.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20var%20finished%20=%20playerLeft%20%3E=%20signLeft;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(finished%20&&%20!playerInAir)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerActive%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(confirm(%22You%20finished%20the%20level,%20play%20again?%22))%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D##JS_E####CODE_60E####LOGIC_60####HTML##//%20Expectation:%0Apass.if.html.editable(0).equivalent(%60%3Cspan%20id=%22score%22%3E0%3C/span%3E%60);%0Apass.if.html.editable(1).equivalent(%60%3Cspan%20id=%22totalCoins%22%3E?%3C/span%3E%60);##HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60text-align:%20center;%60);##CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20score%20=%20document.querySelector(%22#score%22);%60);##JS_E####LOGIC_60E####STEP_60E####STEP_61####INST_61##Coin%20generator%20-%203/5%0A%0AFor%20adding%20coins%20to%20our%20game,%20we%20will%20use%20another%20array%20similar%20to%20the%20*terrain*%20array,%20each%20number%20in%20this%20array%20will%20be%20used%20to%20determine%20the%20coin's%20position.%0A%0AAnd%20in%20the%20*forEach*%20loop%20of%20the%20*terrain*%20array,%20we%20will%20use%20*columnIndex*%20to%20access%20each%20number%20in%20the%20coin%20positions%20array.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#array%5D%0A%09(*)%5B#js#if%5D%0A%09(*)%5B#js#relational%20operators%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#2,%202#+1,%20create%20a%20variable%20called%20*coinPositions*%20to%20store%20the%20array%20*%5B0,%201,%202,%201,%203,%203%5D*.%0A%0A(!)On%20+js#on%20jump#-4,%20create%20an%20%60if%60%20statement%20to%20check%20if%20a%20number%20in%20the%20*coinPositions*%20array%20is%20greater%20than%20*0*.%0A(*)*Tip*:%20use%20the%20*columnIndex*%20variable.##INST_61E####CODE_61####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Ch1%20id=%22scoreboard%22%3E%0A%20%20%20%20%20%20%20%20Score:%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22score%22%3E0%3C/span%3E%0A%20%20%20%20%20%20%20%20/%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22totalCoins%22%3E?%3C/span%3E%0A%20%20%20%20%3C/h1%3E%0A%20%20%20%20%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E%0A#BEGIN_EDITABLE##END_EDITABLE###HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scoreboard%20%7B%0A%20%20%20%20text-align:%20center;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A#BEGIN_EDITABLE##END_EDITABLE###CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0Avar%20score%20=%20document.querySelector(%22#score%22);%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%201,%201,%201,%202,%202,%203,%203%5D;%0D%0A#BEGIN_EDITABLE#var%20coinPositions%20=%20%20%5B0,%201,%202,%201,%203,%203%5D;#END_EDITABLE#%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20coloumnSize%20is%20the%20last%20number%20in%20the%20tarrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20finalColumn%20=%20columnIndex%20==%20terrain.length%20-%201;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(finalColumn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.left%20=%20newBlock.style.left;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.bottom%20=%20blockBottom%20+%20blockSize%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#if%20(coinPositions%5BcolumnIndex%5D%20%3E%200)%20%7B%7D#END_EDITABLE#%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%20%20%20%20detectFinishSign();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectFinishSign()%20%7B%0D%0A%20%20%20%20var%20signLeft%20=%20finishSign.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20var%20finished%20=%20playerLeft%20%3E=%20signLeft;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(finished%20&&%20!playerInAir)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerActive%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(confirm(%22You%20finished%20the%20level,%20play%20again?%22))%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D##JS_E####CODE_61E####LOGIC_61####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20coinPositions%20=%20%5B0,%201,%202,%201,%203,%203%5D;%60);%0Apass.if.js.editable(1).equivalent(%60if%20(coinPositions%5BcolumnIndex%5D%20%3E%200)%20%7B%7D%60).or(%60if%20(coinPositions%5BcolumnIndex%5D)%20%7B%7D%60);##JS_E####LOGIC_61E####STEP_61E####STEP_62####INST_62##Coin%20generator%20-%204/5%0A%0AInside%20the%20%60if%60%20statement,%20we've%20created%20a%20new%20element%20and%20stored%20it%20in%20*newCoin*,%20in%20order%20for%20this%20element%20to%20appear%20as%20a%20coin%20and%20be%20placed%20in%20the%20proper%20position,%20we%20need%20to%20do%20a%20few%20things:%0A%0A%5B-%0A%09(*)Add%20an%20image%20as%20the%20background.%0A%09(*)Calculate%20the%20bottom%20position%20for%20the%20element%20using%20the%20*coinPositions*%20array,%20*columnIndex*%20and%20*blockSize*.%0A-%5D%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#css#background-image%5D%0A%09(*)%5B#js#className%5D%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#array%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+css#.coin#+1,%20use%20the%20following%20image%20as%20background%20image.%0A(*)https://app.bsd.education/resources/spin_coin.gif%0A%5Bimg::https://app.bsd.education/resources/spin_coin.gif%5D%0A%0A(%3E%3Escript.js)%0A%0A(!)On%20+js#newCoin)#+2,%20give%20the%20*newCoin*%20element%20the%20class%20name%20*coin*.%0A%0A(!)On%20+js#var%20hei#+2,%20create%20a%20variable%20called%20*floatHeight*%20to%20store%20the%20bottom%20position%20of%20each%20coin.%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_floatHeight.png%5D##INST_62E####CODE_62####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Ch1%20id=%22scoreboard%22%3E%0A%20%20%20%20%20%20%20%20Score:%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22score%22%3E0%3C/span%3E%0A%20%20%20%20%20%20%20%20/%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22totalCoins%22%3E?%3C/span%3E%0A%20%20%20%20%3C/h1%3E%0A%20%20%20%20%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scoreboard%20%7B%0A%20%20%20%20text-align:%20center;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A%0A.coin%20%7B%0A%20%20%20%20#BEGIN_EDITABLE#background-image:%20url(%22https://app.bsd.education/resources/spin_coin.gif%22);#END_EDITABLE#%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20width:%2030px;%0A%20%20%20%20height:%2030px;%0A%20%20%20%20position:%20absolute;%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0Avar%20score%20=%20document.querySelector(%22#score%22);%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%201,%201,%201,%202,%202,%203,%203%5D;%0D%0Avar%20coinPositions%20=%20%20%5B0,%201,%202,%201,%203,%203%5D;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20coloumnSize%20is%20the%20last%20number%20in%20the%20tarrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20finalColumn%20=%20columnIndex%20==%20terrain.length%20-%201;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(finalColumn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.left%20=%20newBlock.style.left;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.bottom%20=%20blockBottom%20+%20blockSize%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(coinPositions%5BcolumnIndex%5D%20%3E%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20newCoin%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newCoin);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#newCoin.className%20=%20%22coin%22;#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20difference%20in%20width%20and%20height%20between%20the%20coin%20and%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20then%20divides%20it%20by%202%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20widthDiff%20=%20(blockSize%20-%20newCoin.offsetWidth)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20heightDiff%20=%20(blockSize%20-%20newCoin.offsetHeight)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#var%20floatHeight%20=%20coinPositions%5BcolumnIndex%5D%20*%20blockSize;#END_EDITABLE#%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.left%20=%20columnLeft%20+%20widthDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.bottom%20=%20floatHeight%20+%20heightDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%20%20%20%20detectFinishSign();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectFinishSign()%20%7B%0D%0A%20%20%20%20var%20signLeft%20=%20finishSign.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20var%20finished%20=%20playerLeft%20%3E=%20signLeft;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(finished%20&&%20!playerInAir)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerActive%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(confirm(%22You%20finished%20the%20level,%20play%20again?%22))%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D##JS_E####CODE_62E####LOGIC_62####HTML####HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60background-image:%20url(%22https://app.bsd.education/resources/spin_coin.gif%22);%60);##CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60newCoin.className%20=%20%22coin%22;%60);%0Apass.if.js.editable(1).equivalent(%60var%20floatHeight%20=%20coinPositions%5BcolumnIndex%5D%20*%20blockSize;%60).or(%60var%20floatHeight%20=%20blockSize%20*%20coinPositions%5BcolumnIndex%5D;%60);##JS_E####LOGIC_62E####STEP_62E####STEP_63####INST_63##Coin%20generator%20-%205/5%0A%0AThe%20coins%20are%20being%20placed%20into%20the%20game%20correctly%20but%20we%20still%20can't%20collect%20them.%0A%0AIn%20order%20to%20do%20that,%20we%20will%20need%20to%20first%20store%20all%20the%20elements%20with%20the%20*coin*%20class%20name,%20so%20we%20can%20detect%20collision%20between%20each%20coin%20and%20the%20character.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#variable%5D%0A%09(*)%5B#js#querySelectorAll%5D%0A%09(*)%5B#js#innerText%5D%0A%09(*)%5B#js#length%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#1,%203#+1,%20create%20a%20variable%20called%20*coins*.%0A%0A(!)On%20+js#all%20coin#+1,%20use%20*coins*%20to%20store%20the%20*.coin*%20elements.%0A(*)*Tip*:%20use%20the%20%60querySelectorAll%60%20syntax.%0A%0A(!)On%20+js#all%20coin#+2,%20show%20*coins.length*%20as%20text%20in%20the%20*totalCoins*%20element.##INST_63E####CODE_63####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Ch1%20id=%22scoreboard%22%3E%0A%20%20%20%20%20%20%20%20Score:%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22score%22%3E0%3C/span%3E%0A%20%20%20%20%20%20%20%20/%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22totalCoins%22%3E?%3C/span%3E%0A%20%20%20%20%3C/h1%3E%0A%20%20%20%20%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scoreboard%20%7B%0A%20%20%20%20text-align:%20center;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A%0A.coin%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/spin_coin.gif%22);%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20width:%2030px;%0A%20%20%20%20height:%2030px;%0A%20%20%20%20position:%20absolute;%0A%7D%0A#BEGIN_EDITABLE##END_EDITABLE#%0A##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0Avar%20score%20=%20document.querySelector(%22#score%22);%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%201,%201,%201,%202,%202,%203,%203%5D;%0D%0Avar%20coinPositions%20=%20%20%5B0,%201,%202,%201,%203,%203%5D;%0D%0A#BEGIN_EDITABLE#var%20coins;#END_EDITABLE#%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20coloumnSize%20is%20the%20last%20number%20in%20the%20tarrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20finalColumn%20=%20columnIndex%20==%20terrain.length%20-%201;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(finalColumn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.left%20=%20newBlock.style.left;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.bottom%20=%20blockBottom%20+%20blockSize%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(coinPositions%5BcolumnIndex%5D%20%3E%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20newCoin%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newCoin);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.className%20=%20%22coin%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20difference%20in%20width%20and%20height%20between%20the%20coin%20and%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20then%20divides%20it%20by%202%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20widthDiff%20=%20(blockSize%20-%20newCoin.offsetWidth)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20heightDiff%20=%20(blockSize%20-%20newCoin.offsetHeight)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20floatHeight%20=%20coinPositions%5BcolumnIndex%5D%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.left%20=%20columnLeft%20+%20widthDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.bottom%20=%20floatHeight%20+%20heightDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20store%20all%20coin%20images%20into%20an%20array%0D%0A%20%20%20%20#BEGIN_EDITABLE#coins%20=%20document.querySelectorAll(%22.coin%22);#END_EDITABLE#%0D%0A%20%20%20%20#BEGIN_EDITABLE#totalCoins.innerText%20=%20coins.length;#END_EDITABLE#%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%20%20%20%20detectCoinCollection();%0D%0A%20%20%20%20%20%20%20%20detectFinishSign();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectCoinCollection()%20%7B%7D%0D%0A%0D%0Afunction%20detectFinishSign()%20%7B%0D%0A%20%20%20%20var%20signLeft%20=%20finishSign.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20var%20finished%20=%20playerLeft%20%3E=%20signLeft;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(finished%20&&%20!playerInAir)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerActive%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(confirm(%22You%20finished%20the%20level,%20play%20again?%22))%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D##JS_E####CODE_63E####LOGIC_63####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60var%20coins;%60);%0Apass.if.js.editable(1).equivalent(%60coins%20=%20document.querySelectorAll(%22.coin%22);%60);%0Apass.if.js.editable(2).equivalent(%60totalCoins.innerText%20=%20coins.length;%60);##JS_E####LOGIC_63E####STEP_63E####STEP_64####INST_64##Coin%20collection%20-%201/5%0A%0AJust%20like%20the%20other%202%20collision%20detection%20functions%20we%20created,%20we%20will%20need%20to%20detect%20collision%20between%20the%20character%20and%20each%20coin%20every%20frame.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#function%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#on%20act#+6,%20call%20the%20*detetCoinCollection*%20function.%0A%0A(!)On%20+js#!#-6,%20create%20a%20function%20called%20*detectCoinCollection*.##INST_64E####CODE_64####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Ch1%20id=%22scoreboard%22%3E%0A%20%20%20%20%20%20%20%20Score:%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22score%22%3E0%3C/span%3E%0A%20%20%20%20%20%20%20%20/%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22totalCoins%22%3E?%3C/span%3E%0A%20%20%20%20%3C/h1%3E%0A%20%20%20%20%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scoreboard%20%7B%0A%20%20%20%20text-align:%20center;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A%0A.coin%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/spin_coin.gif%22);%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20width:%2030px;%0A%20%20%20%20height:%2030px;%0A%20%20%20%20position:%20absolute;%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0Avar%20score%20=%20document.querySelector(%22#score%22);%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%201,%201,%201,%202,%202,%203,%203%5D;%0D%0Avar%20coinPositions%20=%20%20%5B0,%201,%202,%201,%203,%203%5D;%0D%0Avar%20coins;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20coloumnSize%20is%20the%20last%20number%20in%20the%20tarrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20finalColumn%20=%20columnIndex%20==%20terrain.length%20-%201;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(finalColumn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.left%20=%20newBlock.style.left;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.bottom%20=%20blockBottom%20+%20blockSize%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(coinPositions%5BcolumnIndex%5D%20%3E%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20newCoin%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newCoin);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.className%20=%20%22coin%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20difference%20in%20width%20and%20height%20between%20the%20coin%20and%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20then%20divides%20it%20by%202%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20widthDiff%20=%20(blockSize%20-%20newCoin.offsetWidth)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20heightDiff%20=%20(blockSize%20-%20newCoin.offsetHeight)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20floatHeight%20=%20coinPositions%5BcolumnIndex%5D%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.left%20=%20columnLeft%20+%20widthDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.bottom%20=%20floatHeight%20+%20heightDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20store%20all%20coin%20images%20into%20an%20array%0D%0A%20%20%20%20coins%20=%20document.querySelectorAll(%22.coin%22);%0D%0A%20%20%20%20totalCoins.innerText%20=%20coins.length;%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#detectCoinCollection();#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20detectFinishSign();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0A#BEGIN_EDITABLE#function%20detectCoinCollection()%20%7B%7D#END_EDITABLE#%0D%0A%0D%0Afunction%20detectFinishSign()%20%7B%0D%0A%20%20%20%20var%20signLeft%20=%20finishSign.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20var%20finished%20=%20playerLeft%20%3E=%20signLeft;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(finished%20&&%20!playerInAir)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerActive%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(confirm(%22You%20finished%20the%20level,%20play%20again?%22))%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D##JS_E####CODE_64E####LOGIC_64####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60detectCoinCollection();%60);%0Apass.if.js.editable(1).equivalent(%60function%20detectCoinCollection()%20%7B%7D%60);##JS_E####LOGIC_64E####STEP_64E####STEP_65####INST_65##Coin%20collection%20-%202/5%0A%0ACollision%20detection%20for%20the%20coins%20are%20a%20lot%20more%20complicated%20compared%20to%20the%20ground%20and%20the%20finish%20sign,%20both%20of%20which%20only%20required%20us%20to%20check%20collision%20on%20one%20side.%0A%0AFor%20the%20coins%20though,%20we%20need%20to%20check%20collision%20on%20all%20four%20sides,%20the%20combined%20result%20is%20then%20stored%20in%20the%20variable%20*collected*.%0A%0AWe%20can%20then%20use%20this%20variable%20to%20specify%20the%20outcome%20of%20the%20collision.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#relational%20operators%5D%0A%09(*)%5B#js#arithmetic%20operators%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#var%20coll#+1%20&%20js#var%20coll#+2,%20write%20the%20conditions%20for%20the%20character%20colliding%20with%20the%20coin%20on%20the%20*left*%20and%20*right*.%0A%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_coin_hCollision.png%5D%0A%0A(!)On%20+js#var%20coll#+3%20&%20js#var%20coll#+4,%20write%20the%20condition%20for%20the%20character%20colliding%20with%20the%20coin%20on%20the%20*top*%20and%20*bottom*.%0A%0A%5Bimg::https://app.bsd.education/resources/2d_mini_game_coin_vCollision.png%5D%0A%0A(!)On%20+js#var%20coll#+6,%20create%20an%20%60if%60%20statement%20to%20check%20whether%20*collected*%20is%20equal%20to%20*true*.##INST_65E####CODE_65####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Ch1%20id=%22scoreboard%22%3E%0A%20%20%20%20%20%20%20%20Score:%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22score%22%3E0%3C/span%3E%0A%20%20%20%20%20%20%20%20/%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22totalCoins%22%3E?%3C/span%3E%0A%20%20%20%20%3C/h1%3E%0A%20%20%20%20%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scoreboard%20%7B%0A%20%20%20%20text-align:%20center;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A%0A.coin%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/spin_coin.gif%22);%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20width:%2030px;%0A%20%20%20%20height:%2030px;%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20border:%20gray%201px%20dotted;%0A%7D##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0Avar%20score%20=%20document.querySelector(%22#score%22);%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%201,%201,%201,%202,%202,%203,%203%5D;%0D%0Avar%20coinPositions%20=%20%20%5B0,%201,%202,%201,%203,%203%5D;%0D%0Avar%20coins;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20coloumnSize%20is%20the%20last%20number%20in%20the%20tarrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20finalColumn%20=%20columnIndex%20==%20terrain.length%20-%201;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(finalColumn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.left%20=%20newBlock.style.left;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.bottom%20=%20blockBottom%20+%20blockSize%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(coinPositions%5BcolumnIndex%5D%20%3E%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20newCoin%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newCoin);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.className%20=%20%22coin%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20difference%20in%20width%20and%20height%20between%20the%20coin%20and%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20then%20divides%20it%20by%202%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20widthDiff%20=%20(blockSize%20-%20newCoin.offsetWidth)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20heightDiff%20=%20(blockSize%20-%20newCoin.offsetHeight)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20floatHeight%20=%20coinPositions%5BcolumnIndex%5D%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.left%20=%20columnLeft%20+%20widthDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.bottom%20=%20floatHeight%20+%20heightDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20store%20all%20coin%20images%20into%20an%20array%0D%0A%20%20%20%20coins%20=%20document.querySelectorAll(%22.coin%22);%0D%0A%20%20%20%20totalCoins.innerText%20=%20coins.length;%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%20%20%20%20detectCoinCollection();%0D%0A%20%20%20%20%20%20%20%20detectFinishSign();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectCoinCollection()%20%7B%0D%0A%20%20%20%20coins.forEach(coin%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(coin.className%20==%20%22coin%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinLeft%20=%20coin.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinTop%20=%20coin.offsetTop%20+%20terrainContainer.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinWidth%20=%20coin.offsetWidth;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinHeight%20=%20coin.offsetHeight;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20collected%20=%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#playerLeft%20+%20playerWidth%20%3E%20coinLeft#END_EDITABLE#%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#playerLeft%20%3C%20coinLeft%20+%20coinWidth#END_EDITABLE#%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#playerTop%20+%20playerHeight%20%3E%20coinTop#END_EDITABLE#%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#playerTop%20%3C%20coinTop%20+%20coinHeight#END_EDITABLE#;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#if%20(collected)%20%7B%7D#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20detectFinishSign()%20%7B%0D%0A%20%20%20%20var%20signLeft%20=%20finishSign.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20var%20finished%20=%20playerLeft%20%3E=%20signLeft;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(finished%20&&%20!playerInAir)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerActive%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(confirm(%22You%20finished%20the%20level,%20play%20again?%22))%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D##JS_E####CODE_65E####LOGIC_65####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60playerLeft%20+%20playerWidth%20%3E%20coinLeft%60).or(%60playerWidth%20+%20playerLeft%20%3E%20coinLeft%60).or(%60coinLeft%20%3C%20playerLeft%20+%20playerWidth%60).or(%60coinLeft%20%3C%20playerWidth%20+%20playerLeft%60);%0Apass.if.js.editable(1).equivalent(%60playerLeft%20%3C%20coinLeft%20+%20coinWidth%60).or(%60playerLeft%20%3C%20coinWidth%20+%20coinLeft%60).or(%60coinLeft%20+%20coinWidth%20%3E%20playerLeft%60).or(%60coinWidth%20+%20coinLeft%20%3E%20playerLeft%60);%0Apass.if.js.editable(2).equivalent(%60playerTop%20+%20playerHeight%20%3E%20coinTop%60).or(%60playerHeight%20+%20playerTop%20%3E%20coinTop%60).or(%60coinTop%20%3C%20playerTop%20+%20playerHeight%60).or(%60coinTop%20%3C%20playerHeight%20+%20playerTop%60);%0Apass.if.js.editable(3).equivalent(%60playerTop%20%3C%20coinTop%20+%20coinHeight%60).or(%60playerTop%20%3C%20coinHeight%20+%20coinTop%60).or(%60coinTop%20+%20coinHeight%20%3E%20playerTop%60).or(%60coinHeight%20+%20coinTop%20%3E%20playerTop%60);%0Apass.if.js.editable(4).equivalent(%60if%20(collected)%20%7B%7D%60).or(%60if%20(collected%20==%20true)%20%7B%7D%60).or(%60if%20(collected%20===%20true)%20%7B%7D%60).or(%60if%20(true%20==%20collected)%20%7B%7D%60).or(%60if%20(true%20===%20collected)%20%7B%7D%60);##JS_E####LOGIC_65E####STEP_65E####STEP_66####INST_66##Coin%20collection%20-%203/5%0A%0AWhen%20*collected*%20is%20true,%20we%20have%20to%20do%20two%20things:%0A%5B-%0A%09(*)Take%20what%20is%20displayed%20in%20the%20*score*%20element,%20turn%20it%20into%20a%20number%20using%20the%20%5B#js#Number%5D%20function%20(%20+js#Number#%20),%20increase%20it%20by%201%20and%20show%20the%20result%20in%20the%20*score*%20element.%0A%09(*)Add%20a%20class%20name%20to%20the%20coin%20element%20that%20will%20hide%20it.%0A-%5D%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#innerText%5D%0A%09(*)%5B#js#classList%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#Number#+2,%20show%20*currentScore%20+%201*%20as%20text%20in%20the%20*score*%20element.%0A%0A(!)On%20+js#Number#+3,%20add%20the%20class%20name%20*collected*%20to%20the%20*coin*%20element.%0A%0A(%3E%3Estyle.css)%0A%0A(!)On%20+css#.collected#+1,%20hide%20the%20*.collected*%20elements%20using%20the%20%60display%60%20property.##INST_66E####CODE_66####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Ch1%20id=%22scoreboard%22%3E%0A%20%20%20%20%20%20%20%20Score:%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22score%22%3E0%3C/span%3E%0A%20%20%20%20%20%20%20%20/%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22totalCoins%22%3E?%3C/span%3E%0A%20%20%20%20%3C/h1%3E%0A%20%20%20%20%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scoreboard%20%7B%0A%20%20%20%20text-align:%20center;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A%0A.coin%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/spin_coin.gif%22);%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20width:%2030px;%0A%20%20%20%20height:%2030px;%0A%20%20%20%20position:%20absolute;%0A%7D%0A%0A.collected%20%7B%0A%20%20%20%20#BEGIN_EDITABLE#display:%20none;#END_EDITABLE#%0A%7D%0A##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0Avar%20score%20=%20document.querySelector(%22#score%22);%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%201,%201,%201,%202,%202,%203,%203%5D;%0D%0Avar%20coinPositions%20=%20%20%5B0,%201,%202,%201,%203,%203%5D;%0D%0Avar%20coins;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20coloumnSize%20is%20the%20last%20number%20in%20the%20tarrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20finalColumn%20=%20columnIndex%20==%20terrain.length%20-%201;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(finalColumn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.left%20=%20newBlock.style.left;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.bottom%20=%20blockBottom%20+%20blockSize%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(coinPositions%5BcolumnIndex%5D%20%3E%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20newCoin%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newCoin);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.className%20=%20%22coin%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20difference%20in%20width%20and%20height%20between%20the%20coin%20and%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20then%20divides%20it%20by%202%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20widthDiff%20=%20(blockSize%20-%20newCoin.offsetWidth)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20heightDiff%20=%20(blockSize%20-%20newCoin.offsetHeight)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20floatHeight%20=%20coinPositions%5BcolumnIndex%5D%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.left%20=%20columnLeft%20+%20widthDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.bottom%20=%20floatHeight%20+%20heightDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20store%20all%20coin%20images%20into%20an%20array%0D%0A%20%20%20%20coins%20=%20document.querySelectorAll(%22.coin%22);%0D%0A%20%20%20%20totalCoins.innerText%20=%20coins.length;%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%20%20%20%20detectCoinCollection();%0D%0A%20%20%20%20%20%20%20%20detectFinishSign();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectCoinCollection()%20%7B%0D%0A%20%20%20%20coins.forEach(coin%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(coin.className%20==%20%22coin%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinLeft%20=%20coin.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinTop%20=%20coin.offsetTop%20+%20terrainContainer.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinWidth%20=%20coin.offsetWidth;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinHeight%20=%20coin.offsetHeight;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20collected%20=%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerLeft%20+%20playerWidth%20%3E%20coinLeft%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerLeft%20%3C%20coinLeft%20+%20coinWidth%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20+%20playerHeight%20%3E%20coinTop%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20%3C%20coinTop%20+%20coinHeight;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(collected)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20currentScore%20=%20Number(score.textContent);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#score.innerText%20=%20currentScore%20+%201;#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#BEGIN_EDITABLE#coin.classList.add(%22collected%22);#END_EDITABLE#%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20detectFinishSign()%20%7B%0D%0A%20%20%20%20var%20signLeft%20=%20finishSign.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20var%20finished%20=%20playerLeft%20%3E=%20signLeft;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(finished%20&&%20!playerInAir)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerActive%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(confirm(%22You%20finished%20the%20level,%20play%20again?%22))%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%7D##JS_E####CODE_66E####LOGIC_66####HTML####HTML_E####CSS##//%20Expectation:%0Apass.if.css.editable(0).equivalent(%60display:%20none;%60);##CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60score.innerText%20=%20currentScore%20+%201;%60).or(%60score.innerText%20=%201%20+%20currentScore;%60);%0Apass.if.js.editable(1).equivalent(%60coin.classList.add(%22collected%22);%60);##JS_E####LOGIC_66E####STEP_66E####STEP_67####INST_67##Coin%20collection%20-%204/5%0A%0AIf%20you%20play%20the%20game%20now,%20reach%20the%20finish%20line%20and%20choose%20to%20play%20again,%20you%20won't%20get%20the%20coins%20back.%0A%0AThis%20is%20because%20we%20have%20not%20reset%20the%20coins%20in%20the%20*resetGame*%20function.%0A%0ALet's%20do%20that%20now.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#forEach%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#on%20reset#+9,%20call%20the%20*forEach*%20function%20on%20the%20*coins*%20array.##INST_67E####CODE_67####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Ch1%20id=%22scoreboard%22%3E%0A%20%20%20%20%20%20%20%20Score:%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22score%22%3E0%3C/span%3E%0A%20%20%20%20%20%20%20%20/%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22totalCoins%22%3E?%3C/span%3E%0A%20%20%20%20%3C/h1%3E%0A%20%20%20%20%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scoreboard%20%7B%0A%20%20%20%20text-align:%20center;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A%0A.coin%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/spin_coin.gif%22);%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20width:%2030px;%0A%20%20%20%20height:%2030px;%0A%20%20%20%20position:%20absolute;%0A%7D%0A%0A.collected%20%7B%0A%20%20%20%20display:%20none;%0A%7D%0A#BEGIN_EDITABLE##END_EDITABLE###CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0Avar%20score%20=%20document.querySelector(%22#score%22);%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%201,%201,%201,%202,%202,%203,%203%5D;%0D%0Avar%20coinPositions%20=%20%20%5B0,%201,%202,%201,%203,%203%5D;%0D%0Avar%20coins;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20coloumnSize%20is%20the%20last%20number%20in%20the%20tarrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20finalColumn%20=%20columnIndex%20==%20terrain.length%20-%201;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(finalColumn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.left%20=%20newBlock.style.left;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.bottom%20=%20blockBottom%20+%20blockSize%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(coinPositions%5BcolumnIndex%5D%20%3E%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20newCoin%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newCoin);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.className%20=%20%22coin%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20difference%20in%20width%20and%20height%20between%20the%20coin%20and%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20then%20divides%20it%20by%202%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20widthDiff%20=%20(blockSize%20-%20newCoin.offsetWidth)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20heightDiff%20=%20(blockSize%20-%20newCoin.offsetHeight)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20floatHeight%20=%20coinPositions%5BcolumnIndex%5D%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.left%20=%20columnLeft%20+%20widthDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.bottom%20=%20floatHeight%20+%20heightDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20store%20all%20coin%20images%20into%20an%20array%0D%0A%20%20%20%20coins%20=%20document.querySelectorAll(%22.coin%22);%0D%0A%20%20%20%20totalCoins.innerText%20=%20coins.length;%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%20%20%20%20detectCoinCollection();%0D%0A%20%20%20%20%20%20%20%20detectFinishSign();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectCoinCollection()%20%7B%0D%0A%20%20%20%20coins.forEach(coin%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(coin.className%20==%20%22coin%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinLeft%20=%20coin.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinTop%20=%20coin.offsetTop%20+%20terrainContainer.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinWidth%20=%20coin.offsetWidth;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinHeight%20=%20coin.offsetHeight;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20collected%20=%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerLeft%20+%20playerWidth%20%3E%20coinLeft%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerLeft%20%3C%20coinLeft%20+%20coinWidth%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20+%20playerHeight%20%3E%20coinTop%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20%3C%20coinTop%20+%20coinHeight;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(collected)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20currentScore%20=%20Number(score.textContent);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20score.innerText%20=%20currentScore%20+%201;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20coin.classList.add(%22collected%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20detectFinishSign()%20%7B%0D%0A%20%20%20%20var%20signLeft%20=%20finishSign.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20var%20finished%20=%20playerLeft%20%3E=%20signLeft;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(finished%20&&%20!playerInAir)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerActive%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(confirm(%22You%20finished%20the%20level,%20play%20again?%22))%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%20%20%20%20%0D%0A%20%20%20%20#BEGIN_EDITABLE#coins.forEach();#END_EDITABLE#%0D%0A%7D##JS_E####CODE_67E####LOGIC_67####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60coins.forEach();%60);##JS_E####LOGIC_67E####STEP_67E####STEP_68####INST_68##Coin%20collection%20-%205/5%0A%0AThe%20*collected*%20class%20name%20effectively%20hides%20the%20coins,%20when%20we%20reset%20the%20game,%20we%20simply%20need%20to%20remove%20that%20class%20name%20from%20the%20coins.%0A%0A(---)%0A%0A%5B-%0A%09(*)%5B#js#classList%5D%0A-%5D%0A%0A(***)%0A%0A(!)On%20+js#on%20reset#+9,%20remove%20the%20class%20name%20*collected*%20from%20the%20*coin*%20element.##INST_68E####CODE_68####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Ch1%20id=%22scoreboard%22%3E%0A%20%20%20%20%20%20%20%20Score:%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22score%22%3E0%3C/span%3E%0A%20%20%20%20%20%20%20%20/%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22totalCoins%22%3E?%3C/span%3E%0A%20%20%20%20%3C/h1%3E%0A%20%20%20%20%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scoreboard%20%7B%0A%20%20%20%20text-align:%20center;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A%0A.coin%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/spin_coin.gif%22);%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20width:%2030px;%0A%20%20%20%20height:%2030px;%0A%20%20%20%20position:%20absolute;%0A%7D%0A%0A.collected%20%7B%0A%20%20%20%20display:%20none;%0A%7D%0A##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0Avar%20score%20=%20document.querySelector(%22#score%22);%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%201,%201,%201,%202,%202,%203,%203%5D;%0D%0Avar%20coinPositions%20=%20%20%5B0,%201,%202,%201,%203,%203%5D;%0D%0Avar%20coins;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20coloumnSize%20is%20the%20last%20number%20in%20the%20tarrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20finalColumn%20=%20columnIndex%20==%20terrain.length%20-%201;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(finalColumn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.left%20=%20newBlock.style.left;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.bottom%20=%20blockBottom%20+%20blockSize%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(coinPositions%5BcolumnIndex%5D%20%3E%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20newCoin%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newCoin);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.className%20=%20%22coin%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20difference%20in%20width%20and%20height%20between%20the%20coin%20and%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20then%20divides%20it%20by%202%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20widthDiff%20=%20(blockSize%20-%20newCoin.offsetWidth)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20heightDiff%20=%20(blockSize%20-%20newCoin.offsetHeight)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20floatHeight%20=%20coinPositions%5BcolumnIndex%5D%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.left%20=%20columnLeft%20+%20widthDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.bottom%20=%20floatHeight%20+%20heightDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20store%20all%20coin%20images%20into%20an%20array%0D%0A%20%20%20%20coins%20=%20document.querySelectorAll(%22.coin%22);%0D%0A%20%20%20%20totalCoins.innerText%20=%20coins.length;%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%20%20%20%20detectCoinCollection();%0D%0A%20%20%20%20%20%20%20%20detectFinishSign();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectCoinCollection()%20%7B%0D%0A%20%20%20%20coins.forEach(coin%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(coin.className%20==%20%22coin%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinLeft%20=%20coin.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinTop%20=%20coin.offsetTop%20+%20terrainContainer.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinWidth%20=%20coin.offsetWidth;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinHeight%20=%20coin.offsetHeight;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20collected%20=%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerLeft%20+%20playerWidth%20%3E%20coinLeft%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerLeft%20%3C%20coinLeft%20+%20coinWidth%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20+%20playerHeight%20%3E%20coinTop%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20%3C%20coinTop%20+%20coinHeight;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(collected)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20currentScore%20=%20Number(score.textContent);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20score.innerText%20=%20currentScore%20+%201;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20coin.classList.add(%22collected%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20detectFinishSign()%20%7B%0D%0A%20%20%20%20var%20signLeft%20=%20finishSign.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20var%20finished%20=%20playerLeft%20%3E=%20signLeft;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(finished%20&&%20!playerInAir)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerActive%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(confirm(%22You%20finished%20the%20level,%20play%20again?%22))%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%20%20%20%20%0D%0A%20%20%20%20coins.forEach(coin%20=%3E%20#BEGIN_EDITABLE#coin.classList.remove(%22collected%22)#END_EDITABLE#);%0D%0A%7D##JS_E####CODE_68E####LOGIC_68####HTML####HTML_E####CSS####CSS_E####JS##//%20Expectation:%0Apass.if.js.editable(0).equivalent(%60coin.classList.remove(%22collected%22)%60);##JS_E####LOGIC_68E####STEP_68E####STEP_69####INST_69##Summary%0A%0AGreat%20job!%0A%0AYou%20have%20completed%20this%20project!##INST_69E####CODE_69####HTML##%3C!DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Clink%20rel=%22stylesheet%22%20href=%22style.css%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Ch1%20id=%22scoreboard%22%3E%0A%20%20%20%20%20%20%20%20Score:%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22score%22%3E0%3C/span%3E%0A%20%20%20%20%20%20%20%20/%0A%20%20%20%20%20%20%20%20%3Cspan%20id=%22totalCoins%22%3E?%3C/span%3E%0A%20%20%20%20%3C/h1%3E%0A%20%20%20%20%0A%20%20%20%20%3Cdiv%20id=%22scene%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22terrainContainer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22finishSign%22%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id=%22player%22%20class=%22run%22%3E%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%0A%20%20%20%20%3Cscript%20src=%22script.js%22%3E%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E##HTML_E####CSS##body%20%7B%0A%20%20%20%20margin:%200;%0A%7D%0A%0Adiv%20%7B%0A%20%20%20%20box-sizing:%20border-box;%0A%7D%0A%0A#scoreboard%20%7B%0A%20%20%20%20text-align:%20center;%0A%7D%0A%0A#scene%20%7B%0A%20%20%20%20position:%20relative;%0A%20%20%20%20width:%20768px;%0A%20%20%20%20height:%20600px;%0A%20%20%20%20margin:%20auto;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/game_bg.png%22);%0A%20%20%20%20background-size:%20cover;%0A%20%20%20%20overflow:%20hidden;%0A%7D%0A%0A#player%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20top:%20-100px;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20background-repeat:%20no-repeat;%0A%7D%0A%0A.run%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_run.gif%22);%0A%7D%0A%0A.jump%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_jump.png%22);%0A%7D%0A%0A.crash%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/mario_crash.png%22);%0A%7D%0A%0A#terrainContainer%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20left:%200;%0A%20%20%20%20bottom:%200;%0A%20%20%20%20height:%20100%25;%0A%7D%0A%0A.block%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/floor.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A.top%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/top_floor.png%22);%0A%7D%0A%0A#finishSign%20%7B%0A%20%20%20%20position:%20absolute;%0A%20%20%20%20width:%2064px;%0A%20%20%20%20height:%2064px;%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/finishSign.png%22);%0A%20%20%20%20background-size:%20cover;%0A%7D%0A%0A%0A.coin%20%7B%0A%20%20%20%20background-image:%20url(%22https://app.bsd.education/resources/spin_coin.gif%22);%0A%20%20%20%20background-size:%20contain;%0A%20%20%20%20width:%2030px;%0A%20%20%20%20height:%2030px;%0A%20%20%20%20position:%20absolute;%0A%7D%0A%0A.collected%20%7B%0A%20%20%20%20display:%20none;%0A%7D%0A##CSS_E####JS##//%20%20frame%20rate%20related%20variables%0D%0Avar%20maxFPS%20=%2030;%0D%0Avar%20frameInterval%20=%201000%20/%20maxFPS;%0D%0Avar%20timePrevFrame%20=%20Date.now();%0D%0A%0D%0A//%20%20freefall%20properties%0D%0Avar%20gravity%20=%202;%0D%0Avar%20jumpPower%20=%2024;%0D%0Avar%20pixelPerFrame%20=%200;%0D%0Avar%20maxPixelPerFrame%20=%2012;%0D%0A%0D%0Avar%20score%20=%20document.querySelector(%22#score%22);%0D%0A%0D%0A//%20%20player%20element%20&%20properties%0D%0Avar%20player%20=%20document.querySelector(%22#player%22);%0D%0Avar%20playerTop%20=%20300;%0D%0Avar%20playerLeft%20=%20200;%0D%0Avar%20playerWidth%20=%2035;%0D%0Avar%20playerHeight%20=%2064;%0D%0Avar%20playerInAir%20=%20true;%0D%0Avar%20playerActive%20=%20true;%0D%0A%0D%0A//%20%20terrain%20element%20&%20properties%0D%0Avar%20terrainContainer%20=%20document.querySelector(%22#terrainContainer%22);%0D%0Avar%20blockSize%20=%2064;%0D%0Avar%20terrainLeft%20=%200;%0D%0Avar%20terrainScroll%20=%203;%0D%0Avar%20terrain%20=%20%5B2,%201,%201,%201,%202,%202,%203,%203%5D;%0D%0Avar%20coinPositions%20=%20%20%5B0,%201,%202,%201,%203,%203%5D;%0D%0Avar%20coins;%0D%0A%0D%0A//%20%20set%20initial%20player%20position%0D%0Aplayer.style.left%20=%20playerLeft%20+%20%22px%22;%0D%0A%0D%0A//%20%20generate%20terrain%0D%0AgenerateTerrain();%0D%0A//%20%20start%20the%20game%20loop%0D%0AgameLoop();%0D%0A%0D%0Awindow.onkeydown%20=%20jump;%0D%0A%0D%0A//%20===============================%20//%0D%0A//%20==========%20FUNCTIONS%20==========%20//%0D%0A//%20===============================%20//%0D%0A%0D%0Afunction%20generateTerrain()%20%7B%0D%0A%20%20%20%20//%20%20create%20a%20column%20of%20blocks%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20terrain.forEach((columnSize,%20columnIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20create%20an%20array%20for%20each%20number%20in%20the%20terrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20newBlocks%20=%20new%20Array(columnSize).fill();%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20&%20store%20the%20left%20position%20for%20each%20column%0D%0A%20%20%20%20%20%20%20%20var%20columnLeft%20=%20playerLeft%20+%20columnIndex%20*%20blockSize;%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20coloumnSize%20is%20the%20last%20number%20in%20the%20tarrain%20array%0D%0A%20%20%20%20%20%20%20%20var%20finalColumn%20=%20columnIndex%20==%20terrain.length%20-%201;%0D%0A%0D%0A%20%20%20%20%20%20%20%20newBlocks.forEach((newBlock,%20blockIndex)%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20create%20a%20new%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20new%20block%20to%20the%20terrain%20container%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newBlock);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20and%20store%20the%20bottom%20position%20for%20each%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockBottom%20=%20(columnSize%20-%20blockIndex%20-%201)%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.left%20=%20columnLeft%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.style.bottom%20=%20blockBottom%20+%20%22px%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20is%20the%20first%20in%20that%20column%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blockIndex%20===%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newBlock.className%20=%20%22block%20top%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(finalColumn)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.left%20=%20newBlock.style.left;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20finishSign.style.bottom%20=%20blockBottom%20+%20blockSize%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(coinPositions%5BcolumnIndex%5D%20%3E%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20newCoin%20=%20document.createElement(%22div%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20terrainContainer.appendChild(newCoin);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.className%20=%20%22coin%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20difference%20in%20width%20and%20height%20between%20the%20coin%20and%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20then%20divides%20it%20by%202%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20widthDiff%20=%20(blockSize%20-%20newCoin.offsetWidth)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20heightDiff%20=%20(blockSize%20-%20newCoin.offsetHeight)%20/%202;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20floatHeight%20=%20coinPositions%5BcolumnIndex%5D%20*%20blockSize;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.left%20=%20columnLeft%20+%20widthDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20newCoin.style.bottom%20=%20floatHeight%20+%20heightDiff%20+%20%22px%22;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20//%20%20store%20all%20coin%20images%20into%20an%20array%0D%0A%20%20%20%20coins%20=%20document.querySelectorAll(%22.coin%22);%0D%0A%20%20%20%20totalCoins.innerText%20=%20coins.length;%0D%0A%7D%0D%0A%0D%0Afunction%20jump()%20%7B%0D%0A%20%20%20%20if%20(playerInAir%20===%20false%20&&%20event.code%20==%20%22Space%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20-=%20jumpPower;%0D%0A%20%20%20%20%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20gameLoop()%20%7B%0D%0A%20%20%20%20//%20%20store%20the%20current%20time%20when%20this%20function%20is%20called%0D%0A%20%20%20%20var%20currentTime%20=%20Date.now();%0D%0A%20%20%20%20//%20%20calculate%20the%20elapsed%20time%20since%20the%20previous%20frame%0D%0A%20%20%20%20var%20elapsed%20=%20currentTime%20-%20timePrevFrame;%0D%0A%0D%0A%20%20%20%20//%20%20determine%20if%20it%20is%20time%20to%20draw%20another%20frame%0D%0A%20%20%20%20if%20(elapsed%20%3E%20frameInterval)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20update%20timePrevFrame%0D%0A%20%20%20%20%20%20%20%20timePrevFrame%20=%20currentTime%20-%20(elapsed%20%25%20frameInterval);%0D%0A%20%20%20%20%20%20%20%20//%20%20call%20the%20actionPerFrame%20function,%20i.e.%20draw%20a%20new%20frame%0D%0A%20%20%20%20%20%20%20%20requestAnimationFrame(actionPerFrame);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20call%20gameLoop%20function%20again%0D%0A%20%20%20%20requestAnimationFrame(gameLoop);%0D%0A%7D%0D%0A%0D%0Afunction%20actionPerFrame()%20%7B%0D%0A%20%20%20%20animateFreefall();%0D%0A%0D%0A%20%20%20%20if%20(playerActive)%20%7B%0D%0A%20%20%20%20%20%20%20%20animateTerrain();%0D%0A%20%20%20%20%20%20%20%20detectGroundCollision();%0D%0A%20%20%20%20%20%20%20%20detectCoinCollection();%0D%0A%20%20%20%20%20%20%20%20detectFinishSign();%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20detectOutOfFrame();%0D%0A%0D%0A%20%20%20%20player.style.top%20=%20playerTop%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20animateFreefall()%20%7B%0D%0A%20%20%20%20//%20%20determine%20if%20pixelPerFrame%20has%20reached%20maximum%20value%0D%0A%20%20%20%20if%20(playerInAir%20&&%20pixelPerFrame%20%3C%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20increase%20the%20rate%20of%20falling,%20i.e.%20pixelPerFrame%0D%0A%20%20%20%20%20%20%20%20pixelPerFrame%20+=%20gravity;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20//%20%20modify%20player%20top%20position%20using%20pixelPerFrame%0D%0A%20%20%20%20playerTop%20+=%20pixelPerFrame;%0D%0A%7D%0D%0A%0D%0Afunction%20animateTerrain()%20%7B%0D%0A%20%20%20%20terrainLeft%20-=%20terrainScroll;%0D%0A%20%20%20%20terrainContainer.style.left%20=%20terrainLeft%20+%20%22px%22;%0D%0A%7D%0D%0A%0D%0Afunction%20detectGroundCollision()%20%7B%0D%0A%20%20%20%20//%20%20assume%20no%20collision%20at%20the%20beginning%20of%20every%20frame%0D%0A%20%20%20%20var%20noCollision%20=%20true;%0D%0A%20%20%20%20//%20%20store%20all%20block%20elements%0D%0A%20%20%20%20var%20blocks%20=%20document.querySelectorAll(%22.block%22);%0D%0A%0D%0A%20%20%20%20//%20%20perform%20collision%20check%20on%20each%20block%0D%0A%20%20%20%20blocks.forEach(block%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20//%20%20calculate%20the%20minimum%20and%20maximum%20left%20position%20for%20a%20block%0D%0A%20%20%20%20%20%20%20%20//%20%20that%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20var%20minLeft%20=%20playerLeft%20-%20blockSize;%0D%0A%20%20%20%20%20%20%20%20var%20maxLeft%20=%20playerLeft%20+%20playerWidth;%0D%0A%0D%0A%20%20%20%20%20%20%20%20var%20blockLeft%20=%20block.offsetLeft%20+%20terrainLeft;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20remove%20border%20no%20longer%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20block.style.border%20=%20%22none%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20//%20%20determine%20if%20a%20block%20can%20collide%20with%20the%20player%0D%0A%20%20%20%20%20%20%20%20if%20(playerActive%20&&%20blockLeft%20%3C%20maxLeft%20&&%20blockLeft%20%3E%20minLeft)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20blockTop%20=%20block.offsetTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20maximum%20top%20position%20for%20the%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20before%20it%20collides%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxTop%20=%20blockTop%20-%20playerHeight;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20player%20is%20colliding%20with%20a%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(playerTop%20%3E=%20maxTop)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20calculate%20the%20vertical%20distance%20between%20the%20player%20and%20a%20colliding%20block%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vDist%20=%20playerTop%20+%20playerHeight%20-%20blockTop;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20determine%20if%20the%20distance%20is%20greater%20than%20the%20maximum%20freefall%20distance%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vDist%20%3E%20maxPixelPerFrame)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20true;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20prevent%20playerTop%20from%20exceeding%20maxTop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20=%20maxTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20stop%20the%20player%20from%20falling%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20noCollision%20=%20false;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player.className%20=%20%22run%22;%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%20add%20border%20to%20visualise%20the%20block%20colliding%20with%20player%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.style.border%20=%20%22dashed%201px%20black%22;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%20%20%20%20%0D%0A%20%20%20%20playerInAir%20=%20noCollision;%0D%0A%7D%0D%0A%0D%0Afunction%20detectCoinCollection()%20%7B%0D%0A%20%20%20%20coins.forEach(coin%20=%3E%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(coin.className%20==%20%22coin%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinLeft%20=%20coin.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinTop%20=%20coin.offsetTop%20+%20terrainContainer.offsetTop;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinWidth%20=%20coin.offsetWidth;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20coinHeight%20=%20coin.offsetHeight;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20collected%20=%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerLeft%20+%20playerWidth%20%3E%20coinLeft%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerLeft%20%3C%20coinLeft%20+%20coinWidth%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20+%20playerHeight%20%3E%20coinTop%20&&%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20playerTop%20%3C%20coinTop%20+%20coinHeight;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(collected)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20currentScore%20=%20Number(score.textContent);%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20score.innerText%20=%20currentScore%20+%201;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20coin.classList.add(%22collected%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D);%0D%0A%7D%0D%0A%0D%0Afunction%20detectFinishSign()%20%7B%0D%0A%20%20%20%20var%20signLeft%20=%20finishSign.offsetLeft%20+%20terrainContainer.offsetLeft;%0D%0A%20%20%20%20var%20finished%20=%20playerLeft%20%3E=%20signLeft;%0D%0A%20%20%20%20%0D%0A%20%20%20%20if%20(finished%20&&%20!playerInAir)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerActive%20=%20false;%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if%20(confirm(%22You%20finished%20the%20level,%20play%20again?%22))%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20detectOutOfFrame()%20%7B%0D%0A%20%20%20%20var%20sceneHeight%20=%20document.querySelector(%22#scene%22).offsetHeight;%0D%0A%20%20%20%20//%20%20define%20the%20condition%20when%20player%20touches%20the%20bottom%20edge%20of%20the%20scene%0D%0A%20%20%20%20var%20atBottomEdge%20=%20playerTop%20+%20playerHeight%20%3E%20sceneHeight;%0D%0A%0D%0A%20%20%20%20if%20(playerActive%20&&%20atBottomEdge)%20%7B%0D%0A%20%20%20%20%20%20%20%20playerCrash();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20else%20if%20(playerTop%20%3E%20sceneHeight)%20%7B%0D%0A%20%20%20%20%20%20%20%20resetGame();%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A%0D%0Afunction%20playerCrash()%20%7B%0D%0A%20%20%20%20//%20%20set%20pixelPerFrame%20to%20a%20negative%20value%20makes%20the%20character%20move%20up%0D%0A%20%20%20%20pixelPerFrame%20=%20-maxPixelPerFrame;%0D%0A%20%20%20%20player.className%20=%20%22crash%22;%0D%0A%20%20%20%20playerActive%20=%20false;%0D%0A%7D%0D%0A%0D%0Afunction%20resetGame()%20%7B%0D%0A%20%20%20%20playerTop%20=%20300;%0D%0A%20%20%20%20player.className%20=%20%22jump%22;%0D%0A%20%20%20%20playerInAir%20=%20true;%0D%0A%20%20%20%20playerActive%20=%20true;%0D%0A%20%20%20%20pixelPerFrame%20=%200;%0D%0A%20%20%20%20terrainLeft%20=%200;%0D%0A%20%20%20%20score.innerText%20=%200;%0D%0A%20%20%20%20%0D%0A%20%20%20%20coins.forEach(coin%20=%3E%20coin.classList.remove(%22collected%22));%0D%0A%7D%0D%0A#BEGIN_EDITABLE##END_EDITABLE###JS_E####CODE_69E####LOGIC_69####HTML####HTML_E####CSS####CSS_E####JS####JS_E####LOGIC_69E####STEP_69E##